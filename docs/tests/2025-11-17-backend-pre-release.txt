============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-7.4.3, pluggy-1.6.0 -- C:\Users\User\AppData\Local\Programs\Python\Python311\python.exe
cachedir: .pytest_cache
rootdir: C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver
configfile: pytest.ini
plugins: anyio-3.7.1, asyncio-0.21.1, cov-7.0.0
asyncio: mode=Mode.STRICT
collecting ... collected 1342 items

tests\test_additional_ratios.py::test_asset_turnover PASSED              [  0%]
tests\test_additional_ratios.py::test_inventory_turnover PASSED          [  0%]
tests\test_additional_ratios.py::test_receivables_turnover PASSED        [  0%]
tests\test_additional_ratios.py::test_days_sales_outstanding PASSED      [  0%]
tests\test_additional_ratios.py::test_cash_conversion_cycle PASSED       [  0%]
tests\test_additional_ratios.py::test_price_to_earnings PASSED           [  0%]
tests\test_additional_ratios.py::test_ev_to_ebitda PASSED                [  0%]
tests\test_additional_ratios.py::test_dividend_yield PASSED              [  0%]
tests\test_additional_ratios.py::test_revenue_growth_yoy PASSED          [  0%]
tests\test_additional_ratios.py::test_ebitda_growth_yoy PASSED           [  0%]
tests\test_additional_ratios.py::test_cagr PASSED                        [  0%]
tests\test_additional_ratios.py::test_operating_cf_margin PASSED         [  0%]
tests\test_additional_ratios.py::test_free_cash_flow PASSED              [  0%]
tests\test_additional_ratios.py::test_cf_to_debt PASSED                  [  1%]
tests\test_additional_ratios.py::test_cash_conversion_rate PASSED        [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_professional_tier_allowed_podcast_audio_access PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_starter_tier_blocked_from_podcast_audio PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_403_response_includes_upgrade_message PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_403_includes_required_tier_header PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_403_includes_upgrade_url_header PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureVideoAccess::test_premium_tier_allowed_video_access PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureVideoAccess::test_professional_tier_blocked_from_video PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureYouTubeAccess::test_premium_tier_allowed_youtube_access PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureYouTubeAccess::test_professional_tier_blocked_from_youtube PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureLiveStreaming::test_enterprise_tier_allowed_live_streaming PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureLiveStreaming::test_premium_tier_blocked_from_live_streaming PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_middleware_works_with_multiple_features PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_middleware_integrates_with_get_current_user PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_middleware_logs_blocked_requests PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_invalid_feature_raises_feature_not_found_error PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceInitialization::test_service_initializes_with_default_settings PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceInitialization::test_service_initializes_with_custom_settings PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceFileValidation::test_needs_chunking_returns_false_for_small_file PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceFileValidation::test_needs_chunking_returns_true_for_large_file PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceFileValidation::test_needs_chunking_returns_false_at_exact_limit PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_creates_multiple_chunks PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_handles_mp3_format PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_handles_wav_format PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_applies_overlap PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_raises_error_for_missing_file PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_combines_all_transcripts PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_handles_empty_chunk_list PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_raises_error_on_api_failure PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_supports_custom_language PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceCleanup::test_cleanup_chunks_deletes_all_files PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceCleanup::test_cleanup_chunks_handles_missing_files PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceCleanup::test_cleanup_chunks_handles_deletion_errors PASSED [  3%]
tests\test_auth_dependencies_edge_cases.py::TestExtractClaim::test_extract_claim_finds_first_key PASSED [  3%]
tests\test_auth_dependencies_edge_cases.py::TestExtractClaim::test_extract_claim_finds_second_key PASSED [  3%]
tests\test_auth_dependencies_edge_cases.py::TestExtractClaim::test_extract_claim_returns_none_when_no_match PASSED [  3%]
tests\test_auth_dependencies_edge_cases.py::TestExtractClaim::test_extract_claim_returns_none_when_value_is_falsy PASSED [  3%]
tests\test_auth_dependencies_edge_cases.py::TestExtractClaim::test_extract_claim_handles_nonexistent_keys PASSED [  3%]
tests\test_auth_dependencies_edge_cases.py::TestSanitizeClaims::test_sanitize_claims_keeps_allowed_keys PASSED [  3%]
tests\test_auth_dependencies_edge_cases.py::TestSanitizeClaims::test_sanitize_claims_handles_partial_claims PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestSanitizeClaims::test_sanitize_claims_handles_empty_claims PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestGetCurrentAdminUser::test_get_current_admin_user_returns_admin PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestGetCurrentAdminUser::test_get_current_admin_user_rejects_non_admin PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestGetCurrentAdminUser::test_get_current_admin_user_rejects_growth_role PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestRequireFeature::test_require_feature_grants_access_when_user_has_feature PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestRequireFeature::test_require_feature_denies_access_when_user_lacks_feature PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestRequireFeature::test_require_feature_handles_user_with_subscription_tier_attribute PASSED [  4%]
tests\test_auth_dependencies_edge_cases.py::TestRequireFeature::test_require_feature_fallback_message_when_no_tier_attribute PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_with_single_key PASSED    [  4%]
tests\test_auth_helpers.py::test_extract_claim_with_multiple_keys_returns_first_found PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_returns_none_when_not_found PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_skips_empty_values PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_handles_falsy_but_valid_values PASSED [  4%]
tests\test_auth_helpers.py::test_sanitize_claims_filters_allowed_keys PASSED [  5%]
tests\test_auth_helpers.py::test_sanitize_claims_handles_missing_allowed_keys PASSED [  5%]
tests\test_auth_helpers.py::test_sanitize_claims_returns_empty_dict_for_no_allowed_keys PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_validates_org_match PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_org_mismatch PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_missing_org_claim_when_user_has_org PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_creates_missing_org_from_clerk PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_validates_role_match PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_role_mismatch PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_unknown_role_claim PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_logs_claim_mismatches PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_allows_missing_role_claim PASSED [  5%]
tests\test_auth_helpers.py::test_get_current_user_enforces_claim_integrity PASSED [  5%]
tests\test_auth_helpers.py::test_get_current_user_requires_credentials PASSED [  6%]
tests\test_auth_helpers.py::test_require_feature_allows_access_with_sufficient_tier PASSED [  6%]
tests\test_auth_helpers.py::test_require_feature_blocks_access_with_insufficient_tier PASSED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_success PASSED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_invalid_tier PASSED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_requires_auth PASSED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_existing_subscription PASSED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_with_trial PASSED [  6%]
tests\test_billing_endpoints.py::test_get_customer_portal_success PASSED [  6%]
tests\test_billing_endpoints.py::test_get_customer_portal_handles_value_errors PASSED [  6%]
tests\test_billing_endpoints.py::test_get_subscription_success PASSED    [  6%]
tests\test_billing_endpoints.py::test_get_subscription_not_found PASSED  [  6%]
tests\test_billing_endpoints.py::test_get_subscription_requires_auth PASSED [  6%]
tests\test_billing_endpoints.py::test_update_subscription_tier_upgrade PASSED [  7%]
tests\test_billing_endpoints.py::test_update_subscription_tier_downgrade PASSED [  7%]
tests\test_billing_endpoints.py::test_cancel_subscription_at_period_end PASSED [  7%]
tests\test_billing_endpoints.py::test_cancel_subscription_immediately PASSED [  7%]
tests\test_billing_endpoints.py::test_cancel_subscription_requires_active_subscription PASSED [  7%]
tests\test_billing_endpoints.py::test_customer_portal_redirect PASSED    [  7%]
tests\test_billing_simple.py::test_create_checkout_session_endpoint_exists PASSED [  7%]
tests\test_billing_simple.py::test_get_subscription_endpoint_exists PASSED [  7%]
tests\test_billing_simple.py::test_cancel_subscription_endpoint_exists PASSED [  7%]
tests\test_blog_api_errors.py::TestBlogAPIErrorPaths::test_get_blog_post_returns_404_when_not_found PASSED [  7%]
tests\test_blog_api_errors.py::TestBlogAPIErrorPaths::test_get_blog_post_by_slug_returns_404_when_not_found PASSED [  7%]
tests\test_blog_api_errors.py::TestBlogAPIErrorPaths::test_list_blog_posts_with_invalid_category PASSED [  7%]
tests\test_blog_api_errors.py::TestBlogAPIErrorPaths::test_list_blog_posts_with_search_term PASSED [  7%]
tests\test_blog_api_errors.py::TestBlogAPIErrorPaths::test_list_blog_posts_with_pagination PASSED [  7%]
tests\test_blog_api_errors.py::TestBlogAPIErrorPaths::test_list_blog_posts_with_draft_included PASSED [  8%]
tests\test_blog_api_errors.py::TestBlogAPIErrorPaths::test_list_blog_posts_with_large_offset PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_creates_user PASSED      [  8%]
tests\test_clerk_auth_complete.py::test_webhook_rejects_invalid_signature PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_rejects_missing_signature PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_updates_existing_user PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_update_creates_if_not_exists PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_soft_deletes_user PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_updates_last_login_on_session_created PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_handles_session_ended PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_handles_missing_email_addresses PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_upserts_organization_metadata PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_creates_organization_when_missing PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_deactivates_organization_on_delete PASSED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_handles_invalid_role_gracefully PASSED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_returns_current_user PASSED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_requires_token PASSED    [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_invalid_token PASSED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_token_for_nonexistent_user PASSED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_token_without_sub PASSED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_org_claim_mismatch PASSED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_role_claim_mismatch PASSED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_populates_missing_org_from_claim PASSED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_handles_empty_data_gracefully PASSED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_ignores_unknown_event_types PASSED [  9%]
tests\test_clerk_auth_complete.py::test_user_creation_with_all_roles PASSED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_handles_invalid_timestamp_format PASSED [  9%]
tests\test_clerk_auth_complete.py::test_full_user_lifecycle PASSED       [ 10%]
tests\test_community_api.py::test_create_post_returns_201 PASSED         [ 10%]
tests\test_community_api.py::test_list_posts_returns_200 PASSED          [ 10%]
tests\test_community_api.py::test_list_posts_with_filters PASSED         [ 10%]
tests\test_community_api.py::test_get_post_returns_200 PASSED            [ 10%]
tests\test_community_api.py::test_get_post_not_found_returns_404 PASSED  [ 10%]
tests\test_community_api.py::test_update_post_returns_200 PASSED         [ 10%]
tests\test_community_api.py::test_delete_post_returns_204 PASSED         [ 10%]
tests\test_community_api.py::test_list_posts_requires_authentication PASSED [ 10%]
tests\test_community_api.py::test_create_comment_returns_201 PASSED      [ 10%]
tests\test_community_api.py::test_list_comments_returns_200 PASSED       [ 10%]
tests\test_community_api.py::test_delete_comment_returns_204 PASSED      [ 10%]
tests\test_community_api.py::test_create_reaction_returns_201 PASSED     [ 10%]
tests\test_community_api.py::test_get_reactions_returns_200 PASSED       [ 11%]
tests\test_community_api.py::test_delete_reaction_returns_204 PASSED     [ 11%]
tests\test_community_api.py::test_follow_user_returns_201 PASSED         [ 11%]
tests\test_community_api.py::test_unfollow_user_returns_204 PASSED       [ 11%]
tests\test_community_api.py::test_get_follow_stats_returns_200 PASSED    [ 11%]
tests\test_community_api.py::test_get_followers_returns_200 PASSED       [ 11%]
tests\test_community_api.py::test_get_following_returns_200 PASSED       [ 11%]
tests\test_community_api.py::test_create_moderation_action_returns_201 PASSED [ 11%]
tests\test_community_api.py::test_get_flagged_content_returns_200 PASSED [ 11%]
tests\test_community_api.py::test_get_analytics_returns_200 PASSED       [ 11%]
tests\test_community_models.py::test_create_post PASSED                  [ 11%]
tests\test_community_models.py::test_post_with_tags PASSED               [ 11%]
tests\test_community_models.py::test_post_multi_tenancy PASSED           [ 11%]
tests\test_community_models.py::test_create_comment PASSED               [ 11%]
tests\test_community_models.py::test_nested_comments PASSED              [ 12%]
tests\test_community_models.py::test_post_comment_relationship PASSED    [ 12%]
tests\test_community_models.py::test_create_reaction PASSED              [ 12%]
tests\test_community_models.py::test_reaction_on_comment PASSED          [ 12%]
tests\test_community_models.py::test_unique_reaction_constraint PASSED   [ 12%]
tests\test_community_models.py::test_create_follow PASSED                [ 12%]
tests\test_community_models.py::test_unique_follow_constraint PASSED     [ 12%]
tests\test_community_models.py::test_create_moderation_action PASSED     [ 12%]
tests\test_community_models.py::test_moderation_action_types PASSED      [ 12%]
tests\test_community_service.py::test_create_post PASSED                 [ 12%]
tests\test_community_service.py::test_get_post_by_id PASSED              [ 12%]
tests\test_community_service.py::test_get_post_by_id_wrong_org PASSED    [ 12%]
tests\test_community_service.py::test_update_post PASSED                 [ 12%]
tests\test_community_service.py::test_update_post_unauthorized PASSED    [ 13%]
tests\test_community_service.py::test_delete_post PASSED                 [ 13%]
tests\test_community_service.py::test_delete_post_unauthorized PASSED    [ 13%]
tests\test_community_service.py::test_list_posts PASSED                  [ 13%]
tests\test_community_service.py::test_list_posts_filter_by_category PASSED [ 13%]
tests\test_community_service.py::test_list_posts_search PASSED           [ 13%]
tests\test_community_service.py::test_create_comment PASSED              [ 13%]
tests\test_community_service.py::test_create_comment_on_nonexistent_post PASSED [ 13%]
tests\test_community_service.py::test_create_nested_comment PASSED       [ 13%]
tests\test_community_service.py::test_delete_comment PASSED              [ 13%]
tests\test_community_service.py::test_delete_comment_unauthorized PASSED [ 13%]
tests\test_community_service.py::test_get_comments_for_post PASSED       [ 13%]
tests\test_community_service.py::test_add_reaction PASSED                [ 13%]
tests\test_community_service.py::test_add_reaction_duplicate PASSED      [ 14%]
tests\test_community_service.py::test_remove_reaction PASSED             [ 14%]
tests\test_community_service.py::test_get_reactions PASSED               [ 14%]
tests\test_community_service.py::test_follow_user PASSED                 [ 14%]
tests\test_community_service.py::test_follow_user_self PASSED            [ 14%]
tests\test_community_service.py::test_follow_user_duplicate PASSED       [ 14%]
tests\test_community_service.py::test_unfollow_user PASSED               [ 14%]
tests\test_community_service.py::test_get_follow_stats PASSED            [ 14%]
tests\test_community_service.py::test_moderate_content_flag PASSED       [ 14%]
tests\test_community_service.py::test_moderate_content_delete PASSED     [ 14%]
tests\test_community_service.py::test_get_flagged_content PASSED         [ 14%]
tests\test_community_service.py::test_get_community_analytics PASSED     [ 14%]
tests\test_dashboard_api.py::TestDashboardAPI::test_get_dashboard_summary PASSED [ 14%]
tests\test_dashboard_api.py::TestDashboardAPI::test_get_recent_activity PASSED [ 14%]
tests\test_dashboard_api.py::TestDashboardAPI::test_get_recent_activity_with_limit PASSED [ 15%]
tests\test_dashboard_api.py::TestDashboardAPI::test_get_upcoming_tasks PASSED [ 15%]
tests\test_dashboard_api.py::TestDashboardAPI::test_get_financial_insights PASSED [ 15%]
tests\test_dashboard_api.py::TestDashboardAPI::test_dashboard_endpoints_require_authentication PASSED [ 15%]
tests\test_database_infrastructure.py::test_init_engine_success PASSED   [ 15%]
tests\test_database_infrastructure.py::test_init_engine_sqlite_connect_args PASSED [ 15%]
tests\test_database_infrastructure.py::test_init_engine_postgresql_connect_args PASSED [ 15%]
tests\test_database_infrastructure.py::test_init_engine_idempotent PASSED [ 15%]
tests\test_database_infrastructure.py::test_get_db_yields_session PASSED [ 15%]
tests\test_database_infrastructure.py::test_get_db_commits_on_success PASSED [ 15%]
tests\test_database_infrastructure.py::test_get_db_rolls_back_on_exception PASSED [ 15%]
tests\test_database_infrastructure.py::test_get_db_closes_on_exception PASSED [ 15%]
tests\test_database_infrastructure.py::test_init_db_creates_tables PASSED [ 15%]
tests\test_database_infrastructure.py::test_close_db_disposes_engine PASSED [ 16%]
tests\test_database_infrastructure.py::test_close_db_no_engine PASSED    [ 16%]
tests\test_database_infrastructure.py::test_close_db_sets_engine_to_none_after_dispose PASSED [ 16%]
tests\test_database_reset.py::test_reset_metadata_restores_dropped_tables PASSED [ 16%]
tests\test_database_reset.py::test_safe_drop_schema_handles_drop_all_errors PASSED [ 16%]
tests\test_deal_endpoints.py::test_create_deal_success PASSED            [ 16%]
tests\test_deal_endpoints.py::test_create_deal_validation_errors PASSED  [ 16%]
tests\test_deal_endpoints.py::test_create_deal_sets_owner_and_org PASSED [ 16%]
tests\test_deal_endpoints.py::test_create_deal_requires_auth PASSED      [ 16%]
tests\test_deal_endpoints.py::test_create_deal_default_stage PASSED      [ 16%]
tests\test_deal_endpoints.py::test_list_deals_returns_org_deals_only PASSED [ 16%]
tests\test_deal_endpoints.py::test_list_deals_pagination_works PASSED    [ 16%]
tests\test_deal_endpoints.py::test_list_deals_filter_by_stage PASSED     [ 16%]
tests\test_deal_endpoints.py::test_list_deals_search_by_name PASSED      [ 16%]
tests\test_deal_endpoints.py::test_list_deals_sort_by_created_at PASSED  [ 17%]
tests\test_deal_endpoints.py::test_list_deals_excludes_archived PASSED   [ 17%]
tests\test_deal_endpoints.py::test_list_deals_requires_auth PASSED       [ 17%]
tests\test_deal_endpoints.py::test_get_deal_success PASSED               [ 17%]
tests\test_deal_endpoints.py::test_get_deal_not_found PASSED             [ 17%]
tests\test_deal_endpoints.py::test_get_deal_forbidden_other_org PASSED   [ 17%]
tests\test_deal_endpoints.py::test_get_deal_requires_auth PASSED         [ 17%]
tests\test_deal_endpoints.py::test_update_deal_success PASSED            [ 17%]
tests\test_deal_endpoints.py::test_update_deal_stage_change PASSED       [ 17%]
tests\test_deal_endpoints.py::test_update_deal_partial_update PASSED     [ 17%]
tests\test_deal_endpoints.py::test_update_deal_forbidden_other_org PASSED [ 17%]
tests\test_deal_endpoints.py::test_update_deal_validation_errors PASSED  [ 17%]
tests\test_deal_endpoints.py::test_archive_deal_success PASSED           [ 17%]
tests\test_deal_endpoints.py::test_archive_deal_forbidden_other_org PASSED [ 18%]
tests\test_deal_endpoints.py::test_unarchive_deal_success PASSED         [ 18%]
tests\test_deal_endpoints.py::test_unarchive_deal_forbidden_other_org PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_create_criteria_success PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_create_criteria_requires_auth PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_list_criteria PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_for_deal PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_requires_auth PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_for_deal PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_requires_auth PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_deal_not_found PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_deal_not_found PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_view PASSED [ 18%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_save PASSED [ 19%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_pass PASSED [ 19%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_request_intro PASSED [ 19%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_requires_auth PASSED [ 19%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_match_not_found PASSED [ 19%]
tests\test_deal_matching_api.py::TestDealMatchingIntegration::test_create_criteria_and_find_matches_workflow PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_create_deal_match_criteria_with_required_fields PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_create_criteria_with_optional_fields PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_criteria_enforces_organization_isolation PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchModel::test_create_deal_match PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchModel::test_match_score_validation PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchModel::test_match_status_tracking PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchActionModel::test_create_match_action PASSED [ 19%]
tests\test_deal_matching_models.py::TestDealMatchActionModel::test_track_multiple_actions_on_match PASSED [ 19%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_exact PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_partial PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_none PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_size_match_within_range PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_size_match_outside_range PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_geography_match_exact PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_geography_match_none PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_semantic_similarity PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_weighted_score PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_determine_confidence_level_high PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_determine_confidence_level_medium PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_determine_confidence_level_low PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_find_matches_returns_ranked_results PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_find_matches_filters_low_scores PASSED [ 21%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_match_result_contains_explanation PASSED [ 21%]
tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_fetch_ai_suggestions PASSED [ 21%]
tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_accept_ai_suggestion PASSED [ 21%]
tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_reject_ai_suggestion PASSED [ 21%]
tests\test_document_ai_and_versions.py::TestVersionHistoryEndpoints::test_list_document_versions PASSED [ 21%]
tests\test_document_ai_and_versions.py::TestVersionHistoryEndpoints::test_restore_document_version PASSED [ 21%]
tests\test_document_endpoints.py::test_create_folder_success PASSED      [ 21%]
tests\test_document_endpoints.py::test_upload_document_success PASSED    [ 21%]
tests\test_document_endpoints.py::test_upload_document_rejects_large_files PASSED [ 21%]
tests\test_document_endpoints.py::test_list_documents_filters_by_folder PASSED [ 21%]
tests\test_document_endpoints.py::test_download_document_records_access_log PASSED [ 21%]
tests\test_document_endpoints.py::test_set_document_permission PASSED    [ 21%]
tests\test_document_endpoints.py::test_list_folders_lazy_loading PASSED  [ 21%]
tests\test_document_endpoints.py::test_list_folders_supports_search PASSED [ 22%]
tests\test_document_endpoints.py::test_create_nested_folder PASSED       [ 22%]
tests\test_document_endpoints.py::test_rename_folder PASSED              [ 22%]
tests\test_document_endpoints.py::test_delete_empty_folder PASSED        [ 22%]
tests\test_document_endpoints.py::test_delete_non_empty_folder_fails PASSED [ 22%]
tests\test_document_endpoints.py::test_folder_requires_authentication PASSED [ 22%]
tests\test_document_endpoints.py::test_folder_organization_isolation PASSED [ 22%]
tests\test_document_endpoints.py::test_upload_multiple_documents PASSED  [ 22%]
tests\test_document_endpoints.py::test_upload_unsupported_file_type PASSED [ 22%]
tests\test_document_endpoints.py::test_upload_creates_audit_log PASSED   [ 22%]
tests\test_document_endpoints.py::test_search_documents_by_filename PASSED [ 22%]
tests\test_document_endpoints.py::test_filter_documents_by_file_type PASSED [ 22%]
tests\test_document_endpoints.py::test_upload_same_name_creates_new_version PASSED [ 22%]
tests\test_document_endpoints.py::test_list_document_versions PASSED     [ 23%]
tests\test_document_endpoints.py::test_download_specific_version PASSED  [ 23%]
tests\test_document_endpoints.py::test_restore_previous_version PASSED   [ 23%]
tests\test_document_endpoints.py::test_max_versions_enforced PASSED      [ 23%]
tests\test_document_endpoints.py::test_delete_document_archives_all_versions PASSED [ 23%]
tests\test_document_endpoints.py::test_viewer_cannot_delete_document PASSED [ 23%]
tests\test_document_endpoints.py::test_viewer_can_download_document PASSED [ 23%]
tests\test_document_endpoints.py::test_editor_can_upload_with_folder_permission PASSED [ 23%]
tests\test_document_endpoints.py::test_granting_folder_permission_creates_audit_log PASSED [ 23%]
tests\test_document_endpoints.py::test_revoking_folder_permission_creates_audit_log PASSED [ 23%]
tests\test_document_endpoints.py::test_revoking_document_permission_creates_audit_log PASSED [ 23%]
tests\test_document_endpoints.py::test_editor_cannot_delete_others_document PASSED [ 23%]
tests\test_document_endpoints.py::test_editor_can_delete_own_document PASSED [ 23%]
tests\test_document_endpoints.py::test_delete_document_requires_editor_permission PASSED [ 23%]
tests\test_document_endpoints.py::test_delete_document_records_audit_log PASSED [ 24%]
tests\test_document_endpoints.py::test_access_logs_include_user_name PASSED [ 24%]
tests\test_document_endpoints.py::test_bulk_download_documents PASSED    [ 24%]
tests\test_document_endpoints.py::test_bulk_download_requires_permission PASSED [ 24%]
tests\test_document_endpoints.py::test_bulk_delete_documents PASSED      [ 24%]
tests\test_document_endpoints.py::test_bulk_delete_requires_owner_permission PASSED [ 24%]
tests\test_document_endpoints.py::test_bulk_delete_partial_failure PASSED [ 24%]
tests\test_document_endpoints.py::test_document_question_workflow PASSED [ 24%]
tests\test_document_export_jobs_api.py::TestDocumentExportJobEndpoints::test_queue_export_job PASSED [ 24%]
tests\test_document_export_jobs_api.py::TestDocumentExportJobEndpoints::test_get_export_job_status PASSED [ 24%]
tests\test_document_export_jobs_api.py::TestDocumentExportJobEndpoints::test_list_export_jobs PASSED [ 24%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_create_template PASSED [ 24%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_create_template_forbidden_other_org PASSED [ 24%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_list_templates PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_list_templates_with_filters PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_get_template PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_get_template_not_found PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_update_template PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_delete_template PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document_missing_variables PASSED [ 25%]
tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document_template_not_found PASSED [ 25%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_list_generated_documents PASSED [ 25%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_get_generated_document PASSED [ 25%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_update_document_status PASSED [ 25%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_update_document_content PASSED [ 25%]
tests\test_document_generation_api.py::TestTemplateRenderingService::test_complex_template_rendering PASSED [ 26%]
tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_as_pdf PASSED [ 26%]
tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_as_docx PASSED [ 26%]
tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_create_template_returns_403_when_org_mismatch PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_get_template_returns_404_when_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_update_template_returns_404_when_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_delete_template_returns_404_when_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_render_template_returns_404_when_template_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_get_generated_document_returns_404_when_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_update_generated_document_returns_404_when_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_update_document_status_returns_404_when_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_list_export_jobs_returns_404_when_document_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_queue_export_job_returns_404_when_document_not_found PASSED [ 26%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_get_export_job_status_returns_404_when_job_not_found PASSED [ 27%]
tests\test_document_generation_api_errors.py::TestDocumentGenerationAPIErrorPaths::test_list_document_versions_returns_404_when_document_not_found PASSED [ 27%]
tests\test_document_generation_models.py::test_create_document_template PASSED [ 27%]
tests\test_document_generation_models.py::test_template_status_enum PASSED [ 27%]
tests\test_document_generation_models.py::test_template_version_tracking PASSED [ 27%]
tests\test_document_generation_models.py::test_template_repr PASSED      [ 27%]
tests\test_document_generation_models.py::test_create_generated_document PASSED [ 27%]
tests\test_document_generation_models.py::test_generated_document_status_enum PASSED [ 27%]
tests\test_document_generation_models.py::test_generated_document_timestamps PASSED [ 27%]
tests\test_document_generation_models.py::test_generated_document_file_path PASSED [ 27%]
tests\test_document_generation_models.py::test_template_document_relationship PASSED [ 27%]
tests\test_document_generation_models.py::test_template_variables_json_field PASSED [ 27%]
tests\test_document_service.py::test_trim_document_versions_keeps_latest_twenty PASSED [ 27%]
tests\test_document_service.py::test_trim_document_versions_noop_when_within_limit PASSED [ 28%]
tests\test_document_service.py::test_bulk_download_documents_logs_access PASSED [ 28%]
tests\test_document_service.py::test_bulk_download_documents_requires_viewer_permission PASSED [ 28%]
tests\test_document_service_error_paths.py::test_delete_folder_with_documents_raises_value_error PASSED [ 28%]
tests\test_document_service_error_paths.py::test_delete_folder_with_subfolders_raises_value_error PASSED [ 28%]
tests\test_document_service_error_paths.py::test_upload_document_unsupported_file_type PASSED [ 28%]
tests\test_document_service_error_paths.py::test_upload_document_file_size_exceeds_limit PASSED [ 28%]
tests\test_document_service_error_paths.py::test_create_folder_insufficient_permissions_for_subfolder PASSED [ 28%]
tests\test_document_service_error_paths.py::test_create_folder_non_owner_cannot_create_top_level PASSED [ 28%]
tests\test_document_service_error_paths.py::test_upload_document_non_owner_cannot_upload_to_root PASSED [ 28%]
tests\test_email_service.py::test_send_email_success PASSED              [ 28%]
tests\test_email_service.py::test_send_email_failure PASSED              [ 28%]
tests\test_email_service.py::test_render_template_success PASSED         [ 28%]
tests\test_email_service.py::test_render_template_not_found PASSED       [ 28%]
tests\test_email_service.py::test_queue_email_success PASSED             [ 29%]
tests\test_email_service.py::test_retry_failed_email_success PASSED      [ 29%]
tests\test_email_service.py::test_retry_failed_email_max_retries PASSED  [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_has_audio_podcast_access PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_starter_no_audio_podcast_access PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_no_video_podcast_access PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_premium_has_video_podcast_access PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_premium_has_youtube_integration PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_no_youtube_integration PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_enterprise_has_live_streaming PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_premium_no_live_streaming PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_enterprise_has_multi_language_transcription PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_has_basic_transcription PASSED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_no_ai_enhanced_transcription PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_raises_feature_not_found_for_invalid_feature PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_all_tiers_have_core_features PASSED [ 30%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_starter_tier_features PASSED [ 30%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_professional_tier_features PASSED [ 30%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_premium_tier_features PASSED [ 30%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_enterprise_tier_features PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-podcast_audio-False] PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-podcast_video-False] PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-youtube_integration-False] PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-live_streaming-False] PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-deal_management-True] PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-podcast_audio-True] PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-podcast_video-False] PASSED [ 30%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-youtube_integration-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-live_streaming-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-transcription_basic-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-transcription_ai_enhanced-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-podcast_audio-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-podcast_video-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-youtube_integration-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-live_streaming-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-transcription_basic-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-transcription_ai_enhanced-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-transcription_multi_language-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-podcast_audio-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-podcast_video-True] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-youtube_integration-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-live_streaming-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-transcription_basic-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-transcription_ai_enhanced-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-transcription_multi_language-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureNotFoundError::test_feature_not_found_error_message PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_tier_label_starter PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_tier_label_professional PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_tier_label_premium PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_tier_label_enterprise PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_tier_label_unknown PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_cta_existing_feature PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_cta_non_existing_feature PASSED [ 32%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_required_tier_starter_feature PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_required_tier_professional_feature PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_required_tier_premium_feature PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_required_tier_enterprise_feature PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_required_tier_raises_feature_not_found PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_message_starter_tier PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_message_professional_tier PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_message_premium_tier PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_message_enterprise_tier PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_message_same_tier_required PASSED [ 33%]
tests\test_entitlement_service_complete.py::TestEntitlementServiceUtilities::test_get_feature_upgrade_message_handles_unknown_feature PASSED [ 33%]
tests\test_event_models.py::TestEventModel::test_create_event PASSED     [ 33%]
tests\test_event_models.py::TestEventModel::test_event_requires_organization PASSED [ 33%]
tests\test_event_models.py::TestEventModel::test_event_location_types PASSED [ 33%]
tests\test_event_models.py::TestEventTicketModel::test_create_event_ticket PASSED [ 34%]
tests\test_event_models.py::TestEventTicketModel::test_ticket_requires_event PASSED [ 34%]
tests\test_event_models.py::TestEventReminderModel::test_create_event_reminder PASSED [ 34%]
tests\test_event_models.py::TestEventRegistrationModel::test_create_registration PASSED [ 34%]
tests\test_event_models.py::TestEventRegistrationModel::test_registration_requires_event_and_user PASSED [ 34%]
tests\test_event_models.py::TestEventSessionModel::test_create_event_session PASSED [ 34%]
tests\test_event_models.py::TestEventSessionModel::test_session_requires_event PASSED [ 34%]
tests\test_event_models.py::TestEventAnalyticsModel::test_create_event_analytics PASSED [ 34%]
tests\test_event_notification_service.py::test_send_registration_confirmation_email_no_sendgrid PASSED [ 34%]
tests\test_event_notification_service.py::test_send_registration_confirmation_email_sends_payload PASSED [ 34%]
tests\test_event_payment_api.py::test_initiate_purchase_success PASSED   [ 34%]
tests\test_event_payment_api.py::test_initiate_purchase_invalid_event PASSED [ 34%]
tests\test_event_payment_api.py::test_initiate_purchase_invalid_ticket_type PASSED [ 34%]
tests\test_event_payment_api.py::test_webhook_payment_succeeded PASSED   [ 35%]
tests\test_event_payment_api.py::test_webhook_invalid_signature PASSED   [ 35%]
tests\test_event_payment_api.py::test_get_receipt_success PASSED         [ 35%]
tests\test_event_payment_api.py::test_get_receipt_not_found PASSED       [ 35%]
tests\test_event_payment_service.py::test_create_checkout_session_success PASSED [ 35%]
tests\test_event_payment_service.py::test_create_checkout_session_invalid_ticket_type PASSED [ 35%]
tests\test_event_payment_service.py::test_create_checkout_session_sold_out_ticket PASSED [ 35%]
tests\test_event_payment_service.py::test_handle_webhook_payment_succeeded PASSED [ 35%]
tests\test_event_payment_service.py::test_handle_webhook_payment_failed PASSED [ 35%]
tests\test_event_payment_service.py::test_handle_webhook_invalid_signature PASSED [ 35%]
tests\test_event_payment_service.py::test_assign_tickets_success PASSED  [ 35%]
tests\test_event_payment_service.py::test_generate_receipt_success PASSED [ 35%]
tests\test_event_payment_service.py::test_process_refund_success PASSED  [ 35%]
tests\test_event_payment_service.py::test_process_refund_partial PASSED  [ 35%]
tests\test_event_reminder_service.py::TestEventReminderService::test_schedule_reminders_creates_entries PASSED [ 36%]
tests\test_event_reminder_service.py::TestEventReminderService::test_send_due_reminders_triggers_notifications PASSED [ 36%]
tests\test_event_service.py::TestEventService::test_create_event PASSED  [ 36%]
tests\test_event_service.py::TestEventService::test_get_event PASSED     [ 36%]
tests\test_event_service.py::TestEventService::test_get_event_wrong_organization PASSED [ 36%]
tests\test_event_service.py::TestEventService::test_list_events_pagination PASSED [ 36%]
tests\test_event_service.py::TestEventService::test_update_event PASSED  [ 36%]
tests\test_event_service.py::TestEventService::test_delete_event_soft_delete PASSED [ 36%]
tests\test_event_service.py::TestEventTicketService::test_create_ticket PASSED [ 36%]
tests\test_event_service.py::TestEventTicketService::test_create_ticket_invalid_event PASSED [ 36%]
tests\test_event_service.py::TestEventRegistrationService::test_create_registration PASSED [ 36%]
tests\test_event_service.py::TestEventRegistrationService::test_create_registration_with_ticket PASSED [ 36%]
tests\test_event_service.py::TestEventRegistrationService::test_create_registration_sold_out_ticket PASSED [ 36%]
tests\test_event_service.py::TestEventRegistrationService::test_cancel_registration_updates_ticket PASSED [ 37%]
tests\test_event_service.py::TestEventAnalyticsService::test_get_event_analytics PASSED [ 37%]
tests\test_event_service.py::TestEventAnalyticsService::test_analytics_with_sessions PASSED [ 37%]
tests\test_events_api_errors.py::TestEventsAPIErrorPaths::test_get_event_returns_404_when_not_found PASSED [ 37%]
tests\test_events_api_errors.py::TestEventsAPIErrorPaths::test_update_event_returns_404_when_not_found PASSED [ 37%]
tests\test_events_api_errors.py::TestEventsAPIErrorPaths::test_delete_event_returns_404_when_not_found PASSED [ 37%]
tests\test_events_api_errors.py::TestEventsAPIErrorPaths::test_get_event_returns_404_when_from_other_org PASSED [ 37%]
tests\test_events_api_errors.py::TestEventsAPIErrorPaths::test_update_event_returns_404_when_from_other_org PASSED [ 37%]
tests\test_events_api_errors.py::TestEventsAPIErrorPaths::test_delete_event_returns_404_when_from_other_org PASSED [ 37%]
tests\test_events_api_errors.py::TestEventsAPIErrorPaths::test_list_events_only_shows_own_org PASSED [ 37%]
tests\test_financial_api.py::test_calculate_financial_ratios_endpoint PASSED [ 37%]
tests\test_financial_api.py::test_calculate_ratios_requires_authentication PASSED [ 37%]
tests\test_financial_api.py::test_calculate_ratios_deal_not_found PASSED [ 37%]
tests\test_financial_api.py::test_calculate_ratios_with_partial_data PASSED [ 38%]
tests\test_financial_api.py::test_get_financial_connections_endpoint_returns_empty_list_when_no_connections PASSED [ 38%]
tests\test_financial_api.py::test_get_financial_connections_endpoint_returns_connections PASSED [ 38%]
tests\test_financial_api.py::test_get_financial_ratios_not_found PASSED  [ 38%]
tests\test_financial_api.py::test_get_financial_narrative_not_found PASSED [ 38%]
tests\test_financial_api.py::test_connect_xero_initiates_oauth_flow PASSED [ 38%]
tests\test_financial_api.py::test_connect_xero_with_invalid_deal PASSED  [ 38%]
tests\test_financial_api.py::test_xero_oauth_callback_success PASSED     [ 38%]
tests\test_financial_api.py::test_xero_oauth_callback_missing_code PASSED [ 38%]
tests\test_financial_api.py::test_sync_financial_data_success PASSED     [ 38%]
tests\test_financial_api.py::test_sync_financial_data_no_connection PASSED [ 38%]
tests\test_financial_api.py::test_connect_quickbooks_initiates_oauth_flow PASSED [ 38%]
tests\test_financial_api.py::test_connect_quickbooks_with_invalid_deal PASSED [ 38%]
tests\test_financial_api.py::test_quickbooks_oauth_callback_success PASSED [ 38%]
tests\test_financial_api.py::test_quickbooks_oauth_callback_missing_params PASSED [ 39%]
tests\test_financial_api.py::test_sync_quickbooks_financial_data_success PASSED [ 39%]
tests\test_financial_api.py::test_sync_quickbooks_financial_data_no_connection PASSED [ 39%]
tests\test_financial_api.py::test_quickbooks_connection_status PASSED    [ 39%]
tests\test_financial_api.py::test_disconnect_quickbooks_connection PASSED [ 39%]
tests\test_financial_api.py::test_connect_netsuite_initiates_oauth_flow PASSED [ 39%]
tests\test_financial_api.py::test_connect_netsuite_with_invalid_deal PASSED [ 39%]
tests\test_financial_api.py::test_netsuite_oauth_callback_success PASSED [ 39%]
tests\test_financial_api.py::test_sync_netsuite_financial_data_success PASSED [ 39%]
tests\test_financial_api.py::test_sync_netsuite_financial_data_no_connection PASSED [ 39%]
tests\test_financial_api.py::test_connect_sage_initiates_oauth_flow PASSED [ 39%]
tests\test_financial_api.py::test_connect_sage_with_invalid_deal PASSED  [ 39%]
tests\test_financial_api.py::test_sage_oauth_callback_success PASSED     [ 39%]
tests\test_financial_api.py::test_sync_sage_financial_data_success PASSED [ 40%]
tests\test_financial_api.py::test_sync_sage_financial_data_no_connection PASSED [ 40%]
tests\test_financial_api.py::test_get_readiness_score_success PASSED     [ 40%]
tests\test_financial_api.py::test_get_readiness_score_no_narrative PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_calculate_ratios_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_get_ratios_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_get_connections_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_get_narrative_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_get_readiness_score_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_connect_xero_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_sync_financial_data_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_api_errors.py::TestFinancialAPIErrorPaths::test_disconnect_quickbooks_returns_403_when_deal_in_other_org PASSED [ 40%]
tests\test_financial_models_sync.py::test_create_financial_connection PASSED [ 40%]
tests\test_financial_models_sync.py::test_financial_connection_cascade_delete PASSED [ 40%]
tests\test_financial_models_sync.py::test_create_financial_statement_balance_sheet PASSED [ 41%]
tests\test_financial_models_sync.py::test_financial_statement_with_json_fields PASSED [ 41%]
tests\test_financial_models_sync.py::test_create_financial_ratios PASSED [ 41%]
tests\test_financial_models_sync.py::test_financial_ratio_nullable_fields PASSED [ 41%]
tests\test_financial_models_sync.py::test_create_financial_narrative PASSED [ 41%]
tests\test_financial_models_sync.py::test_financial_narrative_version_control PASSED [ 41%]
tests\test_financial_models_sync.py::test_complete_financial_data_chain PASSED [ 41%]
tests\test_financial_models_sync.py::test_cascade_delete_all_financial_data PASSED [ 41%]
tests\test_financial_narrative_service.py::test_build_narrative_prompt_with_complete_data PASSED [ 41%]
tests\test_financial_narrative_service.py::test_build_narrative_prompt_with_minimal_data PASSED [ 41%]
tests\test_financial_narrative_service.py::test_parse_narrative_response_with_complete_response PASSED [ 41%]
tests\test_financial_narrative_service.py::test_parse_narrative_response_with_red_flags PASSED [ 41%]
tests\test_financial_narrative_service.py::test_calculate_readiness_score_high_quality_deal PASSED [ 41%]
tests\test_financial_narrative_service.py::test_calculate_readiness_score_low_quality_deal PASSED [ 42%]
tests\test_financial_narrative_service.py::test_calculate_readiness_score_moderate_deal PASSED [ 42%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_success PASSED [ 42%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_returns_existing_by_default PASSED [ 42%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_raises_error_when_no_data PASSED [ 42%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_raises_error_when_deal_not_found PASSED [ 42%]
tests\test_financial_ratios.py::test_current_ratio_calculation PASSED    [ 42%]
tests\test_financial_ratios.py::test_current_ratio_with_zero_liabilities PASSED [ 42%]
tests\test_financial_ratios.py::test_quick_ratio_calculation PASSED      [ 42%]
tests\test_financial_ratios.py::test_quick_ratio_with_zero_liabilities PASSED [ 42%]
tests\test_financial_ratios.py::test_cash_ratio_calculation PASSED       [ 42%]
tests\test_financial_ratios.py::test_operating_cash_flow_ratio_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_defensive_interval_ratio_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_gross_profit_margin_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_gross_profit_margin_with_zero_revenue PASSED [ 43%]
tests\test_financial_ratios.py::test_operating_profit_margin_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_net_profit_margin_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_return_on_assets_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_return_on_equity_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_return_on_invested_capital_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_ebitda_margin_calculation PASSED    [ 43%]
tests\test_financial_ratios.py::test_ebit_margin_calculation PASSED      [ 43%]
tests\test_financial_ratios.py::test_debt_to_equity_calculation PASSED   [ 43%]
tests\test_financial_ratios.py::test_debt_to_equity_with_zero_equity PASSED [ 43%]
tests\test_financial_ratios.py::test_debt_to_assets_calculation PASSED   [ 43%]
tests\test_financial_ratios.py::test_equity_multiplier_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_interest_coverage_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_interest_coverage_with_zero_interest PASSED [ 44%]
tests\test_financial_ratios.py::test_debt_service_coverage_calculation PASSED [ 44%]
tests\test_financial_ratios.py::test_financial_leverage_calculation PASSED [ 44%]
tests\test_financial_ratios.py::test_calculate_all_ratios_comprehensive PASSED [ 44%]
tests\test_financial_ratios.py::test_calculate_all_ratios_with_missing_data PASSED [ 44%]
tests\test_financial_ratios.py::test_calculate_all_ratios_with_empty_data PASSED [ 44%]
tests\test_financial_xero_integration.py::test_placeholder_ratio_engine SKIPPED [ 44%]
tests\test_invite_service.py::test_invitation_error_initialization PASSED [ 44%]
tests\test_invite_service.py::test_invitation_error_default_status_code PASSED [ 44%]
tests\test_invite_service.py::test_get_clerk_client_success PASSED       [ 44%]
tests\test_invite_service.py::test_get_clerk_client_missing_secret_key PASSED [ 44%]
tests\test_invite_service.py::test_extract_error_message_with_long_message PASSED [ 44%]
tests\test_invite_service.py::test_extract_error_message_without_long_message PASSED [ 44%]
tests\test_invite_service.py::test_extract_error_message_no_data PASSED  [ 45%]
tests\test_invite_service.py::test_extract_error_message_no_errors PASSED [ 45%]
tests\test_invite_service.py::test_create_invitation_success PASSED      [ 45%]
tests\test_invite_service.py::test_create_invitation_with_minimal_params PASSED [ 45%]
tests\test_invite_service.py::test_create_invitation_clerk_errors PASSED [ 45%]
tests\test_invite_service.py::test_create_invitation_sdk_error PASSED    [ 45%]
tests\test_invite_service.py::test_list_pending_invitations_success PASSED [ 45%]
tests\test_invite_service.py::test_list_pending_invitations_default_params PASSED [ 45%]
tests\test_invite_service.py::test_list_pending_invitations_clerk_errors PASSED [ 45%]
tests\test_invite_service.py::test_list_pending_invitations_sdk_error PASSED [ 45%]
tests\test_isolation_guards.py::test_database_state_can_persist_within_test PASSED [ 45%]
tests\test_isolation_guards.py::test_database_is_clean_between_tests PASSED [ 45%]
tests\test_isolation_guards.py::test_stripe_mock_records_calls PASSED    [ 45%]
tests\test_isolation_guards.py::test_stripe_mock_is_reset_between_tests PASSED [ 45%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_subscribe_with_invalid_email PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_subscribe_with_missing_email PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_contact_with_invalid_data PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_contact_with_missing_fields PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_contact_with_too_long_message PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_contact_with_too_long_name PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_contact_success_with_minimal_data PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_subscribe_success PASSED [ 46%]
tests\test_marketing_api_errors.py::TestMarketingAPIErrorPaths::test_subscribe_duplicate_email PASSED [ 46%]
tests\test_master_admin_api.py::test_master_admin_requires_auth PASSED   [ 46%]
tests\test_master_admin_api.py::test_goal_crud_flow PASSED               [ 46%]
tests\test_master_admin_api.py::test_activity_crud_and_listing PASSED    [ 46%]
tests\test_master_admin_api.py::test_scores_and_dashboard_stats FAILED   [ 46%]
tests\test_master_admin_api.py::test_focus_session_flow PASSED           [ 47%]
tests\test_master_admin_api.py::test_nudge_management PASSED             [ 47%]
tests\test_master_admin_api.py::test_meeting_template_management PASSED  [ 47%]
tests\test_master_admin_api.py::test_prospect_crud_flow PASSED           [ 47%]
tests\test_master_admin_api.py::test_deal_pipeline_flow PASSED           [ 47%]
tests\test_master_admin_api.py::test_campaign_and_recipient_management PASSED [ 47%]
tests\test_master_admin_api.py::test_content_script_and_piece_flow PASSED [ 47%]
tests\test_master_admin_api.py::test_lead_capture_flow PASSED            [ 47%]
tests\test_master_admin_api.py::test_collateral_library_flow PASSED      [ 47%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_create_admin_goal PASSED [ 47%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_unique_constraint PASSED [ 47%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_defaults PASSED [ 47%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_repr PASSED [ 47%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_create_admin_activity PASSED [ 47%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_type_constraint SKIPPED [ 48%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_status_constraint SKIPPED [ 48%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_default_amount PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_with_prospect PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_create_admin_score PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_range_constraint PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_unique_constraint PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_defaults PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_create_focus_session PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_complete_focus_session PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_interrupted_focus_session PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_create_nudge PASSED [ 48%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_nudge_type_constraint SKIPPED [ 48%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_nudge_priority_constraint SKIPPED [ 49%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_mark_nudge_as_read PASSED [ 49%]
tests\test_master_admin_models.py::TestAdminMeetingModel::test_create_meeting_template PASSED [ 49%]
tests\test_master_admin_models.py::TestAdminMeetingModel::test_meeting_type_constraint SKIPPED [ 49%]
tests\test_master_admin_models.py::TestAdminMeetingModel::test_meeting_default_duration PASSED [ 49%]
tests\test_models_financial_connection.py::test_create_financial_connection PASSED [ 49%]
tests\test_models_financial_connection.py::test_financial_connection_with_optional_fields PASSED [ 49%]
tests\test_models_financial_connection.py::test_financial_connection_cascade_delete_with_deal PASSED [ 49%]
tests\test_models_financial_connection.py::test_financial_connection_relationship_to_deal PASSED [ 49%]
tests\test_models_financial_connection.py::test_financial_connection_soft_delete PASSED [ 49%]
tests\test_models_financial_connection.py::test_financial_connection_status_values PASSED [ 49%]
tests\test_netsuite_integration.py::test_netsuite_rest_api_client_can_be_imported SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_real_netsuite_client_class_exists SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_netsuite_oauth_url_uses_real_credentials SKIPPED [ 50%]
tests\test_netsuite_integration.py::test_netsuite_client_has_real_configuration SKIPPED [ 50%]
tests\test_netsuite_integration.py::test_token_exchange_structure_matches_netsuite_api SKIPPED [ 50%]
tests\test_netsuite_integration.py::test_get_connections_returns_real_company_structure SKIPPED [ 50%]
tests\test_netsuite_integration.py::test_balance_sheet_import_uses_real_netsuite_api_format SKIPPED [ 50%]
tests\test_netsuite_integration.py::test_netsuite_rest_api_error_handling SKIPPED [ 50%]
tests\test_netsuite_integration.py::test_netsuite_account_id_configuration SKIPPED [ 50%]
tests\test_netsuite_integration.py::test_full_netsuite_oauth_flow_with_real_api SKIPPED [ 50%]
tests\test_notification_service.py::test_check_preferences_returns_true_when_no_prefs_exist PASSED [ 50%]
tests\test_notification_service.py::test_check_preferences_returns_false_when_email_disabled PASSED [ 50%]
tests\test_notification_service.py::test_check_preferences_returns_false_when_type_disabled PASSED [ 50%]
tests\test_notification_service.py::test_check_preferences_returns_true_when_type_enabled PASSED [ 50%]
tests\test_notification_service.py::test_check_preferences_unknown_type_defaults_to_allowed PASSED [ 50%]
tests\test_notification_service.py::test_send_notification_skips_when_preference_disabled PASSED [ 50%]
tests\test_notification_service.py::test_send_notification_sends_email_when_allowed PASSED [ 51%]
tests\test_notification_service.py::test_send_notification_unsupported_channel PASSED [ 51%]
tests\test_notification_service.py::test_send_notification_template_error PASSED [ 51%]
tests\test_notification_service.py::test_send_notification_user_not_found PASSED [ 51%]
tests\test_notification_service.py::test_get_template_name_maps_correctly PASSED [ 51%]
tests\test_notification_service.py::test_get_template_name_defaults_for_unknown PASSED [ 51%]
tests\test_notification_service.py::test_get_email_subject_maps_correctly PASSED [ 51%]
tests\test_notification_service.py::test_get_email_subject_defaults_for_unknown PASSED [ 51%]
tests\test_notification_service.py::test_get_email_subject_handles_missing_event_name PASSED [ 51%]
tests\test_notifications_api.py::TestNotificationPreferencesAPI::test_get_preferences_returns_defaults_when_none_exist PASSED [ 51%]
tests\test_notifications_api.py::TestNotificationPreferencesAPI::test_get_preferences_returns_user_preferences PASSED [ 51%]
tests\test_notifications_api.py::TestNotificationPreferencesAPI::test_update_preferences_creates_new_preferences PASSED [ 51%]
tests\test_notifications_api.py::TestNotificationPreferencesAPI::test_update_preferences_updates_existing_preferences PASSED [ 51%]
tests\test_notifications_api.py::TestNotificationPreferencesAPI::test_update_preferences_partial_update PASSED [ 52%]
tests\test_notifications_api.py::TestNotificationPreferencesAPI::test_update_preferences_all_fields PASSED [ 52%]
tests\test_organization_service.py::TestSlugify::test_slugify_normalizes_text PASSED [ 52%]
tests\test_organization_service.py::TestSlugify::test_slugify_handles_special_characters PASSED [ 52%]
tests\test_organization_service.py::TestSlugify::test_slugify_handles_empty_string PASSED [ 52%]
tests\test_organization_service.py::TestSlugify::test_slugify_handles_only_special_characters PASSED [ 52%]
tests\test_organization_service.py::TestSlugify::test_slugify_trims_hyphens PASSED [ 52%]
tests\test_organization_service.py::TestEnsureUniqueSlug::test_ensure_unique_slug_returns_original_when_unique PASSED [ 52%]
tests\test_organization_service.py::TestEnsureUniqueSlug::test_ensure_unique_slug_appends_suffix_when_conflict PASSED [ 52%]
tests\test_organization_service.py::TestEnsureUniqueSlug::test_ensure_unique_slug_increments_suffix PASSED [ 52%]
tests\test_organization_service.py::TestEnsureUniqueSlug::test_ensure_unique_slug_excludes_id PASSED [ 52%]
tests\test_organization_service.py::TestEnsureUniqueSlug::test_ensure_unique_slug_handles_multiple_conflicts PASSED [ 52%]
tests\test_organization_service.py::TestNormalizeSubscriptionTier::test_normalize_subscription_tier_returns_enum_value PASSED [ 52%]
tests\test_organization_service.py::TestNormalizeSubscriptionTier::test_normalize_subscription_tier_handles_valid_string PASSED [ 52%]
tests\test_organization_service.py::TestNormalizeSubscriptionTier::test_normalize_subscription_tier_defaults_to_starter_invalid PASSED [ 53%]
tests\test_organization_service.py::TestCoerceMetadata::test_coerce_metadata_extracts_all_fields PASSED [ 53%]
tests\test_organization_service.py::TestCoerceMetadata::test_coerce_metadata_uses_fallback_name PASSED [ 53%]
tests\test_organization_service.py::TestCoerceMetadata::test_coerce_metadata_generates_slug_when_missing PASSED [ 53%]
tests\test_organization_service.py::TestCoerceMetadata::test_coerce_metadata_handles_missing_public_metadata PASSED [ 53%]
tests\test_organization_service.py::TestCoerceMetadata::test_coerce_metadata_handles_none_values PASSED [ 53%]
tests\test_organization_service.py::TestUpsertFromClerk::test_upsert_from_clerk_raises_error_when_id_missing PASSED [ 53%]
tests\test_organization_service.py::TestUpsertFromClerk::test_upsert_from_clerk_creates_new_organization PASSED [ 53%]
tests\test_organization_service.py::TestUpsertFromClerk::test_upsert_from_clerk_updates_existing_organization PASSED [ 53%]
tests\test_organization_service.py::TestUpsertFromClerk::test_upsert_from_clerk_updates_slug_when_changed PASSED [ 53%]
tests\test_organization_service.py::TestUpsertFromClerk::test_upsert_from_clerk_preserves_slug_when_unchanged PASSED [ 53%]
tests\test_organization_service.py::TestUpsertFromClerk::test_upsert_from_clerk_ensures_unique_slug_on_conflict PASSED [ 53%]
tests\test_organization_service.py::TestUpsertFromClerk::test_upsert_from_clerk_handles_minimal_data PASSED [ 53%]
tests\test_organization_service.py::TestDeactivateOrganization::test_deactivate_organization_sets_is_active_false PASSED [ 54%]
tests\test_organization_service.py::TestDeactivateOrganization::test_deactivate_organization_returns_none_when_not_found PASSED [ 54%]
tests\test_organization_service.py::TestDeactivateOrganization::test_deactivate_organization_refreshes_object PASSED [ 54%]
tests\test_path_safety.py::test_pytest_ignore_collect_delegates_to_path_safety PASSED [ 54%]
tests\test_path_safety.py::test_reserved_name_detection_handles_strings PASSED [ 54%]
tests\test_path_safety.py::test_reserved_name_detection_handles_py_path_like_objects PASSED [ 54%]
tests\test_path_safety.py::test_should_ignore_path_only_on_windows PASSED [ 54%]
tests\test_pipeline_template_api.py::test_create_and_list_pipeline_templates PASSED [ 54%]
tests\test_pipeline_template_api.py::test_update_pipeline_template PASSED [ 54%]
tests\test_pipeline_template_api.py::test_delete_pipeline_template PASSED [ 54%]
tests\test_pipeline_template_api_errors.py::TestPipelineTemplateAPIErrorPaths::test_get_template_returns_404_when_not_found PASSED [ 54%]
tests\test_pipeline_template_api_errors.py::TestPipelineTemplateAPIErrorPaths::test_update_template_returns_404_when_not_found PASSED [ 54%]
tests\test_pipeline_template_api_errors.py::TestPipelineTemplateAPIErrorPaths::test_delete_template_returns_404_when_not_found PASSED [ 54%]
tests\test_pipeline_template_api_errors.py::TestPipelineTemplateAPIErrorPaths::test_get_template_returns_404_when_from_other_org PASSED [ 54%]
tests\test_pipeline_template_api_errors.py::TestPipelineTemplateAPIErrorPaths::test_update_template_returns_404_when_from_other_org PASSED [ 55%]
tests\test_pipeline_template_api_errors.py::TestPipelineTemplateAPIErrorPaths::test_delete_template_returns_404_when_from_other_org PASSED [ 55%]
tests\test_pipeline_template_api_errors.py::TestPipelineTemplateAPIErrorPaths::test_list_templates_only_shows_own_org PASSED [ 55%]
tests\test_pipeline_template_schemas.py::test_stage_color_normalizes_to_uppercase_hex PASSED [ 55%]
tests\test_pipeline_template_schemas.py::test_stage_color_without_hash_gets_hash_prefix PASSED [ 55%]
tests\test_pipeline_template_schemas.py::test_stage_color_with_hash_preserves_hash_and_uppercases PASSED [ 55%]
tests\test_pipeline_template_schemas.py::test_template_requires_at_least_one_stage PASSED [ 55%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_starter_user_blocked_from_creating_episode PASSED [ 55%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_quota_service_passes_db_session PASSED [ 55%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_can_create_episode PASSED [ 55%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_quota_exceeded_returns_429 PASSED [ 55%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_blocked_from_video_episode PASSED [ 55%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_premium_user_can_create_video_episode PASSED [ 55%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_returns_quota_summary_for_professional PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_reports_unlimited_for_premium PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_blocks_starter_tier PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_sets_warning_headers_when_near_limit PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_sets_upgrade_headers_when_quota_exceeded PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastFeatureAccessEndpoint::test_feature_access_returns_true_for_authorized_tier PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastFeatureAccessEndpoint::test_feature_access_returns_false_for_insufficient_tier PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastFeatureAccessEndpoint::test_feature_access_returns_404_for_unknown_feature PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastListEndpoint::test_list_episodes_returns_organizations_episodes PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastListEndpoint::test_list_episodes_filters_by_status PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastGetSingleEndpoint::test_get_single_episode_returns_episode PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastGetSingleEndpoint::test_get_single_episode_returns_404_when_not_found PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastUpdateEndpoint::test_update_episode_modifies_fields PASSED [ 56%]
tests\test_podcast_api.py::TestPodcastDeleteEndpoint::test_delete_episode_removes_episode PASSED [ 57%]
tests\test_podcast_api.py::TestPodcastDeleteEndpoint::test_delete_episode_returns_404_when_not_found PASSED [ 57%]
tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_premium_user_can_publish_video_to_youtube PASSED [ 57%]
tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_podcast_youtube_upload_requires_video_asset PASSED [ 57%]
tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_youtube_upload_permission_error_returns_403 PASSED [ 57%]
tests\test_podcast_api.py::TestFeatureAccessEndpoint::test_feature_access_includes_labels_when_access_granted PASSED [ 57%]
tests\test_podcast_api.py::TestFeatureAccessEndpoint::test_feature_access_includes_upgrade_message_when_denied PASSED [ 57%]
tests\test_podcast_api.py::TestFeatureAccessEndpoint::test_feature_access_returns_404_for_unknown_feature PASSED [ 57%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_professional_success PASSED [ 57%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_starter_blocked PASSED [ 57%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_validates_file_format PASSED [ 57%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_validates_file_size PASSED [ 57%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_updates_episode_audio_url PASSED [ 57%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_premium_success PASSED [ 57%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_professional_blocked PASSED [ 58%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_validates_file_format PASSED [ 58%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_validates_file_size PASSED [ 58%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_generates_thumbnail PASSED [ 58%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_accepts_mov_format PASSED [ 58%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_updates_episode_video_url PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_audio_professional_success PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_starter_blocked PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_requires_audio_file PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_updates_episode_transcript PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_handles_whisper_api_error PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_multi_language_requires_enterprise PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_multi_language_enterprise_success PASSED [ 58%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_response_includes_metadata PASSED [ 59%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_txt_success PASSED [ 59%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_srt_success PASSED [ 59%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_requires_transcript PASSED [ 59%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_starter_blocked PASSED [ 59%]
tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_premium_success PASSED [ 59%]
tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_requires_video PASSED [ 59%]
tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_professional_blocked PASSED [ 59%]
tests\test_podcast_service.py::TestPodcastService::test_create_episode PASSED [ 59%]
tests\test_podcast_service.py::TestPodcastService::test_get_episodes_filters_by_status PASSED [ 59%]
tests\test_podcast_service.py::TestPodcastService::test_publish_episode_sets_timestamp PASSED [ 59%]
tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_uses_whisper PASSED [ 59%]
tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_requires_entitlement PASSED [ 59%]
tests\test_podcast_service.py::TestPodcastService::test_get_episode_analytics_aggregates_platform_totals PASSED [ 59%]
tests\test_podcast_service.py::TestPodcastService::test_generate_rss_feed_includes_published_episodes PASSED [ 60%]
tests\test_podcast_service.py::TestPodcastService::test_multi_tenant_isolation PASSED [ 60%]
tests\test_podcast_service.py::TestPodcastService::test_update_episode_mutates_fields PASSED [ 60%]
tests\test_podcast_service.py::TestPodcastService::test_delete_episode_removes_record PASSED [ 60%]
tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_missing_episode_raises PASSED [ 60%]
tests\test_quickbooks_integration.py::test_quickbooks_python_sdk_can_be_imported SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_real_quickbooks_client_class_exists SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_quickbooks_oauth_url_uses_real_credentials SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_quickbooks_client_has_real_configuration SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_token_exchange_structure_matches_quickbooks_api SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_get_connections_returns_real_company_structure SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_balance_sheet_import_uses_real_quickbooks_api_format SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_quickbooks_sdk_error_handling SKIPPED [ 60%]
tests\test_quickbooks_integration.py::test_full_quickbooks_oauth_flow_with_real_api SKIPPED [ 61%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_professional_tier_allows_creation_within_quota PASSED [ 61%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_professional_tier_blocks_creation_at_quota_limit PASSED [ 61%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_premium_tier_unlimited_never_blocks PASSED [ 61%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_enterprise_tier_unlimited_never_blocks PASSED [ 61%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_starter_tier_blocks_all_podcast_creation PASSED [ 61%]
tests\test_quota_service.py::TestGetRemainingQuota::test_professional_tier_returns_correct_remaining PASSED [ 61%]
tests\test_quota_service.py::TestGetRemainingQuota::test_premium_tier_returns_unlimited_indicator PASSED [ 61%]
tests\test_quota_service.py::TestGetRemainingQuota::test_returns_zero_when_quota_exhausted PASSED [ 61%]
tests\test_quota_service.py::TestIncrementEpisodeCount::test_increments_usage_count_in_database PASSED [ 61%]
tests\test_quota_service.py::TestIncrementEpisodeCount::test_sync_session_increments_usage PASSED [ 61%]
tests\test_quota_service.py::TestIncrementEpisodeCount::test_creates_new_usage_record_for_first_episode PASSED [ 61%]
tests\test_quota_service.py::TestGetMonthlyUsage::test_returns_current_month_usage_count PASSED [ 61%]
tests\test_quota_service.py::TestGetMonthlyUsage::test_sync_session_returns_usage PASSED [ 61%]
tests\test_quota_service.py::TestGetMonthlyUsage::test_returns_zero_when_no_usage_records PASSED [ 62%]
tests\test_quota_service.py::TestQuotaExceededError::test_quota_exceeded_error_has_clear_message PASSED [ 62%]
tests\test_quota_service.py::TestQuotaExceededError::test_quota_exceeded_error_includes_upgrade_guidance PASSED [ 62%]
tests\test_quota_service.py::TestGetQuotaSummary::test_returns_professional_summary PASSED [ 62%]
tests\test_quota_service.py::TestGetQuotaSummary::test_returns_unlimited_summary PASSED [ 62%]
tests\test_quota_service.py::TestGetQuotaSummary::test_sets_warning_status_when_usage_exceeds_eighty_percent PASSED [ 62%]
tests\test_quota_service.py::TestGetQuotaSummary::test_sets_critical_status_when_usage_exceeds_ninety_percent PASSED [ 62%]
tests\test_quota_service.py::TestGetQuotaSummary::test_includes_period_bounds_for_monthly_reset PASSED [ 62%]
tests\test_quota_service.py::TestGetQuotaSummary::test_usage_resets_when_new_month_starts PASSED [ 62%]
tests\test_quota_service.py::TestGetQuotaSummary::test_marks_quota_exceeded_as_upgrade_required PASSED [ 62%]
tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_helper_is_defined PASSED [ 62%]
tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_creates_zero_record PASSED [ 62%]
tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_is_idempotent PASSED [ 62%]
tests\test_quota_service.py::TestMonthlyQuotaReset::test_quota_resets_when_new_billing_cycle_starts PASSED [ 63%]
tests\test_quota_service.py::TestMonthlyQuotaReset::test_usage_count_returns_zero_in_new_month PASSED [ 63%]
tests\test_quota_service.py::TestMonthlyQuotaReset::test_remaining_quota_resets_after_month_boundary PASSED [ 63%]
tests\test_rbac.py::test_get_current_admin_user_with_admin PASSED        [ 63%]
tests\test_rbac.py::test_get_current_admin_user_with_non_admin PASSED    [ 63%]
tests\test_rbac.py::test_require_role_exact_match PASSED                 [ 63%]
tests\test_rbac.py::test_require_role_no_match PASSED                    [ 63%]
tests\test_rbac.py::test_require_role_admin_override PASSED              [ 63%]
tests\test_rbac.py::test_require_min_role_exact_match PASSED             [ 63%]
tests\test_rbac.py::test_require_min_role_higher_role PASSED             [ 63%]
tests\test_rbac.py::test_require_min_role_lower_role PASSED              [ 63%]
tests\test_rbac.py::test_require_min_role_admin_override PASSED          [ 63%]
tests\test_rbac.py::test_role_hierarchy PASSED                           [ 63%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_role_change_creates_audit_entry PASSED [ 64%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_user_status_change_user_deleted PASSED [ 64%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_user_status_change_user_restored PASSED [ 64%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_user_status_change_rejects_invalid_action PASSED [ 64%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_claim_mismatch_creates_audit_entry PASSED [ 64%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_claim_mismatch_filters_claim_snapshot PASSED [ 64%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_claim_mismatch_handles_none_claim_snapshot PASSED [ 64%]
tests\test_rbac_audit_service.py::TestRBACAuditService::test_log_claim_mismatch_handles_empty_claim_snapshot PASSED [ 64%]
tests\test_rbac_imports.py::test_rbac_imports_success PASSED             [ 64%]
tests\test_rbac_imports.py::test_rbac_imports_match_auth_module PASSED   [ 64%]
tests\test_s3_storage_service.py::TestS3StorageServiceInitialization::test_initialization_with_valid_credentials SKIPPED [ 64%]
tests\test_s3_storage_service.py::TestS3StorageServiceInitialization::test_initialization_fails_without_credentials SKIPPED [ 64%]
tests\test_s3_storage_service.py::TestS3StorageServiceInitialization::test_initialization_fails_with_partial_credentials SKIPPED [ 64%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileKey::test_generate_file_key_creates_unique_hash SKIPPED [ 64%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileKey::test_generate_file_key_is_unique SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_save_file_uploads_successfully SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_save_file_includes_metadata SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_save_file_handles_client_error SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_path_returns_presigned_url SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_path_raises_error_for_missing_file SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_delete_file_removes_from_storage SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_delete_file_returns_false_for_missing_file SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_file_exists_returns_true_for_existing_file SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_file_exists_returns_false_for_missing_file SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_size_returns_content_length SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_size_raises_error_for_missing_file SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServicePresignedURLs::test_get_presigned_url_generates_valid_url SKIPPED [ 65%]
tests\test_s3_storage_service.py::TestS3StorageServicePresignedURLs::test_get_presigned_url_default_expiration SKIPPED [ 66%]
tests\test_s3_storage_service.py::TestS3StorageServiceContentTypes::test_guess_content_type_pdf SKIPPED [ 66%]
tests\test_s3_storage_service.py::TestS3StorageServiceContentTypes::test_guess_content_type_mp4 SKIPPED [ 66%]
tests\test_s3_storage_service.py::TestS3StorageServiceContentTypes::test_guess_content_type_unknown SKIPPED [ 66%]
tests\test_sage_integration.py::test_sage_rest_api_client_can_be_imported SKIPPED [ 66%]
tests\test_sage_integration.py::test_real_sage_client_class_exists SKIPPED [ 66%]
tests\test_sage_integration.py::test_sage_oauth_url_uses_real_credentials SKIPPED [ 66%]
tests\test_sage_integration.py::test_sage_client_has_real_configuration SKIPPED [ 66%]
tests\test_sage_integration.py::test_token_exchange_structure_matches_sage_api SKIPPED [ 66%]
tests\test_sage_integration.py::test_get_connections_returns_real_business_structure SKIPPED [ 66%]
tests\test_sage_integration.py::test_balance_sheet_import_uses_real_sage_api_format SKIPPED [ 66%]
tests\test_sage_integration.py::test_sage_rest_api_error_handling SKIPPED [ 66%]
tests\test_sage_integration.py::test_full_sage_oauth_flow_with_real_api SKIPPED [ 66%]
tests\test_security_utils.py::TestAuthError::test_auth_error_default_message PASSED [ 66%]
tests\test_security_utils.py::TestAuthError::test_auth_error_custom_message PASSED [ 67%]
tests\test_security_utils.py::TestVerifyWebhookSignature::test_verify_webhook_signature_valid PASSED [ 67%]
tests\test_security_utils.py::TestVerifyWebhookSignature::test_verify_webhook_signature_invalid PASSED [ 67%]
tests\test_security_utils.py::TestVerifyWebhookSignature::test_verify_webhook_signature_missing_secret PASSED [ 67%]
tests\test_security_utils.py::TestVerifyWebhookSignature::test_verify_webhook_signature_missing_signature PASSED [ 67%]
tests\test_security_utils.py::TestDecodeClerkJWT::test_decode_clerk_jwt_valid_token PASSED [ 67%]
tests\test_security_utils.py::TestDecodeClerkJWT::test_decode_clerk_jwt_invalid_token PASSED [ 67%]
tests\test_security_utils.py::TestDecodeClerkJWT::test_decode_clerk_jwt_wrong_secret PASSED [ 67%]
tests\test_security_utils.py::TestDecodeClerkJWT::test_decode_clerk_jwt_missing_secret_key PASSED [ 67%]
tests\test_security_utils.py::TestDecodeClerkJWT::test_decode_clerk_jwt_expired_token PASSED [ 67%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_factory_returns_local_storage_by_default PASSED [ 67%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_factory_returns_s3_storage_when_enabled SKIPPED [ 67%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_factory_returns_singleton PASSED [ 67%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_local_storage_implements_protocol PASSED [ 68%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_s3_storage_implements_protocol SKIPPED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_returns_professional_tier_when_set_in_metadata PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_returns_premium_tier_when_set_in_metadata PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_returns_enterprise_tier_when_set_in_metadata PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_defaults_to_starter_when_metadata_missing PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_defaults_to_starter_when_metadata_is_none PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_defaults_to_starter_when_tier_value_invalid PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_raises_clerk_api_error_when_org_not_found PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_raises_clerk_api_error_when_network_fails PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_caches_tier_data_for_performance PASSED [ 68%]
tests\test_subscription.py::TestGetOrganizationTier::test_cache_respects_ttl PASSED [ 68%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_starter_tier_exists PASSED [ 68%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_professional_tier_exists PASSED [ 69%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_premium_tier_exists PASSED [ 69%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_enterprise_tier_exists PASSED [ 69%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_tier_comparison PASSED [ 69%]
tests\test_subscription.py::TestClerkAPIError::test_clerk_api_error_message PASSED [ 69%]
tests\test_subscription.py::TestClerkAPIError::test_clerk_api_error_with_original_exception PASSED [ 69%]
tests\test_subscription_core.py::TestSubscriptionTierComparison::test_tier_less_than_comparison PASSED [ 69%]
tests\test_subscription_core.py::TestSubscriptionTierComparison::test_tier_not_less_than_same PASSED [ 69%]
tests\test_subscription_core.py::TestSubscriptionTierComparison::test_tier_not_less_than_higher PASSED [ 69%]
tests\test_subscription_core.py::TestSubscriptionTierComparison::test_tier_less_than_non_tier_returns_not_implemented PASSED [ 69%]
tests\test_subscription_core.py::TestGetOrganizationTier::test_get_organization_tier_with_valid_metadata PASSED [ 69%]
tests\test_subscription_core.py::TestGetOrganizationTier::test_get_organization_tier_defaults_to_starter_when_missing PASSED [ 69%]
tests\test_subscription_core.py::TestGetOrganizationTier::test_get_organization_tier_defaults_to_starter_when_invalid PASSED [ 69%]
tests\test_subscription_core.py::TestGetOrganizationTier::test_get_organization_tier_uses_cache PASSED [ 69%]
tests\test_subscription_core.py::TestGetOrganizationTier::test_get_organization_tier_refreshes_expired_cache PASSED [ 70%]
tests\test_subscription_core.py::TestGetOrganizationTier::test_get_organization_tier_raises_clerk_api_error_on_failure PASSED [ 70%]
tests\test_subscription_core.py::TestClearTierCache::test_clear_tier_cache_specific_org PASSED [ 70%]
tests\test_subscription_core.py::TestClearTierCache::test_clear_tier_cache_all PASSED [ 70%]
tests\test_subscription_core.py::TestClearTierCache::test_clear_tier_cache_nonexistent_org PASSED [ 70%]
tests\test_subscription_core.py::TestClerkAPIError::test_clerk_api_error_can_be_raised PASSED [ 70%]
tests\test_subscription_error_paths.py::test_create_checkout_session_value_error PASSED [ 70%]
tests\test_subscription_error_paths.py::test_create_checkout_session_general_exception PASSED [ 70%]
tests\test_subscription_error_paths.py::test_get_my_subscription_not_found PASSED [ 70%]
tests\test_subscription_error_paths.py::test_billing_dashboard_no_subscription PASSED [ 70%]
tests\test_subscription_error_paths.py::test_billing_dashboard_with_subscription PASSED [ 70%]
tests\test_subscription_error_paths.py::test_billing_dashboard_zero_counts PASSED [ 70%]
tests\test_subscription_error_paths.py::test_change_tier_value_error PASSED [ 70%]
tests\test_subscription_error_paths.py::test_change_tier_general_exception PASSED [ 71%]
tests\test_subscription_error_paths.py::test_cancel_subscription_value_error PASSED [ 71%]
tests\test_subscription_error_paths.py::test_cancel_subscription_general_exception PASSED [ 71%]
tests\test_subscription_error_paths.py::test_get_all_tiers_success PASSED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_missing_secret PASSED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_invalid_payload SKIPPED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_invalid_signature SKIPPED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_successful_events SKIPPED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_handler_exception_caught SKIPPED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[checkout.session.completed-handle_checkout_completed] PASSED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[invoice.paid-handle_invoice_paid] PASSED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[customer.subscription.updated-handle_subscription_updated] PASSED [ 71%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[customer.subscription.deleted-handle_subscription_deleted] PASSED [ 71%]
tests\test_subscription_model.py::test_create_subscription PASSED        [ 71%]
tests\test_subscription_model.py::test_subscription_defaults PASSED      [ 72%]
tests\test_subscription_model.py::test_subscription_tier_enum_values PASSED [ 72%]
tests\test_subscription_model.py::test_subscription_status_transitions PASSED [ 72%]
tests\test_subscription_model.py::test_subscription_cancellation_scheduling PASSED [ 72%]
tests\test_subscription_model.py::test_subscription_trial_period PASSED  [ 72%]
tests\test_subscription_model.py::test_subscription_unique_per_organization PASSED [ 72%]
tests\test_subscription_model.py::test_subscription_relationship_to_organization PASSED [ 72%]
tests\test_subscription_model.py::test_create_invoice PASSED             [ 72%]
tests\test_subscription_model.py::test_invoice_statuses PASSED           [ 72%]
tests\test_subscription_model.py::test_invoice_relationship_to_subscription PASSED [ 72%]
tests\test_subscription_model.py::test_invoice_pdf_url_storage PASSED    [ 72%]
tests\test_subscription_model.py::test_subscription_cascade_delete_invoices PASSED [ 72%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_invalid_tier PASSED [ 72%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_missing_organization PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_none_db PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_annual_billing PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_reuses_existing_customer_id PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_custom_urls PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_none_db PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_no_subscription PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_no_stripe_subscription_id PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_invalid_tier PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_without_proration PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_prorates_by_default PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_none_db PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_no_subscription PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_no_stripe_subscription_id PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_immediately PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_at_period_end PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_db PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_active_subscription PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_customer_id PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_session_success PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_handle_checkout_completed_with_no_existing_subscription PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_handle_invoice_paid_with_no_subscription PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_handle_subscription_updated_with_no_subscription PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_handle_subscription_deleted_with_no_subscription PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_get_organization_subscription_returns_none_for_nonexistent_org PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_tier_config_has_all_required_tiers PASSED [ 74%]
tests\test_subscription_service_edge_cases.py::test_tier_config_all_tiers_have_required_keys PASSED [ 74%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_returns_when_log_missing PASSED [ 75%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_marks_failed_when_rule_missing PASSED [ 75%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_marks_failed_when_template_missing PASSED [ 75%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_success_flow PASSED [ 75%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_logs_exception_and_reraises PASSED [ 75%]
tests\test_task_crud.py::test_create_task_returns_201 PASSED             [ 75%]
tests\test_task_crud.py::test_list_tasks_scopes_to_deal PASSED           [ 75%]
tests\test_task_crud.py::test_update_task_allows_status_and_due_date_change PASSED [ 75%]
tests\test_task_crud.py::test_delete_task_returns_204 PASSED             [ 75%]
tests\test_task_crud.py::test_starter_tier_cannot_create_tasks PASSED    [ 75%]
tests\test_task_crud.py::test_cannot_access_tasks_from_other_org PASSED  [ 75%]
tests\test_tasks_api_complete.py::TestTaskTemplatesAPI::test_create_task_template PASSED [ 75%]
tests\test_tasks_api_complete.py::TestTaskTemplatesAPI::test_list_task_templates PASSED [ 75%]
tests\test_tasks_api_complete.py::TestTaskTemplatesAPI::test_create_template_requires_growth_role PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAutomationRulesAPI::test_create_automation_rule PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAutomationRulesAPI::test_create_automation_rule_template_not_found PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAutomationRulesAPI::test_list_automation_rules PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAutomationRulesAPI::test_run_automation_rule PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAutomationRulesAPI::test_run_automation_rule_not_found PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAutomationRulesAPI::test_run_automation_rule_eager_execution PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAutomationLogsAPI::test_list_automation_logs PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAPIErrorPaths::test_update_task_not_found PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAPIErrorPaths::test_update_task_wrong_deal PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAPIErrorPaths::test_delete_task_not_found PASSED [ 76%]
tests\test_tasks_api_complete.py::TestTaskAPIErrorPaths::test_delete_task_wrong_deal PASSED [ 76%]
tests\test_thumbnail_service.py::TestThumbnailServiceInitialization::test_service_initializes_with_default_settings PASSED [ 76%]
tests\test_thumbnail_service.py::TestThumbnailServiceInitialization::test_service_initializes_with_custom_settings PASSED [ 76%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_from_video_success PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_at_custom_timestamp PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_raises_error_for_missing_file PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_handles_ffmpeg_failure PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_handles_ffmpeg_not_found PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceImageProcessing::test_resize_and_compress_thumbnail PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceImageProcessing::test_resize_maintains_aspect_ratio PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceImageProcessing::test_compress_with_custom_quality PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceStorageIntegration::test_save_thumbnail_to_storage PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceStorageIntegration::test_save_thumbnail_generates_unique_key PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceStorageIntegration::test_save_thumbnail_handles_storage_error PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceEndToEnd::test_generate_thumbnail_complete_workflow PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceEndToEnd::test_generate_thumbnail_with_custom_size PASSED [ 77%]
tests\test_thumbnail_service.py::TestThumbnailServiceEndToEnd::test_generate_thumbnail_cleans_up_temp_files PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_email_from_email_addresses PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_email_from_email_field PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_email_returns_none_when_missing PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_email_handles_empty_email_addresses PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_profile_image PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_profile_image_returns_none_when_missing PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_role_from_public_metadata PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_role_from_unsafe_metadata PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_role_returns_none_when_missing PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_role_returns_none_for_invalid_role PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_organization_id_from_root PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_organization_id_from_unsafe_metadata PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceHelpers::test_extract_organization_id_returns_none_when_missing PASSED [ 78%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_create_user_from_clerk_creates_new_user PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_create_user_from_clerk_updates_existing_user PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_create_user_from_clerk_raises_error_when_id_missing PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_update_user_from_clerk_updates_all_fields PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_update_user_from_clerk_raises_error_when_user_not_found PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_delete_user_sets_is_active_false PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_delete_user_handles_nonexistent_user PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_get_user_by_clerk_id_returns_user PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_get_user_by_clerk_id_returns_none_when_not_found PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_get_user_by_email_returns_user PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_get_user_by_email_returns_none_when_not_found PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_update_last_login_updates_timestamp PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_update_last_login_uses_current_time_when_none_provided PASSED [ 79%]
tests\test_user_service_helpers.py::TestUserServiceCRUD::test_update_last_login_returns_none_when_user_not_found PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_growth_user_can_create_valuation PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_solo_user_gets_forbidden PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_get_valuation_returns_data PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_update_valuation PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_delete_valuation PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_cannot_access_other_org_valuation PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_add_comparable_via_api PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_add_precedent_via_api PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_create_scenario_via_api PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_creates_log PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_returns_log_id_and_persists_entry PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_allows_scenario_id PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_forbidden_for_solo PASSED [ 80%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_rejects_foreign_scenario PASSED [ 81%]
tests\test_valuation_api.py::TestValuationApi::test_list_exports_returns_recent_logs PASSED [ 81%]
tests\test_valuation_api.py::TestValuationApi::test_get_export_status_reflects_updates PASSED [ 81%]
tests\test_valuation_api.py::TestValuationApi::test_run_monte_carlo_simulation PASSED [ 81%]
tests\test_valuation_api.py::TestValuationApi::test_run_monte_carlo_validation PASSED [ 81%]
tests\test_valuation_api.py::TestValuationApi::test_get_scenario_summary_via_api PASSED [ 81%]
tests\test_valuation_api.py::TestValuationApi::test_get_scenario_summary_forbidden_for_solo_tier PASSED [ 81%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_list_valuations_deal_not_found PASSED [ 81%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_list_valuations_deal_from_other_org PASSED [ 81%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_get_valuation_not_found PASSED [ 81%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_get_valuation_deal_mismatch PASSED [ 81%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_update_valuation_not_found PASSED [ 81%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_delete_valuation_not_found PASSED [ 81%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_add_comparable_valuation_not_found PASSED [ 82%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_list_exports_valuation_not_found PASSED [ 82%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_get_export_status_not_found PASSED [ 82%]
tests\test_valuation_api_errors.py::TestValuationAPIErrorPaths::test_monte_carlo_invalid_parameters PASSED [ 82%]
tests\test_valuation_api_errors.py::TestValuationAPISummaryEndpoints::test_get_comparable_summary PASSED [ 82%]
tests\test_valuation_api_errors.py::TestValuationAPISummaryEndpoints::test_get_transaction_summary PASSED [ 82%]
tests\test_valuation_api_errors.py::TestValuationAPISummaryEndpoints::test_get_valuation_summary PASSED [ 82%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_create_valuation_creates_record PASSED [ 82%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_create_valuation_requires_growth_tier PASSED [ 82%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_update_valuation_modifies_record PASSED [ 82%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_delete_valuation_returns_204 PASSED [ 82%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_add_comparable_company PASSED [ 82%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_add_precedent_transaction PASSED [ 82%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_create_scenario_requires_growth_tier PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationAccessControl::test_cannot_access_other_org_deal PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_create_valuation_calculates_metrics PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_update_valuation_recalculates PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_add_comparable_records PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_add_precedent_records PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_create_scenario_persists PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_generate_export_log_entry PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_delete_valuation_cascades PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_calculate_comparable_multiples PASSED [ 83%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_calculate_precedent_multiples PASSED [ 83%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_pdf_with_reportlab PASSED [ 83%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_pdf_with_weasyprint FAILED [ 83%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_excel_creates_file FAILED [ 83%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_pdf_raises_error_when_valuation_not_found PASSED [ 84%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_pdf_raises_error_when_no_pdf_libraries PASSED [ 84%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_excel_raises_error_when_pandas_not_available PASSED [ 84%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_updates_export_log FAILED [ 84%]
tests\test_valuation_export_service.py::TestValuationExportService::test_process_export_task_raises_error_when_log_not_found PASSED [ 84%]
tests\test_valuation_export_service.py::TestValuationExportService::test_process_export_task_handles_errors PASSED [ 84%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_includes_valuation_data FAILED [ 84%]
tests\test_valuation_service.py::TestDiscountedCashFlowCalculations::test_calculate_present_value_of_cash_flows PASSED [ 84%]
tests\test_valuation_service.py::TestTerminalValue::test_gordon_growth_terminal_value PASSED [ 84%]
tests\test_valuation_service.py::TestSensitivityMatrix::test_generate_sensitivity_matrix_dimensions_and_monotonicity PASSED [ 84%]
tests\test_valuation_service.py::TestExitMultipleTerminalValue::test_calculate_terminal_value_exit_multiple PASSED [ 84%]
tests\test_valuation_service.py::TestFullDCFValuation::test_complete_dcf_enterprise_value PASSED [ 84%]
tests\test_valuation_service.py::TestFullDCFValuation::test_dcf_with_zero_cash_flows PASSED [ 84%]
tests\test_valuation_service.py::TestFullDCFValuation::test_dcf_with_negative_cash_flows PASSED [ 85%]
tests\test_valuation_service.py::TestEdgeCasesAndValidation::test_discount_rate_must_be_positive PASSED [ 85%]
tests\test_valuation_service.py::TestEdgeCasesAndValidation::test_discount_rate_must_exceed_growth_rate PASSED [ 85%]
tests\test_valuation_service.py::TestEdgeCasesAndValidation::test_equal_discount_and_growth_rates_invalid PASSED [ 85%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_comparable_analysis_excludes_outliers_and_weighs_results PASSED [ 85%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_precedent_analysis_flags_stale_transactions PASSED [ 85%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_generate_tornado_chart_orders_by_impact PASSED [ 85%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_run_monte_carlo_simulation_returns_deterministic_summary PASSED [ 85%]
tests\test_valuation_service.py::TestScenarioAnalytics::test_calculate_scenario_summary_returns_expected_stats PASSED [ 85%]
tests\test_valuation_service.py::TestScenarioAnalytics::test_generate_tornado_chart_orders_by_impact PASSED [ 85%]
tests\test_valuation_service.py::TestScenarioAnalytics::test_run_monte_carlo_simulation_returns_deterministic_summary PASSED [ 85%]
tests\test_valuation_service.py::TestExportLogging::test_log_export_creates_audit_record PASSED [ 85%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_calculate_enterprise_value_exit_multiple_path PASSED [ 85%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_calculate_enterprise_value_exit_multiple_requires_multiple PASSED [ 85%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_update_valuation_recalculates_metrics PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_delete_valuation_removes_related_records PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_calculate_precedent_multiples_handles_no_records PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_list_helpers_return_entries PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_trigger_export_task_returns_payload PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_persists_document_reference PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_rejects_foreign_document PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_accepts_valid_scenario PASSED [ 86%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_rejects_scenario_from_other_valuation PASSED [ 86%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_calculate_go_to_market_kpis_matches_reference_spreadsheet PASSED [ 86%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_calculate_go_to_market_kpis_handles_zero_inputs PASSED [ 86%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_ensure_test_reference_entities_noop_when_not_test PASSED [ 86%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_ensure_test_reference_entities_creates_placeholders PASSED [ 86%]
tests\test_xero_integration.py::test_xero_python_sdk_can_be_imported SKIPPED [ 87%]
tests\test_xero_integration.py::test_real_xero_client_class_exists SKIPPED [ 87%]
tests\test_xero_integration.py::test_xero_oauth_url_uses_real_credentials SKIPPED [ 87%]
tests\test_xero_integration.py::test_full_xero_oauth_flow_with_real_api SKIPPED [ 87%]
tests\test_xero_integration.py::test_xero_client_has_real_configuration SKIPPED [ 87%]
tests\test_xero_integration.py::test_token_exchange_structure_matches_xero_api SKIPPED [ 87%]
tests\test_xero_integration.py::test_get_connections_returns_real_tenant_structure SKIPPED [ 87%]
tests\test_xero_integration.py::test_balance_sheet_import_uses_real_xero_api_format SKIPPED [ 87%]
tests\test_xero_integration.py::test_xero_sdk_error_handling SKIPPED     [ 87%]
tests\test_xero_oauth_service.py::test_initiate_xero_oauth_generates_authorization_url PASSED [ 87%]
tests\test_xero_oauth_service.py::test_initiate_xero_oauth_with_invalid_deal PASSED [ 87%]
tests\test_xero_oauth_service.py::test_handle_xero_callback_success PASSED [ 87%]
tests\test_xero_oauth_service.py::test_handle_xero_callback_token_exchange_failure PASSED [ 87%]
tests\test_xero_oauth_service.py::test_refresh_xero_token_success PASSED [ 88%]
tests\test_xero_oauth_service.py::test_refresh_xero_token_when_refresh_fails PASSED [ 88%]
tests\test_xero_oauth_service.py::test_fetch_xero_statements_imports_balance_sheet PASSED [ 88%]
tests\test_xero_oauth_service.py::test_fetch_xero_statements_with_expired_token PASSED [ 88%]
tests\test_xero_oauth_service.py::test_disconnect_xero_removes_connection PASSED [ 88%]
tests\test_xero_oauth_service.py::test_get_xero_connection_status_active PASSED [ 88%]
tests\test_xero_oauth_service.py::test_get_xero_connection_status_not_connected PASSED [ 88%]
tests\test_youtube_service.py::test_upload_video_allowed_for_premium PASSED [ 88%]
tests\test_youtube_service.py::test_upload_video_rejected_for_professional PASSED [ 88%]
tests\test_youtube_service.py::test_upload_video_requires_file_path PASSED [ 88%]
tests\api\test_blog.py::test_list_blog_posts_default PASSED              [ 88%]
tests\api\test_blog.py::test_list_blog_posts_with_category_filter PASSED [ 88%]
tests\api\test_blog.py::test_list_blog_posts_with_search PASSED          [ 88%]
tests\api\test_blog.py::test_list_blog_posts_include_unpublished PASSED  [ 88%]
tests\api\test_blog.py::test_list_blog_posts_with_pagination PASSED      [ 89%]
tests\api\test_blog.py::test_list_blog_posts_empty_result PASSED         [ 89%]
tests\api\test_blog.py::test_get_blog_post_by_slug_success PASSED        [ 89%]
tests\api\test_blog.py::test_get_blog_post_by_slug_not_found PASSED      [ 89%]
tests\api\test_blog.py::test_get_unpublished_post_by_slug PASSED         [ 89%]
tests\api\test_blog.py::test_list_blog_categories PASSED                 [ 89%]
tests\api\test_blog.py::test_list_blog_categories_empty_database PASSED  [ 89%]
tests\api\test_blog.py::test_list_blog_posts_with_invalid_limit PASSED   [ 89%]
tests\api\test_blog.py::test_list_blog_posts_with_invalid_offset PASSED  [ 89%]
tests\api\test_blog.py::test_blog_post_response_schema PASSED            [ 89%]
tests\api\test_blog.py::test_blog_search_case_insensitive PASSED         [ 89%]
tests\api\test_blog.py::test_blog_list_ordering PASSED                   [ 89%]
tests\api\test_blog_api.py::test_list_blog_posts_returns_200 PASSED      [ 89%]
tests\api\test_blog_api.py::test_list_blog_posts_with_data PASSED        [ 90%]
tests\api\test_blog_api.py::test_list_blog_posts_category_filter PASSED  [ 90%]
tests\api\test_blog_api.py::test_list_blog_posts_search PASSED           [ 90%]
tests\api\test_blog_api.py::test_list_blog_posts_pagination PASSED       [ 90%]
tests\api\test_blog_api.py::test_list_blog_posts_published_only PASSED   [ 90%]
tests\api\test_document_sharing.py::test_create_share_link_for_document PASSED [ 90%]
tests\api\test_document_sharing.py::test_create_share_link_with_password PASSED [ 90%]
tests\api\test_document_sharing.py::test_access_shared_document_valid_link PASSED [ 90%]
tests\api\test_document_sharing.py::test_access_shared_document_expired_link PASSED [ 90%]
tests\api\test_document_sharing.py::test_access_shared_document_with_password PASSED [ 90%]
tests\api\test_document_sharing.py::test_list_active_share_links_for_document PASSED [ 90%]
tests\api\test_document_sharing.py::test_revoke_share_link PASSED        [ 90%]
tests\api\test_document_sharing.py::test_track_share_link_access_count PASSED [ 90%]
tests\api\test_event_api.py::test_create_event_returns_201 PASSED        [ 90%]
tests\api\test_event_api.py::test_create_event_wrong_organization_returns_403 PASSED [ 91%]
tests\api\test_event_api.py::test_list_events_returns_200 PASSED         [ 91%]
tests\api\test_event_api.py::test_list_events_with_status_filter PASSED  [ 91%]
tests\api\test_event_api.py::test_get_event_returns_200 PASSED           [ 91%]
tests\api\test_event_api.py::test_get_event_not_found_returns_404 PASSED [ 91%]
tests\api\test_event_api.py::test_update_event_returns_200 PASSED        [ 91%]
tests\api\test_event_api.py::test_delete_event_returns_204 PASSED        [ 91%]
tests\api\test_event_api.py::test_create_event_session_returns_201 PASSED [ 91%]
tests\api\test_event_api.py::test_list_event_sessions_returns_200 PASSED [ 91%]
tests\api\test_event_api.py::test_update_event_session_returns_200 PASSED [ 91%]
tests\api\test_event_api.py::test_delete_event_session_returns_204 PASSED [ 91%]
tests\api\test_event_api.py::test_create_event_ticket_returns_201 PASSED [ 91%]
tests\api\test_event_api.py::test_list_event_tickets_returns_200 PASSED  [ 91%]
tests\api\test_event_api.py::test_update_event_ticket_returns_200 PASSED [ 92%]
tests\api\test_event_api.py::test_delete_event_ticket_returns_204 PASSED [ 92%]
tests\api\test_event_api.py::test_create_event_registration_returns_201 PASSED [ 92%]
tests\api\test_event_api.py::test_list_event_registrations_returns_200 PASSED [ 92%]
tests\api\test_event_api.py::test_update_event_registration_returns_200 PASSED [ 92%]
tests\api\test_event_api.py::test_delete_event_registration_returns_204 PASSED [ 92%]
tests\api\test_event_api.py::test_get_event_analytics_returns_200 PASSED [ 92%]
tests\api\test_event_api.py::test_export_registrations_csv_returns_200 PASSED [ 92%]
tests\api\test_event_api.py::test_export_registrations_empty_event_returns_200 PASSED [ 92%]
tests\api\test_event_api.py::test_create_registration_sends_confirmation_email PASSED [ 92%]
tests\api\test_event_api.py::test_list_events_requires_authentication PASSED [ 92%]
tests\api\test_event_api.py::test_create_event_requires_authentication PASSED [ 92%]
tests\api\test_marketing.py::test_submit_contact_form_success PASSED     [ 92%]
tests\api\test_marketing.py::test_submit_contact_form_validation_error PASSED [ 92%]
tests\api\test_marketing.py::test_subscribe_newsletter_success PASSED    [ 93%]
tests\api\test_marketing.py::test_subscribe_newsletter_is_idempotent PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminGoal::test_create_admin_goal PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_unique_constraint PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_repr PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_default_targets PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminActivity::test_create_admin_activity PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_types PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_statuses PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_default_amount PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_repr PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminScore::test_create_admin_score PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_unique_constraint PASSED [ 93%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_valid_range PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_default_values PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_repr PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_create_focus_session PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_complete_focus_session PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_focus_session_default_duration PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_focus_session_repr PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminNudge::test_create_nudge PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_types PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_priorities PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_default_priority PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_read_status PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_repr PASSED [ 94%]
tests\master_admin\test_models.py::TestAdminMeeting::test_create_meeting PASSED [ 95%]
tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_types PASSED [ 95%]
tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_default_duration PASSED [ 95%]
tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_repr PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_create_valid PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_create_defaults PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_create_negative_targets PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_update_partial PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_response_from_dict PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_valid PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_type_alias PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_default_amount PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_invalid_amount PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_update_partial PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_response_serialization PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_create_valid PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_create_boundaries PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_create_defaults PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_update_partial PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_create_valid PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_create_default_duration PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_create_invalid_duration PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_update_completion PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_response PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_valid PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_type_alias PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_default_priority PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_empty_message PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_update_read_status PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_response_expiration PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_valid PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_type_alias PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_default_duration PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_invalid_title PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_long_title PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_update_partial PASSED [ 97%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_response PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_date_field_validation PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_datetime_field_validation PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_enum_validation PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_optional_fields_as_none PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_model_config_from_attributes PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_role_change_creates_audit_entry PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_role_change_captures_before_after_values PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_user_deleted PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_user_restored PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_rejects_invalid_action PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_claim_mismatch_sanitizes_claims PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_claim_mismatch_logs_org_and_user_ids PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_require_min_role_admin_always_passes PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_require_min_role_hierarchy_validation PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_enforce_claim_integrity_creates_missing_org SKIPPED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_enforce_claim_integrity_logs_mismatch SKIPPED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_get_current_user_rejects_missing_clerk_id SKIPPED [ 98%]
tests\services\test_rbac_permissions.py::TestPermissionHierarchy::test_role_level_function_returns_correct_values PASSED [ 99%]
tests\services\test_rbac_permissions.py::TestPermissionHierarchy::test_admin_override_bypasses_exact_role_requirement PASSED [ 99%]
tests\services\test_rbac_permissions.py::TestPermissionHierarchy::test_feature_access_respects_subscription_tier SKIPPED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestUserForeignKeyTypes::test_users_id_column_is_string_type PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestUserForeignKeyTypes::test_all_user_foreign_key_columns_match_users_id_type PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestUserForeignKeyTypes::test_foreign_key_constraints_exist PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_folder_rejects_invalid_created_by SKIPPED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_document_rejects_invalid_uploaded_by SKIPPED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_document_permission_rejects_invalid_user_id SKIPPED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_valid_user_references_succeed PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestModelSchemAlignment::test_folder_model_matches_database_schema PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestModelSchemAlignment::test_document_model_matches_database_schema PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestModelSchemAlignment::test_all_user_fk_columns_are_nullable_correct PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestMigrationRollback::test_downgrade_path_exists PASSED [100%]

================================== FAILURES ===================================
_______________________ test_scores_and_dashboard_stats _______________________
tests\test_master_admin_api.py:192: in test_scores_and_dashboard_stats
    assert dashboard["weekly_activities"] >= 2
E   assert 1 >= 2
________ TestValuationExportService.test_export_to_pdf_with_weasyprint ________
tests\test_valuation_export_service.py:173: in test_export_to_pdf_with_weasyprint
    result = await ValuationExportService.export_to_pdf(
app\services\valuation_export_service.py:111: in export_to_pdf
    pdf_bytes = ValuationExportService._html_to_pdf_weasyprint(html_content)
app\services\valuation_export_service.py:401: in _html_to_pdf_weasyprint
    html = HTML(string=html_content)
E   NameError: name 'HTML' is not defined
________ TestValuationExportService.test_export_to_excel_creates_file _________
tests\test_valuation_export_service.py:227: in test_export_to_excel_creates_file
    with patch.dict('sys.modules', {'pandas': mock_pandas}), \
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.services.valuation_export_service' from 'C:\\Projects\\ma-saas-platform\\M-S-SaaS-apex-deliver\\backend\\app\\services\\valuation_export_service.py'> does not have the attribute 'pd'
__________ TestValuationExportService.test_export_updates_export_log __________
tests\test_valuation_export_service.py:359: in test_export_updates_export_log
    result = await ValuationExportService.process_export_task(
app\services\valuation_export_service.py:497: in process_export_task
    result = await ValuationExportService.export_to_pdf(
app\services\valuation_export_service.py:111: in export_to_pdf
    pdf_bytes = ValuationExportService._html_to_pdf_weasyprint(html_content)
app\services\valuation_export_service.py:401: in _html_to_pdf_weasyprint
    html = HTML(string=html_content)
E   NameError: name 'HTML' is not defined
_______ TestValuationExportService.test_export_includes_valuation_data ________
tests\test_valuation_export_service.py:465: in test_export_includes_valuation_data
    result = await ValuationExportService.export_to_pdf(
app\services\valuation_export_service.py:111: in export_to_pdf
    pdf_bytes = ValuationExportService._html_to_pdf_weasyprint(html_content)
app\services\valuation_export_service.py:401: in _html_to_pdf_weasyprint
    html = HTML(string=html_content)
E   NameError: name 'HTML' is not defined
============================== warnings summary ===============================
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
  C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.8/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

tests\test_netsuite_integration.py:30
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:30: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:42
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:42: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:59
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:59: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:97
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:97: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:114
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:114: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:132
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:132: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:153
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:153: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:209
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:209: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:229
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:229: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:249
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:249: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:29
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:29: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:49
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:49: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:66
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:66: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:104
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:104: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:121
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:121: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:143
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:143: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:164
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:164: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:219
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:219: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:238
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:238: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:28
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:28: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:40
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:40: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:57
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:57: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:95
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:95: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:112
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:112: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:130
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:130: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:151
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:151: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:206
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:206: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:226
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:226: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:30
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:30: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:47
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:47: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:63
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:63: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:104
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:104: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:136
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:136: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:153
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:153: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:175
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:175: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:196
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:196: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:284
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:284: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

backend/tests/test_billing_endpoints.py: 16 warnings
backend/tests/test_billing_simple.py: 3 warnings
backend/tests/test_blog_api_errors.py: 7 warnings
backend/tests/test_clerk_auth_complete.py: 26 warnings
backend/tests/test_community_api.py: 22 warnings
backend/tests/test_dashboard_api.py: 6 warnings
backend/tests/test_deal_endpoints.py: 25 warnings
backend/tests/test_deal_matching_api.py: 16 warnings
backend/tests/test_document_ai_and_versions.py: 5 warnings
backend/tests/test_document_endpoints.py: 42 warnings
backend/tests/test_document_export_jobs_api.py: 3 warnings
backend/tests/test_document_generation_api.py: 19 warnings
backend/tests/test_document_generation_api_errors.py: 12 warnings
backend/tests/test_event_payment_api.py: 7 warnings
backend/tests/test_events_api_errors.py: 7 warnings
backend/tests/test_financial_api.py: 34 warnings
backend/tests/test_financial_api_errors.py: 8 warnings
backend/tests/test_marketing_api_errors.py: 9 warnings
backend/tests/test_master_admin_api.py: 13 warnings
backend/tests/test_notifications_api.py: 6 warnings
backend/tests/test_pipeline_template_api.py: 3 warnings
backend/tests/test_pipeline_template_api_errors.py: 7 warnings
backend/tests/test_podcast_api.py: 54 warnings
backend/tests/test_subscription_error_paths.py: 16 warnings
backend/tests/test_task_crud.py: 6 warnings
backend/tests/test_tasks_api_complete.py: 14 warnings
backend/tests/test_valuation_api.py: 20 warnings
backend/tests/test_valuation_api_errors.py: 13 warnings
backend/tests/test_valuation_crud.py: 8 warnings
backend/tests/api/test_blog.py: 16 warnings
backend/tests/api/test_blog_api.py: 6 warnings
backend/tests/api/test_document_sharing.py: 8 warnings
backend/tests/api/test_event_api.py: 26 warnings
backend/tests/api/test_marketing.py: 4 warnings
  C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:680: DeprecationWarning: The 'app' shortcut is now deprecated. Use the explicit style 'transport=WSGITransport(app=...)' instead.
    warnings.warn(message, DeprecationWarning)

backend/tests/test_clerk_auth_complete.py: 24 warnings
  C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_content.py:202: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.11.9-final-0 _______________

Name                                          Stmts   Miss  Cover   Missing
---------------------------------------------------------------------------
app\api\document_sharing.py                     121     10    92%   63, 124, 158, 191, 199, 203, 222, 251, 301, 336
app\api\routes\community.py                     123     11    91%   142, 162, 187, 220-222, 240, 264, 284, 321, 346
app\api\routes\deal_matching.py                  77      5    94%   33, 138-139, 150-160
app\api\routes\deals.py                          64     10    84%   113, 131-146, 171, 204
app\api\routes\document_generation.py           255     50    80%   359, 378-401, 407, 433, 447-453, 471-520, 551, 564, 567, 595, 604, 629, 638, 713, 726, 841, 854
app\api\routes\documents.py                     184     45    76%   75-76, 135, 157, 189, 253, 291, 378-406, 422-447, 468, 507, 526-527, 557-576, 591-609, 637, 670-690, 735, 815-826
app\api\routes\event_payments.py                 49      5    90%   50, 56, 83, 120, 162
app\api\routes\events.py                        209     44    79%   68-69, 182, 195-198, 216, 243, 253, 274, 283, 312, 325-328, 346, 373, 383, 404, 413, 443, 483-486, 505, 533, 543, 564, 573, 597, 606, 640, 700-724
app\api\routes\financial.py                     220     30    86%   118, 177, 234, 298, 415, 424, 430, 487, 552, 582, 590, 596, 632, 638, 666, 672, 722, 766, 795, 803, 809, 844, 850, 921, 950, 958, 964, 999, 1005, 1076
app\api\routes\marketing.py                      69     11    84%   52-56, 99, 149-152, 198-201
app\api\routes\master_admin.py                  379     37    90%   145, 187, 282, 304, 329, 437, 624, 644, 711, 732, 818, 838, 858, 882, 885, 893-894, 912, 937, 946, 971, 980, 1040, 1059, 1079, 1139-1145, 1160, 1180, 1267, 1287, 1307, 1392, 1412, 1433
app\api\routes\notifications.py                  61      5    92%   129, 135, 137, 139, 141
app\api\routes\podcasts.py                      306     80    74%   51-135, 178-179, 184-189, 242, 327-329, 377, 449, 468, 509-515, 550, 557, 576, 635-641, 675, 699, 790, 833, 840, 906, 945-951, 1003-1004
app\api\routes\subscriptions.py                 112      8    93%   81-82, 252-255, 270-271
app\api\routes\tasks.py                          69      1    99%   271
app\api\routes\valuation.py                     163     33    80%   59-64, 148-150, 183-185, 218-220, 445-483
app\api\webhooks\clerk.py                        52      4    92%   20, 54-55, 61
app\db\base.py                                   28      3    89%   21, 29, 37
app\db\types.py                                  11      1    91%   22
app\main.py                                      27      3    89%   26, 61, 71
app\models\blog_post.py                          25      1    96%   32
app\models\contact_message.py                    16      1    94%   23
app\models\deal_match.py                         71      5    93%   56, 61, 100, 105, 133
app\models\document.py                          130      6    95%   65, 132, 173, 208, 246, 281
app\models\document_generation.py               111      4    96%   90, 126, 151, 181
app\models\email_queue.py                        25      1    96%   44
app\models\event.py                             137      5    96%   86, 127, 168, 211, 241
app\models\event_payment.py                      44      2    95%   55, 77
app\models\financial_connection.py               27      1    96%   52
app\models\financial_statement.py                80      1    99%   134
app\models\master_admin.py                      272      9    97%   235, 266, 303, 332, 373, 400, 437, 470, 494
app\models\newsletter_subscription.py            12      1    92%   21
app\models\podcast_usage.py                      15      1    93%   36
app\models\user_notification_preferences.py      23      1    96%   46
app\schemas\community.py                        131      1    99%   157
app\schemas\document.py                         222      7    97%   19, 33, 155, 251, 253, 328, 342
app\schemas\document_generation.py              145      1    99%   209
app\schemas\pipeline_template.py                 53      2    96%   34, 40
app\schemas\valuation.py                        258      5    98%   31, 39, 204-206
app\services\audio_chunking_service.py          102     21    79%   130-133, 140-150, 182, 186-188, 268-269, 281-283
app\services\community_service.py               167     12    93%   119, 121, 123, 190, 195, 248, 344, 437, 511-514
app\services\deal_matching_service.py           161     14    91%   106, 116, 139, 141, 162, 178, 210, 266, 269, 276, 283, 288, 294, 309
app\services\deal_service.py                     81     15    81%   99-100, 120-121, 158, 178-186, 203, 228
app\services\document_ai_service.py             135     70    48%   15-17, 36, 42, 46, 50, 55, 104, 128-153, 180, 214, 240-276, 297-307, 339, 383-430
app\services\document_export_service.py         115     88    23%   14-18, 24-26, 63-155, 183-243, 267-308
app\services\document_generation_service.py     129      7    95%   140-142, 204, 259, 261, 336
app\services\document_service.py                599    123    79%   81, 123, 139, 166-174, 194, 213, 243, 248, 258-297, 307, 396, 498, 588, 619, 679-708, 737-738, 800, 804, 809-818, 847, 851, 885, 934-936, 946-981, 990-1002, 1021, 1034-1036, 1071-1081, 1111, 1131, 1183, 1189, 1205-1206, 1261-1281, 1308, 1326, 1424, 1486, 1495, 1611, 1623-1625, 1630-1632, 1645-1649, 1660-1662, 1731-1733, 1752, 1788, 1836
app\services\email_service.py                    72      4    94%   100, 136, 154, 174
app\services\entitlement_service.py              47      1    98%   202
app\services\event_notification_service.py       51      5    90%   19, 24-25, 40-41
app\services\event_payment_service.py           167     38    77%   76, 94, 119, 164-170, 206, 256-257, 263-264, 267, 286, 393, 396-398, 401, 410-416, 419-424, 443-453
app\services\event_reminder_service.py           60      8    87%   27, 35, 73-75, 79-81
app\services\event_service.py                   247     41    83%   100, 122, 164, 195, 223, 248, 299, 327, 355, 376, 389, 399-407, 435, 467, 475, 496, 503-504, 527, 537-538, 559, 636-693
app\services\financial_narrative_service.py     231     20    91%   40, 53-61, 227-228, 300-313, 328, 342, 352, 372, 381, 385
app\services\financial_ratios.py                240     10    96%   248, 714, 728, 754, 801, 808, 815, 822, 829, 882
app\services\master_admin_service.py            436    201    54%   130-134, 147, 149, 152, 157-161, 183-184, 189, 219, 222-229, 232-236, 249, 251, 257-258, 262-263, 268-279, 282-289, 309, 321-325, 344-347, 375-382, 385, 388, 395, 407-410, 430-434, 454, 470, 474-478, 500-504, 522-525, 538-542, 565-569, 586-593, 621-625, 670-685, 688-692, 705, 710-726, 751-752, 777-784, 787-791, 804, 809-829, 833-834, 894, 916-917, 921, 963-967, 977, 981-993, 998-999, 1003-1011, 1015-1026, 1030-1031, 1062-1063, 1091-1092, 1143, 1148, 1155-1156, 1169-1178, 1199-1200, 1204, 1244-1246, 1256, 1260-1272, 1277-1278, 1282-1290, 1313-1314, 1318, 1360-1364, 1374, 1378-1390, 1395-1396, 1400-1409, 1435-1436, 1440, 1484-1486, 1488-1490, 1500, 1507, 1511-1512, 1516-1524, 1531, 1535-1544, 1567-1568, 1572, 1614-1619, 1634, 1638-1650, 1655-1656, 1660-1668, 1672, 1691-1693
app\services\netsuite_oauth_service.py          138     95    31%   63, 75-85, 97-116, 133-150, 166-182, 206-278, 295, 299, 308, 316, 330-346, 352, 374-389, 415-449, 464-494, 514-547
app\services\notification_service.py             61      8    87%   102, 259-275, 305
app\services\organization_service.py             64      1    98%   35
app\services\podcast_service.py                 115     11    90%   16-18, 118, 131, 133, 135, 181, 197, 232, 312
app\services\quickbooks_oauth_service.py        233    183    21%   24-28, 40-234, 252, 263, 273, 284, 298, 308-314, 320, 338-350, 381-441, 459-487, 504-557, 572-607, 622-686, 730
app\services\quota_service.py                   165     13    92%   115, 128, 141, 168, 171, 176-187, 211, 259
app\services\s3_storage_service.py               95     95     0%   2-323
app\services\sage_oauth_service.py              192    151    21%   42-50, 65-75, 87-100, 120-138, 158-170, 193-249, 267, 278, 287, 298, 311, 321-327, 348-360, 389-449, 467-495, 512-547, 562-597, 608-618, 632-646
app\services\storage_service.py                  65     14    78%   138-142, 164, 186, 203-204, 224-227, 251-252
app\services\subscription_service.py            142     22    85%   307-317, 330-341, 353-364, 376-379
app\services\task_service.py                     35      2    94%   15-16
app\services\task_template_service.py            61      5    92%   101-104, 112
app\services\thumbnail_service.py                93     14    85%   108, 119-120, 147, 158, 174-176, 200, 229-231, 298-299
app\services\valuation_export_service.py        178     66    63%   18, 24-25, 31-36, 180-292, 399, 402-403, 414, 504-524
app\services\valuation_service.py               350     35    90%   192, 215, 373-374, 399, 420, 506, 511, 701, 717, 815, 840, 861, 867, 908, 921, 925, 931, 976-1015, 1037, 1073
app\services\xero_oauth_service.py              206     71    66%   24-28, 42-187, 196, 205, 216, 224, 229-235, 241, 315, 324, 342-351, 395, 440, 470-471, 518-519, 552-554
app\services\youtube_service.py                  57     15    74%   12, 85, 113-114, 121, 131, 146-162
---------------------------------------------------------------------------
TOTAL                                         12068   1930    84%

52 files skipped due to complete coverage.
=========================== short test summary info ===========================
SKIPPED [1] tests\test_financial_xero_integration.py:9: To be implemented in ratio engine phase
SKIPPED [1] tests\test_master_admin_models.py:134: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:148: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:335: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:348: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:405: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_netsuite_integration.py:30: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:42: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:59: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:97: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:114: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:132: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:153: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:209: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:229: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:249: Requires real NetSuite sandbox OAuth flow - manual test
SKIPPED [1] tests\test_quickbooks_integration.py:29: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:49: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:66: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:104: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:121: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:143: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:164: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:219: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:238: Requires real QuickBooks sandbox OAuth flow - manual test
SKIPPED [1] tests\test_s3_storage_service.py:32: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:54: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:68: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:86: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:109: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:136: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:164: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:194: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:219: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:249: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:273: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:304: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:330: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:355: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:381: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:406: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:433: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:465: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:497: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:516: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:535: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_sage_integration.py:28: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:40: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:57: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:95: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:112: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:130: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:151: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:206: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:226: Requires real Sage sandbox OAuth flow - manual test
SKIPPED [1] tests\test_storage_factory.py:48: boto3 not installed - S3 storage optional
SKIPPED [1] tests\test_storage_factory.py:116: boto3 not installed - S3 storage optional
SKIPPED [1] tests\test_subscription_error_paths.py:373: Stripe module imported inside function - mocking complex, error handling already verified in code
SKIPPED [1] tests\test_subscription_error_paths.py:397: Stripe module imported inside function - mocking complex, error handling already verified in code
SKIPPED [1] tests\test_subscription_error_paths.py:425: Stripe module imported inside function - mocking complex, event routing already verified in code
SKIPPED [1] tests\test_subscription_error_paths.py:468: Stripe module imported inside function - mocking complex, exception handling already verified in code
SKIPPED [1] tests\test_xero_integration.py:30: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:47: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:63: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:104: Requires real Xero sandbox OAuth flow - manual test
SKIPPED [1] tests\test_xero_integration.py:136: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:153: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:175: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:196: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:284: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\services\test_rbac_permissions.py:223: Auth dependency integration test - requires auth.py mocking
SKIPPED [1] tests\services\test_rbac_permissions.py:234: Auth dependency integration test - requires auth.py mocking
SKIPPED [1] tests\services\test_rbac_permissions.py:238: Auth dependency integration test - requires FastAPI request context
SKIPPED [1] tests\services\test_rbac_permissions.py:269: Entitlement service test - covered in test_entitlement.py
SKIPPED [1] tests\test_migrations\test_user_foreign_keys.py:150: SQLite doesn't enforce FK constraints by default - test requires PostgreSQL
SKIPPED [1] tests\test_migrations\test_user_foreign_keys.py:167: SQLite doesn't enforce FK constraints by default - test requires PostgreSQL
SKIPPED [1] tests\test_migrations\test_user_foreign_keys.py:189: SQLite doesn't enforce FK constraints by default - test requires PostgreSQL
FAILED tests\test_master_admin_api.py::test_scores_and_dashboard_stats - asse...
FAILED tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_pdf_with_weasyprint
FAILED tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_excel_creates_file
FAILED tests\test_valuation_export_service.py::TestValuationExportService::test_export_updates_export_log
FAILED tests\test_valuation_export_service.py::TestValuationExportService::test_export_includes_valuation_data
==== 5 failed, 1260 passed, 77 skipped, 554 warnings in 377.05s (0:06:17) =====
