from pathlib import Path
path=Path('backend/app/api/routes/blog.py')
text=path.read_text(encoding='utf-8')
if '@router.put("/{slug}"' in text:
    raise SystemExit('update route already present')
insert="\n\n@router.put(\"/{slug}\", response_model=BlogPostResponse)\ndef update_blog_post(\n    slug: str,\n    blog_post: BlogPostUpdate,\n    db: Session = Depends(get_db),\n) -> BlogPostResponse:\n    \"\"\"Update an existing blog post by slug.\"\"\"\n\n    existing_post = db.execute(\n        select(BlogPost).where(BlogPost.slug == slug)\n    ).scalar_one_or_none()\n\n    if not existing_post:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=f\"Blog post with slug '{slug}' not found\",\n        )\n\n    update_data = blog_post.model_dump(exclude_unset=True)\n\n    new_slug = update_data.get(\"slug\")\n    if new_slug and new_slug != existing_post.slug:\n        conflict = db.execute(\n            select(BlogPost).where(BlogPost.slug == new_slug, BlogPost.id != existing_post.id)\n        ).scalar_one_or_none()\n        if conflict:\n            raise HTTPException(\n                status_code=status.HTTP_409_CONFLICT,\n                detail=f\"Blog post with slug '{new_slug}' already exists\",\n            )\n\n    if \"secondary_keywords\" in update_data:\n        keywords = update_data[\"secondary_keywords\"]\n        update_data[\"secondary_keywords\"] = \\\n            \"\\".join(keywords) if keywords else None\n\n    for field, value in update_data.items():\n        setattr(existing_post, field, value)\n\n    db.add(existing_post)\n    db.commit()\n    db.refresh(existing_post)\n\n    return serialize_blog_post(existing_post)\n\n"
text = text + insert
path.write_text(text, encoding='utf-8')
