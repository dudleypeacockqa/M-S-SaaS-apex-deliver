============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-7.4.3, pluggy-1.6.0 -- C:\Users\User\AppData\Local\Programs\Python\Python311\python.exe
cachedir: .pytest_cache
rootdir: C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver
configfile: pytest.ini
plugins: anyio-3.7.1, asyncio-0.21.1, cov-7.0.0
asyncio: mode=Mode.STRICT
collecting ... collected 1027 items

tests\test_additional_ratios.py::test_asset_turnover PASSED              [  0%]
tests\test_additional_ratios.py::test_inventory_turnover PASSED          [  0%]
tests\test_additional_ratios.py::test_receivables_turnover PASSED        [  0%]
tests\test_additional_ratios.py::test_days_sales_outstanding PASSED      [  0%]
tests\test_additional_ratios.py::test_cash_conversion_cycle PASSED       [  0%]
tests\test_additional_ratios.py::test_price_to_earnings PASSED           [  0%]
tests\test_additional_ratios.py::test_ev_to_ebitda PASSED                [  0%]
tests\test_additional_ratios.py::test_dividend_yield PASSED              [  0%]
tests\test_additional_ratios.py::test_revenue_growth_yoy PASSED          [  0%]
tests\test_additional_ratios.py::test_ebitda_growth_yoy PASSED           [  0%]
tests\test_additional_ratios.py::test_cagr PASSED                        [  1%]
tests\test_additional_ratios.py::test_operating_cf_margin PASSED         [  1%]
tests\test_additional_ratios.py::test_free_cash_flow PASSED              [  1%]
tests\test_additional_ratios.py::test_cf_to_debt PASSED                  [  1%]
tests\test_additional_ratios.py::test_cash_conversion_rate PASSED        [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_professional_tier_allowed_podcast_audio_access PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_starter_tier_blocked_from_podcast_audio PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_403_response_includes_upgrade_message PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_403_includes_required_tier_header PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureProfessionalTier::test_403_includes_upgrade_url_header PASSED [  1%]
tests\test_api_middleware.py::TestRequireFeatureVideoAccess::test_premium_tier_allowed_video_access PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureVideoAccess::test_professional_tier_blocked_from_video PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureYouTubeAccess::test_premium_tier_allowed_youtube_access PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureYouTubeAccess::test_professional_tier_blocked_from_youtube PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureLiveStreaming::test_enterprise_tier_allowed_live_streaming PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureLiveStreaming::test_premium_tier_blocked_from_live_streaming PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_middleware_works_with_multiple_features PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_middleware_integrates_with_get_current_user PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_middleware_logs_blocked_requests PASSED [  2%]
tests\test_api_middleware.py::TestRequireFeatureEdgeCases::test_invalid_feature_raises_feature_not_found_error PASSED [  2%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceInitialization::test_service_initializes_with_default_settings PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceInitialization::test_service_initializes_with_custom_settings PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceFileValidation::test_needs_chunking_returns_false_for_small_file PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceFileValidation::test_needs_chunking_returns_true_for_large_file PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceFileValidation::test_needs_chunking_returns_false_at_exact_limit PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_creates_multiple_chunks PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_handles_mp3_format PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_handles_wav_format PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_applies_overlap PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceChunking::test_chunk_audio_file_raises_error_for_missing_file PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_combines_all_transcripts PASSED [  3%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_handles_empty_chunk_list PASSED [  4%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_raises_error_on_api_failure PASSED [  4%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceTranscription::test_transcribe_chunks_supports_custom_language PASSED [  4%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceCleanup::test_cleanup_chunks_deletes_all_files PASSED [  4%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceCleanup::test_cleanup_chunks_handles_missing_files PASSED [  4%]
tests\test_audio_chunking_service.py::TestAudioChunkingServiceCleanup::test_cleanup_chunks_handles_deletion_errors PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_with_single_key PASSED    [  4%]
tests\test_auth_helpers.py::test_extract_claim_with_multiple_keys_returns_first_found PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_returns_none_when_not_found PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_skips_empty_values PASSED [  4%]
tests\test_auth_helpers.py::test_extract_claim_handles_falsy_but_valid_values PASSED [  5%]
tests\test_auth_helpers.py::test_sanitize_claims_filters_allowed_keys PASSED [  5%]
tests\test_auth_helpers.py::test_sanitize_claims_handles_missing_allowed_keys PASSED [  5%]
tests\test_auth_helpers.py::test_sanitize_claims_returns_empty_dict_for_no_allowed_keys PASSED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_validates_org_match FAILED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_org_mismatch FAILED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_missing_org_claim_when_user_has_org FAILED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_creates_missing_org_from_clerk FAILED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_validates_role_match FAILED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_role_mismatch FAILED [  5%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_unknown_role_claim FAILED [  6%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_logs_claim_mismatches FAILED [  6%]
tests\test_auth_helpers.py::test_enforce_claim_integrity_allows_missing_role_claim FAILED [  6%]
tests\test_auth_helpers.py::test_get_current_user_enforces_claim_integrity FAILED [  6%]
tests\test_auth_helpers.py::test_get_current_user_requires_credentials PASSED [  6%]
tests\test_auth_helpers.py::test_require_feature_allows_access_with_sufficient_tier FAILED [  6%]
tests\test_auth_helpers.py::test_require_feature_blocks_access_with_insufficient_tier FAILED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_success FAILED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_invalid_tier ERROR [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_requires_auth PASSED [  6%]
tests\test_billing_endpoints.py::test_create_checkout_session_existing_subscription FAILED [  7%]
tests\test_billing_endpoints.py::test_create_checkout_session_with_trial FAILED [  7%]
tests\test_billing_endpoints.py::test_get_customer_portal_success FAILED [  7%]
tests\test_billing_endpoints.py::test_get_customer_portal_handles_value_errors FAILED [  7%]
tests\test_billing_endpoints.py::test_get_subscription_success FAILED    [  7%]
tests\test_billing_endpoints.py::test_get_subscription_not_found ERROR   [  7%]
tests\test_billing_endpoints.py::test_get_subscription_requires_auth PASSED [  7%]
tests\test_billing_endpoints.py::test_update_subscription_tier_upgrade FAILED [  7%]
tests\test_billing_endpoints.py::test_update_subscription_tier_downgrade FAILED [  7%]
tests\test_billing_endpoints.py::test_cancel_subscription_at_period_end FAILED [  7%]
tests\test_billing_endpoints.py::test_cancel_subscription_immediately FAILED [  7%]
tests\test_billing_endpoints.py::test_cancel_subscription_requires_active_subscription ERROR [  8%]
tests\test_billing_endpoints.py::test_customer_portal_redirect ERROR     [  8%]
tests\test_billing_simple.py::test_create_checkout_session_endpoint_exists PASSED [  8%]
tests\test_billing_simple.py::test_get_subscription_endpoint_exists PASSED [  8%]
tests\test_billing_simple.py::test_cancel_subscription_endpoint_exists PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_creates_user FAILED      [  8%]
tests\test_clerk_auth_complete.py::test_webhook_rejects_invalid_signature PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_rejects_missing_signature PASSED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_updates_existing_user FAILED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_update_creates_if_not_exists FAILED [  8%]
tests\test_clerk_auth_complete.py::test_webhook_soft_deletes_user FAILED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_updates_last_login_on_session_created FAILED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_handles_session_ended FAILED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_handles_missing_email_addresses FAILED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_upserts_organization_metadata FAILED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_creates_organization_when_missing FAILED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_deactivates_organization_on_delete FAILED [  9%]
tests\test_clerk_auth_complete.py::test_webhook_handles_invalid_role_gracefully FAILED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_returns_current_user FAILED [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_requires_token PASSED    [  9%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_invalid_token PASSED [ 10%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_token_for_nonexistent_user FAILED [ 10%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_token_without_sub PASSED [ 10%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_org_claim_mismatch FAILED [ 10%]
tests\test_clerk_auth_complete.py::test_auth_me_rejects_role_claim_mismatch FAILED [ 10%]
tests\test_clerk_auth_complete.py::test_auth_me_populates_missing_org_from_claim FAILED [ 10%]
tests\test_clerk_auth_complete.py::test_webhook_handles_empty_data_gracefully PASSED [ 10%]
tests\test_clerk_auth_complete.py::test_webhook_ignores_unknown_event_types PASSED [ 10%]
tests\test_clerk_auth_complete.py::test_user_creation_with_all_roles FAILED [ 10%]
tests\test_clerk_auth_complete.py::test_webhook_handles_invalid_timestamp_format FAILED [ 10%]
tests\test_clerk_auth_complete.py::test_full_user_lifecycle FAILED       [ 11%]
tests\test_community_models.py::test_create_post FAILED                  [ 11%]
tests\test_community_models.py::test_post_with_tags FAILED               [ 11%]
tests\test_community_models.py::test_post_multi_tenancy FAILED           [ 11%]
tests\test_community_models.py::test_create_comment FAILED               [ 11%]
tests\test_community_models.py::test_nested_comments FAILED              [ 11%]
tests\test_community_models.py::test_post_comment_relationship FAILED    [ 11%]
tests\test_community_models.py::test_create_reaction FAILED              [ 11%]
tests\test_community_models.py::test_reaction_on_comment FAILED          [ 11%]
tests\test_community_models.py::test_unique_reaction_constraint FAILED   [ 11%]
tests\test_community_models.py::test_create_follow FAILED                [ 11%]
tests\test_community_models.py::test_unique_follow_constraint FAILED     [ 12%]
tests\test_community_models.py::test_create_moderation_action FAILED     [ 12%]
tests\test_community_models.py::test_moderation_action_types FAILED      [ 12%]
tests\test_community_service.py::test_create_post ERROR                  [ 12%]
tests\test_community_service.py::test_get_post_by_id ERROR               [ 12%]
tests\test_community_service.py::test_get_post_by_id_wrong_org ERROR     [ 12%]
tests\test_community_service.py::test_update_post ERROR                  [ 12%]
tests\test_community_service.py::test_update_post_unauthorized ERROR     [ 12%]
tests\test_community_service.py::test_delete_post ERROR                  [ 12%]
tests\test_community_service.py::test_delete_post_unauthorized ERROR     [ 12%]
tests\test_community_service.py::test_list_posts ERROR                   [ 13%]
tests\test_community_service.py::test_list_posts_filter_by_category ERROR [ 13%]
tests\test_community_service.py::test_list_posts_search ERROR            [ 13%]
tests\test_community_service.py::test_create_comment ERROR               [ 13%]
tests\test_community_service.py::test_create_comment_on_nonexistent_post ERROR [ 13%]
tests\test_community_service.py::test_create_nested_comment ERROR        [ 13%]
tests\test_community_service.py::test_delete_comment ERROR               [ 13%]
tests\test_community_service.py::test_delete_comment_unauthorized ERROR  [ 13%]
tests\test_community_service.py::test_get_comments_for_post ERROR        [ 13%]
tests\test_community_service.py::test_add_reaction ERROR                 [ 13%]
tests\test_community_service.py::test_add_reaction_duplicate ERROR       [ 14%]
tests\test_community_service.py::test_remove_reaction ERROR              [ 14%]
tests\test_community_service.py::test_get_reactions ERROR                [ 14%]
tests\test_community_service.py::test_follow_user ERROR                  [ 14%]
tests\test_community_service.py::test_follow_user_self ERROR             [ 14%]
tests\test_community_service.py::test_follow_user_duplicate ERROR        [ 14%]
tests\test_community_service.py::test_unfollow_user ERROR                [ 14%]
tests\test_community_service.py::test_get_follow_stats ERROR             [ 14%]
tests\test_community_service.py::test_moderate_content_flag ERROR        [ 14%]
tests\test_community_service.py::test_moderate_content_delete ERROR      [ 14%]
tests\test_community_service.py::test_get_flagged_content ERROR          [ 14%]
tests\test_community_service.py::test_get_community_analytics ERROR      [ 15%]
tests\test_database_reset.py::test_reset_metadata_restores_dropped_tables PASSED [ 15%]
tests\test_database_reset.py::test_safe_drop_schema_handles_drop_all_errors PASSED [ 15%]
tests\test_deal_endpoints.py::test_create_deal_success FAILED            [ 15%]
tests\test_deal_endpoints.py::test_create_deal_validation_errors FAILED  [ 15%]
tests\test_deal_endpoints.py::test_create_deal_sets_owner_and_org FAILED [ 15%]
tests\test_deal_endpoints.py::test_create_deal_requires_auth PASSED      [ 15%]
tests\test_deal_endpoints.py::test_create_deal_default_stage FAILED      [ 15%]
tests\test_deal_endpoints.py::test_list_deals_returns_org_deals_only FAILED [ 15%]
tests\test_deal_endpoints.py::test_list_deals_pagination_works FAILED    [ 15%]
tests\test_deal_endpoints.py::test_list_deals_filter_by_stage FAILED     [ 16%]
tests\test_deal_endpoints.py::test_list_deals_search_by_name FAILED      [ 16%]
tests\test_deal_endpoints.py::test_list_deals_sort_by_created_at FAILED  [ 16%]
tests\test_deal_endpoints.py::test_list_deals_excludes_archived FAILED   [ 16%]
tests\test_deal_endpoints.py::test_list_deals_requires_auth PASSED       [ 16%]
tests\test_deal_endpoints.py::test_get_deal_success FAILED               [ 16%]
tests\test_deal_endpoints.py::test_get_deal_not_found FAILED             [ 16%]
tests\test_deal_endpoints.py::test_get_deal_forbidden_other_org FAILED   [ 16%]
tests\test_deal_endpoints.py::test_get_deal_requires_auth PASSED         [ 16%]
tests\test_deal_endpoints.py::test_update_deal_success FAILED            [ 16%]
tests\test_deal_endpoints.py::test_update_deal_stage_change FAILED       [ 17%]
tests\test_deal_endpoints.py::test_update_deal_partial_update FAILED     [ 17%]
tests\test_deal_endpoints.py::test_update_deal_forbidden_other_org FAILED [ 17%]
tests\test_deal_endpoints.py::test_update_deal_validation_errors FAILED  [ 17%]
tests\test_deal_endpoints.py::test_archive_deal_success FAILED           [ 17%]
tests\test_deal_endpoints.py::test_archive_deal_forbidden_other_org FAILED [ 17%]
tests\test_deal_endpoints.py::test_unarchive_deal_success FAILED         [ 17%]
tests\test_deal_endpoints.py::test_unarchive_deal_forbidden_other_org FAILED [ 17%]
tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_create_criteria_success ERROR [ 17%]
tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_create_criteria_requires_auth ERROR [ 17%]
tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_list_criteria ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_for_deal ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_requires_auth ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_for_deal ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_requires_auth ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_deal_not_found ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_deal_not_found ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_view ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_save ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_pass ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_request_intro ERROR [ 18%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_requires_auth ERROR [ 19%]
tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_match_not_found ERROR [ 19%]
tests\test_deal_matching_api.py::TestDealMatchingIntegration::test_create_criteria_and_find_matches_workflow ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_create_deal_match_criteria_with_required_fields ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_create_criteria_with_optional_fields ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_criteria_enforces_organization_isolation ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchModel::test_create_deal_match ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchModel::test_match_score_validation ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchModel::test_match_status_tracking ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchActionModel::test_create_match_action ERROR [ 19%]
tests\test_deal_matching_models.py::TestDealMatchActionModel::test_track_multiple_actions_on_match ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_exact ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_partial ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_none ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_size_match_within_range ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_size_match_outside_range ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_geography_match_exact ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_geography_match_none ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_semantic_similarity PASSED [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_weighted_score ERROR [ 20%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_determine_confidence_level_high PASSED [ 21%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_determine_confidence_level_medium PASSED [ 21%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_determine_confidence_level_low PASSED [ 21%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_find_matches_returns_ranked_results ERROR [ 21%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_find_matches_filters_low_scores ERROR [ 21%]
tests\test_deal_matching_service.py::TestDealMatchingService::test_match_result_contains_explanation ERROR [ 21%]
tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_fetch_ai_suggestions FAILED [ 21%]
tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_accept_ai_suggestion FAILED [ 21%]
tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_reject_ai_suggestion FAILED [ 21%]
tests\test_document_ai_and_versions.py::TestVersionHistoryEndpoints::test_list_document_versions FAILED [ 21%]
tests\test_document_ai_and_versions.py::TestVersionHistoryEndpoints::test_restore_document_version FAILED [ 22%]
tests\test_document_endpoints.py::test_create_folder_success ERROR       [ 22%]
tests\test_document_endpoints.py::test_upload_document_success ERROR     [ 22%]
tests\test_document_endpoints.py::test_upload_document_rejects_large_files ERROR [ 22%]
tests\test_document_endpoints.py::test_list_documents_filters_by_folder ERROR [ 22%]
tests\test_document_endpoints.py::test_download_document_records_access_log ERROR [ 22%]
tests\test_document_endpoints.py::test_set_document_permission ERROR     [ 22%]
tests\test_document_endpoints.py::test_list_folders_lazy_loading ERROR   [ 22%]
tests\test_document_endpoints.py::test_list_folders_supports_search ERROR [ 22%]
tests\test_document_endpoints.py::test_create_nested_folder ERROR        [ 22%]
tests\test_document_endpoints.py::test_rename_folder ERROR               [ 22%]
tests\test_document_endpoints.py::test_delete_empty_folder ERROR         [ 23%]
tests\test_document_endpoints.py::test_delete_non_empty_folder_fails ERROR [ 23%]
tests\test_document_endpoints.py::test_folder_requires_authentication ERROR [ 23%]
tests\test_document_endpoints.py::test_folder_organization_isolation ERROR [ 23%]
tests\test_document_endpoints.py::test_upload_multiple_documents ERROR   [ 23%]
tests\test_document_endpoints.py::test_upload_unsupported_file_type ERROR [ 23%]
tests\test_document_endpoints.py::test_upload_creates_audit_log ERROR    [ 23%]
tests\test_document_endpoints.py::test_search_documents_by_filename ERROR [ 23%]
tests\test_document_endpoints.py::test_filter_documents_by_file_type ERROR [ 23%]
tests\test_document_endpoints.py::test_upload_same_name_creates_new_version ERROR [ 23%]
tests\test_document_endpoints.py::test_list_document_versions ERROR      [ 24%]
tests\test_document_endpoints.py::test_download_specific_version ERROR   [ 24%]
tests\test_document_endpoints.py::test_restore_previous_version ERROR    [ 24%]
tests\test_document_endpoints.py::test_max_versions_enforced ERROR       [ 24%]
tests\test_document_endpoints.py::test_delete_document_archives_all_versions ERROR [ 24%]
tests\test_document_endpoints.py::test_viewer_cannot_delete_document ERROR [ 24%]
tests\test_document_endpoints.py::test_viewer_can_download_document ERROR [ 24%]
tests\test_document_endpoints.py::test_editor_can_upload_with_folder_permission ERROR [ 24%]
tests\test_document_endpoints.py::test_granting_folder_permission_creates_audit_log ERROR [ 24%]
tests\test_document_endpoints.py::test_revoking_folder_permission_creates_audit_log ERROR [ 24%]
tests\test_document_endpoints.py::test_revoking_document_permission_creates_audit_log ERROR [ 25%]
tests\test_document_endpoints.py::test_editor_cannot_delete_others_document ERROR [ 25%]
tests\test_document_endpoints.py::test_editor_can_delete_own_document ERROR [ 25%]
tests\test_document_endpoints.py::test_delete_document_requires_editor_permission ERROR [ 25%]
tests\test_document_endpoints.py::test_delete_document_records_audit_log ERROR [ 25%]
tests\test_document_endpoints.py::test_access_logs_include_user_name ERROR [ 25%]
tests\test_document_endpoints.py::test_bulk_download_documents ERROR     [ 25%]
tests\test_document_endpoints.py::test_bulk_download_requires_permission ERROR [ 25%]
tests\test_document_endpoints.py::test_bulk_delete_documents ERROR       [ 25%]
tests\test_document_endpoints.py::test_bulk_delete_requires_owner_permission ERROR [ 25%]
tests\test_document_endpoints.py::test_bulk_delete_partial_failure ERROR [ 25%]
tests\test_document_endpoints.py::test_document_question_workflow ERROR  [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_create_template FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_create_template_forbidden_other_org FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_list_templates FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_list_templates_with_filters FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_get_template FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_get_template_not_found FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_update_template FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_delete_template FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document FAILED [ 26%]
tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document_missing_variables FAILED [ 27%]
tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document_template_not_found FAILED [ 27%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_list_generated_documents FAILED [ 27%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_get_generated_document FAILED [ 27%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_update_document_status FAILED [ 27%]
tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_update_document_content FAILED [ 27%]
tests\test_document_generation_api.py::TestTemplateRenderingService::test_complex_template_rendering FAILED [ 27%]
tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_as_pdf FAILED [ 27%]
tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_as_docx FAILED [ 27%]
tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_not_found FAILED [ 27%]
tests\test_document_generation_models.py::test_create_document_template ERROR [ 28%]
tests\test_document_generation_models.py::test_template_status_enum ERROR [ 28%]
tests\test_document_generation_models.py::test_template_version_tracking ERROR [ 28%]
tests\test_document_generation_models.py::test_template_repr ERROR       [ 28%]
tests\test_document_generation_models.py::test_create_generated_document ERROR [ 28%]
tests\test_document_generation_models.py::test_generated_document_status_enum ERROR [ 28%]
tests\test_document_generation_models.py::test_generated_document_timestamps ERROR [ 28%]
tests\test_document_generation_models.py::test_generated_document_file_path ERROR [ 28%]
tests\test_document_generation_models.py::test_template_document_relationship ERROR [ 28%]
tests\test_document_generation_models.py::test_template_variables_json_field ERROR [ 28%]
tests\test_document_service.py::test_trim_document_versions_keeps_latest_twenty FAILED [ 29%]
tests\test_document_service.py::test_trim_document_versions_noop_when_within_limit FAILED [ 29%]
tests\test_document_service.py::test_bulk_download_documents_logs_access FAILED [ 29%]
tests\test_document_service.py::test_bulk_download_documents_requires_viewer_permission FAILED [ 29%]
tests\test_document_service_error_paths.py::test_delete_folder_with_documents_raises_value_error FAILED [ 29%]
tests\test_document_service_error_paths.py::test_delete_folder_with_subfolders_raises_value_error FAILED [ 29%]
tests\test_document_service_error_paths.py::test_upload_document_unsupported_file_type FAILED [ 29%]
tests\test_document_service_error_paths.py::test_upload_document_file_size_exceeds_limit FAILED [ 29%]
tests\test_document_service_error_paths.py::test_create_folder_insufficient_permissions_for_subfolder FAILED [ 29%]
tests\test_document_service_error_paths.py::test_create_folder_non_owner_cannot_create_top_level FAILED [ 29%]
tests\test_document_service_error_paths.py::test_upload_document_non_owner_cannot_upload_to_root FAILED [ 29%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_has_audio_podcast_access PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_starter_no_audio_podcast_access PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_no_video_podcast_access PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_premium_has_video_podcast_access PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_premium_has_youtube_integration PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_no_youtube_integration PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_enterprise_has_live_streaming PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_premium_no_live_streaming PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_enterprise_has_multi_language_transcription PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_has_basic_transcription PASSED [ 30%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_professional_no_ai_enhanced_transcription PASSED [ 31%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_raises_feature_not_found_for_invalid_feature PASSED [ 31%]
tests\test_entitlement.py::TestCheckFeatureAccess::test_all_tiers_have_core_features PASSED [ 31%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_starter_tier_features PASSED [ 31%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_professional_tier_features PASSED [ 31%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_premium_tier_features PASSED [ 31%]
tests\test_entitlement.py::TestGetFeaturesForTier::test_enterprise_tier_features PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-podcast_audio-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-podcast_video-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-youtube_integration-False] PASSED [ 31%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-live_streaming-False] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[starter-deal_management-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-podcast_audio-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-podcast_video-False] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-youtube_integration-False] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-live_streaming-False] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-transcription_basic-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[professional-transcription_ai_enhanced-False] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-podcast_audio-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-podcast_video-True] PASSED [ 32%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-youtube_integration-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-live_streaming-False] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-transcription_basic-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-transcription_ai_enhanced-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[premium-transcription_multi_language-False] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-podcast_audio-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-podcast_video-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-youtube_integration-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-live_streaming-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-transcription_basic-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-transcription_ai_enhanced-True] PASSED [ 33%]
tests\test_entitlement.py::TestFeatureEntitlementMatrix::test_feature_entitlement_matrix[enterprise-transcription_multi_language-True] PASSED [ 34%]
tests\test_entitlement.py::TestFeatureNotFoundError::test_feature_not_found_error_message PASSED [ 34%]
tests\test_event_models.py::TestEventModel::test_create_event ERROR      [ 34%]
tests\test_event_models.py::TestEventModel::test_event_requires_organization ERROR [ 34%]
tests\test_event_models.py::TestEventModel::test_event_location_types ERROR [ 34%]
tests\test_event_models.py::TestEventTicketModel::test_create_event_ticket ERROR [ 34%]
tests\test_event_models.py::TestEventTicketModel::test_ticket_requires_event FAILED [ 34%]
tests\test_event_models.py::TestEventRegistrationModel::test_create_registration ERROR [ 34%]
tests\test_event_models.py::TestEventRegistrationModel::test_registration_requires_event_and_user FAILED [ 34%]
tests\test_event_models.py::TestEventSessionModel::test_create_event_session ERROR [ 34%]
tests\test_event_models.py::TestEventSessionModel::test_session_requires_event FAILED [ 35%]
tests\test_event_models.py::TestEventAnalyticsModel::test_create_event_analytics ERROR [ 35%]
tests\test_event_service.py::TestEventService::test_create_event ERROR   [ 35%]
tests\test_event_service.py::TestEventService::test_get_event ERROR      [ 35%]
tests\test_event_service.py::TestEventService::test_get_event_wrong_organization ERROR [ 35%]
tests\test_event_service.py::TestEventService::test_list_events_pagination ERROR [ 35%]
tests\test_event_service.py::TestEventService::test_update_event ERROR   [ 35%]
tests\test_event_service.py::TestEventService::test_delete_event_soft_delete ERROR [ 35%]
tests\test_event_service.py::TestEventTicketService::test_create_ticket ERROR [ 35%]
tests\test_event_service.py::TestEventTicketService::test_create_ticket_invalid_event ERROR [ 35%]
tests\test_event_service.py::TestEventRegistrationService::test_create_registration ERROR [ 36%]
tests\test_event_service.py::TestEventRegistrationService::test_create_registration_with_ticket ERROR [ 36%]
tests\test_event_service.py::TestEventRegistrationService::test_create_registration_sold_out_ticket ERROR [ 36%]
tests\test_event_service.py::TestEventRegistrationService::test_cancel_registration_updates_ticket ERROR [ 36%]
tests\test_event_service.py::TestEventAnalyticsService::test_get_event_analytics ERROR [ 36%]
tests\test_event_service.py::TestEventAnalyticsService::test_analytics_with_sessions ERROR [ 36%]
tests\test_financial_api.py::test_calculate_financial_ratios_endpoint ERROR [ 36%]
tests\test_financial_api.py::test_calculate_ratios_requires_authentication ERROR [ 36%]
tests\test_financial_api.py::test_calculate_ratios_deal_not_found ERROR  [ 36%]
tests\test_financial_api.py::test_calculate_ratios_with_partial_data ERROR [ 36%]
tests\test_financial_api.py::test_get_financial_connections_endpoint_returns_empty_list_when_no_connections ERROR [ 37%]
tests\test_financial_api.py::test_get_financial_connections_endpoint_returns_connections ERROR [ 37%]
tests\test_financial_api.py::test_get_financial_ratios_not_found ERROR   [ 37%]
tests\test_financial_api.py::test_get_financial_narrative_not_found ERROR [ 37%]
tests\test_financial_api.py::test_connect_xero_initiates_oauth_flow ERROR [ 37%]
tests\test_financial_api.py::test_connect_xero_with_invalid_deal ERROR   [ 37%]
tests\test_financial_api.py::test_xero_oauth_callback_success ERROR      [ 37%]
tests\test_financial_api.py::test_xero_oauth_callback_missing_code ERROR [ 37%]
tests\test_financial_api.py::test_sync_financial_data_success ERROR      [ 37%]
tests\test_financial_api.py::test_sync_financial_data_no_connection ERROR [ 37%]
tests\test_financial_api.py::test_connect_quickbooks_initiates_oauth_flow ERROR [ 37%]
tests\test_financial_api.py::test_connect_quickbooks_with_invalid_deal ERROR [ 38%]
tests\test_financial_api.py::test_quickbooks_oauth_callback_success ERROR [ 38%]
tests\test_financial_api.py::test_quickbooks_oauth_callback_missing_params ERROR [ 38%]
tests\test_financial_api.py::test_sync_quickbooks_financial_data_success ERROR [ 38%]
tests\test_financial_api.py::test_sync_quickbooks_financial_data_no_connection ERROR [ 38%]
tests\test_financial_api.py::test_quickbooks_connection_status ERROR     [ 38%]
tests\test_financial_api.py::test_disconnect_quickbooks_connection ERROR [ 38%]
tests\test_financial_api.py::test_connect_netsuite_initiates_oauth_flow ERROR [ 38%]
tests\test_financial_api.py::test_connect_netsuite_with_invalid_deal ERROR [ 38%]
tests\test_financial_api.py::test_netsuite_oauth_callback_success ERROR  [ 38%]
tests\test_financial_api.py::test_sync_netsuite_financial_data_success ERROR [ 39%]
tests\test_financial_api.py::test_sync_netsuite_financial_data_no_connection ERROR [ 39%]
tests\test_financial_api.py::test_connect_sage_initiates_oauth_flow ERROR [ 39%]
tests\test_financial_api.py::test_connect_sage_with_invalid_deal ERROR   [ 39%]
tests\test_financial_api.py::test_sage_oauth_callback_success ERROR      [ 39%]
tests\test_financial_api.py::test_sync_sage_financial_data_success ERROR [ 39%]
tests\test_financial_api.py::test_sync_sage_financial_data_no_connection ERROR [ 39%]
tests\test_financial_api.py::test_get_readiness_score_success ERROR      [ 39%]
tests\test_financial_api.py::test_get_readiness_score_no_narrative ERROR [ 39%]
tests\test_financial_models_sync.py::test_create_financial_connection FAILED [ 39%]
tests\test_financial_models_sync.py::test_financial_connection_cascade_delete FAILED [ 40%]
tests\test_financial_models_sync.py::test_create_financial_statement_balance_sheet FAILED [ 40%]
tests\test_financial_models_sync.py::test_financial_statement_with_json_fields FAILED [ 40%]
tests\test_financial_models_sync.py::test_create_financial_ratios FAILED [ 40%]
tests\test_financial_models_sync.py::test_financial_ratio_nullable_fields FAILED [ 40%]
tests\test_financial_models_sync.py::test_create_financial_narrative FAILED [ 40%]
tests\test_financial_models_sync.py::test_financial_narrative_version_control FAILED [ 40%]
tests\test_financial_models_sync.py::test_complete_financial_data_chain FAILED [ 40%]
tests\test_financial_models_sync.py::test_cascade_delete_all_financial_data FAILED [ 40%]
tests\test_financial_narrative_service.py::test_build_narrative_prompt_with_complete_data PASSED [ 40%]
tests\test_financial_narrative_service.py::test_build_narrative_prompt_with_minimal_data PASSED [ 40%]
tests\test_financial_narrative_service.py::test_parse_narrative_response_with_complete_response PASSED [ 41%]
tests\test_financial_narrative_service.py::test_parse_narrative_response_with_red_flags PASSED [ 41%]
tests\test_financial_narrative_service.py::test_calculate_readiness_score_high_quality_deal PASSED [ 41%]
tests\test_financial_narrative_service.py::test_calculate_readiness_score_low_quality_deal PASSED [ 41%]
tests\test_financial_narrative_service.py::test_calculate_readiness_score_moderate_deal PASSED [ 41%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_success FAILED [ 41%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_returns_existing_by_default FAILED [ 41%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_raises_error_when_no_data FAILED [ 41%]
tests\test_financial_narrative_service.py::test_generate_financial_narrative_raises_error_when_deal_not_found FAILED [ 41%]
tests\test_financial_ratios.py::test_current_ratio_calculation PASSED    [ 41%]
tests\test_financial_ratios.py::test_current_ratio_with_zero_liabilities PASSED [ 42%]
tests\test_financial_ratios.py::test_quick_ratio_calculation PASSED      [ 42%]
tests\test_financial_ratios.py::test_quick_ratio_with_zero_liabilities PASSED [ 42%]
tests\test_financial_ratios.py::test_cash_ratio_calculation PASSED       [ 42%]
tests\test_financial_ratios.py::test_operating_cash_flow_ratio_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_defensive_interval_ratio_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_gross_profit_margin_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_gross_profit_margin_with_zero_revenue PASSED [ 42%]
tests\test_financial_ratios.py::test_operating_profit_margin_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_net_profit_margin_calculation PASSED [ 42%]
tests\test_financial_ratios.py::test_return_on_assets_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_return_on_equity_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_return_on_invested_capital_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_ebitda_margin_calculation PASSED    [ 43%]
tests\test_financial_ratios.py::test_ebit_margin_calculation PASSED      [ 43%]
tests\test_financial_ratios.py::test_debt_to_equity_calculation PASSED   [ 43%]
tests\test_financial_ratios.py::test_debt_to_equity_with_zero_equity PASSED [ 43%]
tests\test_financial_ratios.py::test_debt_to_assets_calculation PASSED   [ 43%]
tests\test_financial_ratios.py::test_equity_multiplier_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_interest_coverage_calculation PASSED [ 43%]
tests\test_financial_ratios.py::test_interest_coverage_with_zero_interest PASSED [ 44%]
tests\test_financial_ratios.py::test_debt_service_coverage_calculation PASSED [ 44%]
tests\test_financial_ratios.py::test_financial_leverage_calculation PASSED [ 44%]
tests\test_financial_ratios.py::test_calculate_all_ratios_comprehensive PASSED [ 44%]
tests\test_financial_ratios.py::test_calculate_all_ratios_with_missing_data PASSED [ 44%]
tests\test_financial_ratios.py::test_calculate_all_ratios_with_empty_data PASSED [ 44%]
tests\test_financial_xero_integration.py::test_placeholder_ratio_engine SKIPPED [ 44%]
tests\test_master_admin_api.py::test_master_admin_requires_auth PASSED   [ 44%]
tests\test_master_admin_api.py::test_goal_crud_flow ERROR                [ 44%]
tests\test_master_admin_api.py::test_activity_crud_and_listing ERROR     [ 44%]
tests\test_master_admin_api.py::test_scores_and_dashboard_stats ERROR    [ 44%]
tests\test_master_admin_api.py::test_focus_session_flow ERROR            [ 45%]
tests\test_master_admin_api.py::test_nudge_management ERROR              [ 45%]
tests\test_master_admin_api.py::test_meeting_template_management ERROR   [ 45%]
tests\test_master_admin_api.py::test_prospect_crud_flow ERROR            [ 45%]
tests\test_master_admin_api.py::test_deal_pipeline_flow ERROR            [ 45%]
tests\test_master_admin_api.py::test_campaign_and_recipient_management ERROR [ 45%]
tests\test_master_admin_api.py::test_content_script_and_piece_flow ERROR [ 45%]
tests\test_master_admin_api.py::test_lead_capture_flow ERROR             [ 45%]
tests\test_master_admin_api.py::test_collateral_library_flow ERROR       [ 45%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_create_admin_goal ERROR [ 45%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_unique_constraint ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_defaults ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_repr ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_create_admin_activity ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_type_constraint SKIPPED [ 46%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_status_constraint SKIPPED [ 46%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_default_amount ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_with_prospect ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_create_admin_score ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_range_constraint ERROR [ 46%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_unique_constraint ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_defaults ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_create_focus_session ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_complete_focus_session ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_interrupted_focus_session ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_create_nudge ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_nudge_type_constraint SKIPPED [ 47%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_nudge_priority_constraint SKIPPED [ 47%]
tests\test_master_admin_models.py::TestAdminNudgeModel::test_mark_nudge_as_read ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminMeetingModel::test_create_meeting_template ERROR [ 47%]
tests\test_master_admin_models.py::TestAdminMeetingModel::test_meeting_type_constraint SKIPPED [ 48%]
tests\test_master_admin_models.py::TestAdminMeetingModel::test_meeting_default_duration ERROR [ 48%]
tests\test_models_financial_connection.py::test_create_financial_connection FAILED [ 48%]
tests\test_models_financial_connection.py::test_financial_connection_with_optional_fields FAILED [ 48%]
tests\test_models_financial_connection.py::test_financial_connection_cascade_delete_with_deal FAILED [ 48%]
tests\test_models_financial_connection.py::test_financial_connection_relationship_to_deal FAILED [ 48%]
tests\test_models_financial_connection.py::test_financial_connection_soft_delete FAILED [ 48%]
tests\test_models_financial_connection.py::test_financial_connection_status_values FAILED [ 48%]
tests\test_netsuite_integration.py::test_netsuite_rest_api_client_can_be_imported SKIPPED [ 48%]
tests\test_netsuite_integration.py::test_real_netsuite_client_class_exists SKIPPED [ 48%]
tests\test_netsuite_integration.py::test_netsuite_oauth_url_uses_real_credentials SKIPPED [ 48%]
tests\test_netsuite_integration.py::test_netsuite_client_has_real_configuration SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_token_exchange_structure_matches_netsuite_api SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_get_connections_returns_real_company_structure SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_balance_sheet_import_uses_real_netsuite_api_format SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_netsuite_rest_api_error_handling SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_netsuite_account_id_configuration SKIPPED [ 49%]
tests\test_netsuite_integration.py::test_full_netsuite_oauth_flow_with_real_api SKIPPED [ 49%]
tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_creates_with_defaults FAILED [ 49%]
tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_normalizes_subscription_tier FAILED [ 49%]
tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_falls_back_to_starter_on_invalid_tier FAILED [ 49%]
tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_generates_unique_slug FAILED [ 50%]
tests\test_organization_service.py::TestOrganizationService::test_deactivate_organization_marks_inactive FAILED [ 50%]
tests\test_path_safety.py::test_pytest_ignore_collect_delegates_to_path_safety PASSED [ 50%]
tests\test_path_safety.py::test_reserved_name_detection_handles_strings PASSED [ 50%]
tests\test_path_safety.py::test_reserved_name_detection_handles_py_path_like_objects PASSED [ 50%]
tests\test_path_safety.py::test_should_ignore_path_only_on_windows PASSED [ 50%]
tests\test_pipeline_template_api.py::test_create_and_list_pipeline_templates ERROR [ 50%]
tests\test_pipeline_template_api.py::test_update_pipeline_template ERROR [ 50%]
tests\test_pipeline_template_api.py::test_delete_pipeline_template ERROR [ 50%]
tests\test_pipeline_template_schemas.py::test_stage_color_normalizes_to_uppercase_hex PASSED [ 50%]
tests\test_pipeline_template_schemas.py::test_stage_color_without_hash_gets_hash_prefix PASSED [ 51%]
tests\test_pipeline_template_schemas.py::test_stage_color_with_hash_preserves_hash_and_uppercases PASSED [ 51%]
tests\test_pipeline_template_schemas.py::test_template_requires_at_least_one_stage PASSED [ 51%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_starter_user_blocked_from_creating_episode FAILED [ 51%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_quota_service_passes_db_session FAILED [ 51%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_can_create_episode FAILED [ 51%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_quota_exceeded_returns_429 FAILED [ 51%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_blocked_from_video_episode FAILED [ 51%]
tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_premium_user_can_create_video_episode FAILED [ 51%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_returns_quota_summary_for_professional PASSED [ 51%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_reports_unlimited_for_premium PASSED [ 51%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_blocks_starter_tier PASSED [ 52%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_sets_warning_headers_when_near_limit PASSED [ 52%]
tests\test_podcast_api.py::TestPodcastUsageEndpoint::test_usage_endpoint_sets_upgrade_headers_when_quota_exceeded PASSED [ 52%]
tests\test_podcast_api.py::TestPodcastFeatureAccessEndpoint::test_feature_access_returns_true_for_authorized_tier PASSED [ 52%]
tests\test_podcast_api.py::TestPodcastFeatureAccessEndpoint::test_feature_access_returns_false_for_insufficient_tier PASSED [ 52%]
tests\test_podcast_api.py::TestPodcastFeatureAccessEndpoint::test_feature_access_returns_404_for_unknown_feature PASSED [ 52%]
tests\test_podcast_api.py::TestPodcastListEndpoint::test_list_episodes_returns_organizations_episodes FAILED [ 52%]
tests\test_podcast_api.py::TestPodcastListEndpoint::test_list_episodes_filters_by_status FAILED [ 52%]
tests\test_podcast_api.py::TestPodcastGetSingleEndpoint::test_get_single_episode_returns_episode FAILED [ 52%]
tests\test_podcast_api.py::TestPodcastGetSingleEndpoint::test_get_single_episode_returns_404_when_not_found FAILED [ 52%]
tests\test_podcast_api.py::TestPodcastUpdateEndpoint::test_update_episode_modifies_fields FAILED [ 53%]
tests\test_podcast_api.py::TestPodcastDeleteEndpoint::test_delete_episode_removes_episode FAILED [ 53%]
tests\test_podcast_api.py::TestPodcastDeleteEndpoint::test_delete_episode_returns_404_when_not_found FAILED [ 53%]
tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_premium_user_can_publish_video_to_youtube FAILED [ 53%]
tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_podcast_youtube_upload_requires_video_asset FAILED [ 53%]
tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_youtube_upload_permission_error_returns_403 FAILED [ 53%]
tests\test_podcast_api.py::TestFeatureAccessEndpoint::test_feature_access_includes_labels_when_access_granted PASSED [ 53%]
tests\test_podcast_api.py::TestFeatureAccessEndpoint::test_feature_access_includes_upgrade_message_when_denied PASSED [ 53%]
tests\test_podcast_api.py::TestFeatureAccessEndpoint::test_feature_access_returns_404_for_unknown_feature PASSED [ 53%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_professional_success FAILED [ 53%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_starter_blocked FAILED [ 54%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_validates_file_format FAILED [ 54%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_validates_file_size FAILED [ 54%]
tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_updates_episode_audio_url FAILED [ 54%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_premium_success FAILED [ 54%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_professional_blocked FAILED [ 54%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_validates_file_format FAILED [ 54%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_validates_file_size FAILED [ 54%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_generates_thumbnail FAILED [ 54%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_accepts_mov_format FAILED [ 54%]
tests\test_podcast_api.py::TestVideoUpload::test_upload_video_updates_episode_video_url FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_audio_professional_success FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_starter_blocked FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_requires_audio_file FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_updates_episode_transcript FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_handles_whisper_api_error FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_multi_language_requires_enterprise FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_multi_language_enterprise_success FAILED [ 55%]
tests\test_podcast_api.py::TestTranscription::test_transcribe_response_includes_metadata FAILED [ 55%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_txt_success FAILED [ 55%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_srt_success FAILED [ 55%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_requires_transcript FAILED [ 56%]
tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_starter_blocked FAILED [ 56%]
tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_premium_success FAILED [ 56%]
tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_requires_video FAILED [ 56%]
tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_professional_blocked FAILED [ 56%]
tests\test_podcast_service.py::TestPodcastService::test_create_episode FAILED [ 56%]
tests\test_podcast_service.py::TestPodcastService::test_get_episodes_filters_by_status FAILED [ 56%]
tests\test_podcast_service.py::TestPodcastService::test_publish_episode_sets_timestamp FAILED [ 56%]
tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_uses_whisper FAILED [ 56%]
tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_requires_entitlement FAILED [ 56%]
tests\test_podcast_service.py::TestPodcastService::test_get_episode_analytics_aggregates_platform_totals FAILED [ 57%]
tests\test_podcast_service.py::TestPodcastService::test_generate_rss_feed_includes_published_episodes FAILED [ 57%]
tests\test_podcast_service.py::TestPodcastService::test_multi_tenant_isolation FAILED [ 57%]
tests\test_podcast_service.py::TestPodcastService::test_update_episode_mutates_fields FAILED [ 57%]
tests\test_podcast_service.py::TestPodcastService::test_delete_episode_removes_record FAILED [ 57%]
tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_missing_episode_raises FAILED [ 57%]
tests\test_quickbooks_integration.py::test_quickbooks_python_sdk_can_be_imported SKIPPED [ 57%]
tests\test_quickbooks_integration.py::test_real_quickbooks_client_class_exists SKIPPED [ 57%]
tests\test_quickbooks_integration.py::test_quickbooks_oauth_url_uses_real_credentials SKIPPED [ 57%]
tests\test_quickbooks_integration.py::test_quickbooks_client_has_real_configuration SKIPPED [ 57%]
tests\test_quickbooks_integration.py::test_token_exchange_structure_matches_quickbooks_api SKIPPED [ 58%]
tests\test_quickbooks_integration.py::test_get_connections_returns_real_company_structure SKIPPED [ 58%]
tests\test_quickbooks_integration.py::test_balance_sheet_import_uses_real_quickbooks_api_format SKIPPED [ 58%]
tests\test_quickbooks_integration.py::test_quickbooks_sdk_error_handling SKIPPED [ 58%]
tests\test_quickbooks_integration.py::test_full_quickbooks_oauth_flow_with_real_api SKIPPED [ 58%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_professional_tier_allows_creation_within_quota PASSED [ 58%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_professional_tier_blocks_creation_at_quota_limit PASSED [ 58%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_premium_tier_unlimited_never_blocks PASSED [ 58%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_enterprise_tier_unlimited_never_blocks PASSED [ 58%]
tests\test_quota_service.py::TestCheckEpisodeQuota::test_starter_tier_blocks_all_podcast_creation PASSED [ 58%]
tests\test_quota_service.py::TestGetRemainingQuota::test_professional_tier_returns_correct_remaining PASSED [ 59%]
tests\test_quota_service.py::TestGetRemainingQuota::test_premium_tier_returns_unlimited_indicator PASSED [ 59%]
tests\test_quota_service.py::TestGetRemainingQuota::test_returns_zero_when_quota_exhausted PASSED [ 59%]
tests\test_quota_service.py::TestIncrementEpisodeCount::test_increments_usage_count_in_database FAILED [ 59%]
tests\test_quota_service.py::TestIncrementEpisodeCount::test_sync_session_increments_usage FAILED [ 59%]
tests\test_quota_service.py::TestIncrementEpisodeCount::test_creates_new_usage_record_for_first_episode FAILED [ 59%]
tests\test_quota_service.py::TestGetMonthlyUsage::test_returns_current_month_usage_count FAILED [ 59%]
tests\test_quota_service.py::TestGetMonthlyUsage::test_sync_session_returns_usage FAILED [ 59%]
tests\test_quota_service.py::TestGetMonthlyUsage::test_returns_zero_when_no_usage_records FAILED [ 59%]
tests\test_quota_service.py::TestQuotaExceededError::test_quota_exceeded_error_has_clear_message PASSED [ 59%]
tests\test_quota_service.py::TestQuotaExceededError::test_quota_exceeded_error_includes_upgrade_guidance PASSED [ 59%]
tests\test_quota_service.py::TestGetQuotaSummary::test_returns_professional_summary PASSED [ 60%]
tests\test_quota_service.py::TestGetQuotaSummary::test_returns_unlimited_summary PASSED [ 60%]
tests\test_quota_service.py::TestGetQuotaSummary::test_sets_warning_status_when_usage_exceeds_eighty_percent PASSED [ 60%]
tests\test_quota_service.py::TestGetQuotaSummary::test_sets_critical_status_when_usage_exceeds_ninety_percent PASSED [ 60%]
tests\test_quota_service.py::TestGetQuotaSummary::test_includes_period_bounds_for_monthly_reset PASSED [ 60%]
tests\test_quota_service.py::TestGetQuotaSummary::test_usage_resets_when_new_month_starts FAILED [ 60%]
tests\test_quota_service.py::TestGetQuotaSummary::test_marks_quota_exceeded_as_upgrade_required PASSED [ 60%]
tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_helper_is_defined PASSED [ 60%]
tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_creates_zero_record FAILED [ 60%]
tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_is_idempotent FAILED [ 60%]
tests\test_quota_service.py::TestMonthlyQuotaReset::test_quota_resets_when_new_billing_cycle_starts FAILED [ 61%]
tests\test_quota_service.py::TestMonthlyQuotaReset::test_usage_count_returns_zero_in_new_month FAILED [ 61%]
tests\test_quota_service.py::TestMonthlyQuotaReset::test_remaining_quota_resets_after_month_boundary FAILED [ 61%]
tests\test_rbac.py::test_get_current_admin_user_with_admin ERROR         [ 61%]
tests\test_rbac.py::test_get_current_admin_user_with_non_admin ERROR     [ 61%]
tests\test_rbac.py::test_require_role_exact_match ERROR                  [ 61%]
tests\test_rbac.py::test_require_role_no_match ERROR                     [ 61%]
tests\test_rbac.py::test_require_role_admin_override ERROR               [ 61%]
tests\test_rbac.py::test_require_min_role_exact_match ERROR              [ 61%]
tests\test_rbac.py::test_require_min_role_higher_role ERROR              [ 61%]
tests\test_rbac.py::test_require_min_role_lower_role ERROR               [ 62%]
tests\test_rbac.py::test_require_min_role_admin_override ERROR           [ 62%]
tests\test_rbac.py::test_role_hierarchy PASSED                           [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceInitialization::test_initialization_with_valid_credentials SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceInitialization::test_initialization_fails_without_credentials SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceInitialization::test_initialization_fails_with_partial_credentials SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileKey::test_generate_file_key_creates_unique_hash SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileKey::test_generate_file_key_is_unique SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_save_file_uploads_successfully SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_save_file_includes_metadata SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_save_file_handles_client_error SKIPPED [ 62%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_path_returns_presigned_url SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_path_raises_error_for_missing_file SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_delete_file_removes_from_storage SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_delete_file_returns_false_for_missing_file SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_file_exists_returns_true_for_existing_file SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_file_exists_returns_false_for_missing_file SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_size_returns_content_length SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceFileOperations::test_get_file_size_raises_error_for_missing_file SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServicePresignedURLs::test_get_presigned_url_generates_valid_url SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServicePresignedURLs::test_get_presigned_url_default_expiration SKIPPED [ 63%]
tests\test_s3_storage_service.py::TestS3StorageServiceContentTypes::test_guess_content_type_pdf SKIPPED [ 64%]
tests\test_s3_storage_service.py::TestS3StorageServiceContentTypes::test_guess_content_type_mp4 SKIPPED [ 64%]
tests\test_s3_storage_service.py::TestS3StorageServiceContentTypes::test_guess_content_type_unknown SKIPPED [ 64%]
tests\test_sage_integration.py::test_sage_rest_api_client_can_be_imported SKIPPED [ 64%]
tests\test_sage_integration.py::test_real_sage_client_class_exists SKIPPED [ 64%]
tests\test_sage_integration.py::test_sage_oauth_url_uses_real_credentials SKIPPED [ 64%]
tests\test_sage_integration.py::test_sage_client_has_real_configuration SKIPPED [ 64%]
tests\test_sage_integration.py::test_token_exchange_structure_matches_sage_api SKIPPED [ 64%]
tests\test_sage_integration.py::test_get_connections_returns_real_business_structure SKIPPED [ 64%]
tests\test_sage_integration.py::test_balance_sheet_import_uses_real_sage_api_format SKIPPED [ 64%]
tests\test_sage_integration.py::test_sage_rest_api_error_handling SKIPPED [ 65%]
tests\test_sage_integration.py::test_full_sage_oauth_flow_with_real_api SKIPPED [ 65%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_factory_returns_local_storage_by_default PASSED [ 65%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_factory_returns_s3_storage_when_enabled SKIPPED [ 65%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_factory_returns_singleton PASSED [ 65%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_local_storage_implements_protocol PASSED [ 65%]
tests\test_storage_factory.py::TestStorageServiceFactory::test_s3_storage_implements_protocol SKIPPED [ 65%]
tests\test_subscription.py::TestGetOrganizationTier::test_returns_professional_tier_when_set_in_metadata PASSED [ 65%]
tests\test_subscription.py::TestGetOrganizationTier::test_returns_premium_tier_when_set_in_metadata PASSED [ 65%]
tests\test_subscription.py::TestGetOrganizationTier::test_returns_enterprise_tier_when_set_in_metadata PASSED [ 65%]
tests\test_subscription.py::TestGetOrganizationTier::test_defaults_to_starter_when_metadata_missing PASSED [ 66%]
tests\test_subscription.py::TestGetOrganizationTier::test_defaults_to_starter_when_metadata_is_none PASSED [ 66%]
tests\test_subscription.py::TestGetOrganizationTier::test_defaults_to_starter_when_tier_value_invalid PASSED [ 66%]
tests\test_subscription.py::TestGetOrganizationTier::test_raises_clerk_api_error_when_org_not_found PASSED [ 66%]
tests\test_subscription.py::TestGetOrganizationTier::test_raises_clerk_api_error_when_network_fails PASSED [ 66%]
tests\test_subscription.py::TestGetOrganizationTier::test_caches_tier_data_for_performance PASSED [ 66%]
tests\test_subscription.py::TestGetOrganizationTier::test_cache_respects_ttl PASSED [ 66%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_starter_tier_exists PASSED [ 66%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_professional_tier_exists PASSED [ 66%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_premium_tier_exists PASSED [ 66%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_enterprise_tier_exists PASSED [ 66%]
tests\test_subscription.py::TestSubscriptionTierEnum::test_tier_comparison PASSED [ 67%]
tests\test_subscription.py::TestClerkAPIError::test_clerk_api_error_message PASSED [ 67%]
tests\test_subscription.py::TestClerkAPIError::test_clerk_api_error_with_original_exception PASSED [ 67%]
tests\test_subscription_error_paths.py::test_create_checkout_session_value_error ERROR [ 67%]
tests\test_subscription_error_paths.py::test_create_checkout_session_general_exception ERROR [ 67%]
tests\test_subscription_error_paths.py::test_get_my_subscription_not_found ERROR [ 67%]
tests\test_subscription_error_paths.py::test_billing_dashboard_no_subscription ERROR [ 67%]
tests\test_subscription_error_paths.py::test_billing_dashboard_with_subscription ERROR [ 67%]
tests\test_subscription_error_paths.py::test_billing_dashboard_zero_counts ERROR [ 67%]
tests\test_subscription_error_paths.py::test_change_tier_value_error ERROR [ 67%]
tests\test_subscription_error_paths.py::test_change_tier_general_exception ERROR [ 68%]
tests\test_subscription_error_paths.py::test_cancel_subscription_value_error ERROR [ 68%]
tests\test_subscription_error_paths.py::test_cancel_subscription_general_exception ERROR [ 68%]
tests\test_subscription_error_paths.py::test_get_all_tiers_success PASSED [ 68%]
tests\test_subscription_error_paths.py::test_stripe_webhook_missing_secret PASSED [ 68%]
tests\test_subscription_error_paths.py::test_stripe_webhook_invalid_payload SKIPPED [ 68%]
tests\test_subscription_error_paths.py::test_stripe_webhook_invalid_signature SKIPPED [ 68%]
tests\test_subscription_error_paths.py::test_stripe_webhook_successful_events SKIPPED [ 68%]
tests\test_subscription_error_paths.py::test_stripe_webhook_handler_exception_caught SKIPPED [ 68%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[checkout.session.completed-handle_checkout_completed] PASSED [ 68%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[invoice.paid-handle_invoice_paid] PASSED [ 69%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[customer.subscription.updated-handle_subscription_updated] PASSED [ 69%]
tests\test_subscription_error_paths.py::test_stripe_webhook_routes_events[customer.subscription.deleted-handle_subscription_deleted] PASSED [ 69%]
tests\test_subscription_model.py::test_create_subscription ERROR         [ 69%]
tests\test_subscription_model.py::test_subscription_defaults ERROR       [ 69%]
tests\test_subscription_model.py::test_subscription_tier_enum_values FAILED [ 69%]
tests\test_subscription_model.py::test_subscription_status_transitions ERROR [ 69%]
tests\test_subscription_model.py::test_subscription_cancellation_scheduling ERROR [ 69%]
tests\test_subscription_model.py::test_subscription_trial_period ERROR   [ 69%]
tests\test_subscription_model.py::test_subscription_unique_per_organization ERROR [ 69%]
tests\test_subscription_model.py::test_subscription_relationship_to_organization ERROR [ 70%]
tests\test_subscription_model.py::test_create_invoice ERROR              [ 70%]
tests\test_subscription_model.py::test_invoice_statuses ERROR            [ 70%]
tests\test_subscription_model.py::test_invoice_relationship_to_subscription ERROR [ 70%]
tests\test_subscription_model.py::test_invoice_pdf_url_storage ERROR     [ 70%]
tests\test_subscription_model.py::test_subscription_cascade_delete_invoices ERROR [ 70%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_invalid_tier FAILED [ 70%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_missing_organization FAILED [ 70%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_none_db PASSED [ 70%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_annual_billing FAILED [ 70%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_reuses_existing_customer_id FAILED [ 70%]
tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_custom_urls FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_none_db PASSED [ 71%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_no_subscription FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_no_stripe_subscription_id FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_invalid_tier FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_without_proration FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_prorates_by_default FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_none_db PASSED [ 71%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_no_subscription FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_no_stripe_subscription_id FAILED [ 71%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_immediately FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_cancel_subscription_at_period_end FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_db PASSED [ 72%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_active_subscription FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_customer_id FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_create_billing_portal_session_success FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_handle_checkout_completed_with_no_existing_subscription FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_handle_invoice_paid_with_no_subscription FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_handle_subscription_updated_with_no_subscription FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_handle_subscription_deleted_with_no_subscription FAILED [ 72%]
tests\test_subscription_service_edge_cases.py::test_get_organization_subscription_returns_none_for_nonexistent_org FAILED [ 73%]
tests\test_subscription_service_edge_cases.py::test_tier_config_has_all_required_tiers PASSED [ 73%]
tests\test_subscription_service_edge_cases.py::test_tier_config_all_tiers_have_required_keys PASSED [ 73%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_returns_when_log_missing PASSED [ 73%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_marks_failed_when_rule_missing PASSED [ 73%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_marks_failed_when_template_missing PASSED [ 73%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_success_flow PASSED [ 73%]
tests\test_task_automation.py::test_enqueue_manual_rule_run_logs_exception_and_reraises PASSED [ 73%]
tests\test_task_crud.py::test_create_task_returns_201 ERROR              [ 73%]
tests\test_task_crud.py::test_list_tasks_scopes_to_deal ERROR            [ 73%]
tests\test_task_crud.py::test_update_task_allows_status_and_due_date_change ERROR [ 74%]
tests\test_task_crud.py::test_delete_task_returns_204 ERROR              [ 74%]
tests\test_task_crud.py::test_starter_tier_cannot_create_tasks ERROR     [ 74%]
tests\test_task_crud.py::test_cannot_access_tasks_from_other_org ERROR   [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceInitialization::test_service_initializes_with_default_settings PASSED [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceInitialization::test_service_initializes_with_custom_settings PASSED [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_from_video_success PASSED [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_at_custom_timestamp PASSED [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_raises_error_for_missing_file PASSED [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_handles_ffmpeg_failure PASSED [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceFrameExtraction::test_extract_frame_handles_ffmpeg_not_found PASSED [ 74%]
tests\test_thumbnail_service.py::TestThumbnailServiceImageProcessing::test_resize_and_compress_thumbnail PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceImageProcessing::test_resize_maintains_aspect_ratio PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceImageProcessing::test_compress_with_custom_quality PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceStorageIntegration::test_save_thumbnail_to_storage PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceStorageIntegration::test_save_thumbnail_generates_unique_key PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceStorageIntegration::test_save_thumbnail_handles_storage_error PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceEndToEnd::test_generate_thumbnail_complete_workflow PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceEndToEnd::test_generate_thumbnail_with_custom_size PASSED [ 75%]
tests\test_thumbnail_service.py::TestThumbnailServiceEndToEnd::test_generate_thumbnail_cleans_up_temp_files PASSED [ 75%]
tests\test_valuation_api.py::TestValuationApi::test_growth_user_can_create_valuation ERROR [ 75%]
tests\test_valuation_api.py::TestValuationApi::test_solo_user_gets_forbidden ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_get_valuation_returns_data ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_update_valuation ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_delete_valuation ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_cannot_access_other_org_valuation ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_add_comparable_via_api ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_add_precedent_via_api ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_create_scenario_via_api ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_creates_log ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_returns_log_id_and_persists_entry ERROR [ 76%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_allows_scenario_id ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_forbidden_for_solo ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_generate_export_rejects_foreign_scenario ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_list_exports_returns_recent_logs ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_get_export_status_reflects_updates ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_run_monte_carlo_simulation ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_run_monte_carlo_validation ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_get_scenario_summary_via_api ERROR [ 77%]
tests\test_valuation_api.py::TestValuationApi::test_get_scenario_summary_forbidden_for_solo_tier ERROR [ 77%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_create_valuation_creates_record ERROR [ 77%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_create_valuation_requires_growth_tier ERROR [ 77%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_update_valuation_modifies_record ERROR [ 78%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_delete_valuation_returns_204 ERROR [ 78%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_add_comparable_company ERROR [ 78%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_add_precedent_transaction ERROR [ 78%]
tests\test_valuation_crud.py::TestValuationCrudApi::test_create_scenario_requires_growth_tier ERROR [ 78%]
tests\test_valuation_crud.py::TestValuationAccessControl::test_cannot_access_other_org_deal ERROR [ 78%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_create_valuation_calculates_metrics FAILED [ 78%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_update_valuation_recalculates FAILED [ 78%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_add_comparable_records FAILED [ 78%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_add_precedent_records FAILED [ 78%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_create_scenario_persists FAILED [ 79%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_generate_export_log_entry FAILED [ 79%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_delete_valuation_cascades FAILED [ 79%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_calculate_comparable_multiples FAILED [ 79%]
tests\test_valuation_crud.py::TestValuationServiceOps::test_calculate_precedent_multiples FAILED [ 79%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_pdf_creates_file ERROR [ 79%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_excel_creates_file ERROR [ 79%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_updates_export_log ERROR [ 79%]
tests\test_valuation_export_service.py::TestValuationExportService::test_export_includes_valuation_data ERROR [ 79%]
tests\test_valuation_service.py::TestDiscountedCashFlowCalculations::test_calculate_present_value_of_cash_flows PASSED [ 79%]
tests\test_valuation_service.py::TestTerminalValue::test_gordon_growth_terminal_value PASSED [ 80%]
tests\test_valuation_service.py::TestSensitivityMatrix::test_generate_sensitivity_matrix_dimensions_and_monotonicity PASSED [ 80%]
tests\test_valuation_service.py::TestExitMultipleTerminalValue::test_calculate_terminal_value_exit_multiple PASSED [ 80%]
tests\test_valuation_service.py::TestFullDCFValuation::test_complete_dcf_enterprise_value PASSED [ 80%]
tests\test_valuation_service.py::TestFullDCFValuation::test_dcf_with_zero_cash_flows PASSED [ 80%]
tests\test_valuation_service.py::TestFullDCFValuation::test_dcf_with_negative_cash_flows PASSED [ 80%]
tests\test_valuation_service.py::TestEdgeCasesAndValidation::test_discount_rate_must_be_positive PASSED [ 80%]
tests\test_valuation_service.py::TestEdgeCasesAndValidation::test_discount_rate_must_exceed_growth_rate PASSED [ 80%]
tests\test_valuation_service.py::TestEdgeCasesAndValidation::test_equal_discount_and_growth_rates_invalid PASSED [ 80%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_comparable_analysis_excludes_outliers_and_weighs_results ERROR [ 80%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_precedent_analysis_flags_stale_transactions ERROR [ 81%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_generate_tornado_chart_orders_by_impact PASSED [ 81%]
tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_run_monte_carlo_simulation_returns_deterministic_summary PASSED [ 81%]
tests\test_valuation_service.py::TestScenarioAnalytics::test_calculate_scenario_summary_returns_expected_stats ERROR [ 81%]
tests\test_valuation_service.py::TestScenarioAnalytics::test_generate_tornado_chart_orders_by_impact PASSED [ 81%]
tests\test_valuation_service.py::TestScenarioAnalytics::test_run_monte_carlo_simulation_returns_deterministic_summary PASSED [ 81%]
tests\test_valuation_service.py::TestExportLogging::test_log_export_creates_audit_record ERROR [ 81%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_calculate_enterprise_value_exit_multiple_path PASSED [ 81%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_calculate_enterprise_value_exit_multiple_requires_multiple PASSED [ 81%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_update_valuation_recalculates_metrics ERROR [ 81%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_delete_valuation_removes_related_records ERROR [ 81%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_calculate_precedent_multiples_handles_no_records ERROR [ 82%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_list_helpers_return_entries ERROR [ 82%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_trigger_export_task_returns_payload PASSED [ 82%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_persists_document_reference FAILED [ 82%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_rejects_foreign_document FAILED [ 82%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_accepts_valid_scenario FAILED [ 82%]
tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_rejects_scenario_from_other_valuation FAILED [ 82%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_calculate_go_to_market_kpis_matches_reference_spreadsheet PASSED [ 82%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_calculate_go_to_market_kpis_handles_zero_inputs PASSED [ 82%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_ensure_test_reference_entities_noop_when_not_test FAILED [ 82%]
tests\test_valuation_service.py::TestGoToMarketKpis::test_ensure_test_reference_entities_creates_placeholders FAILED [ 83%]
tests\test_xero_integration.py::test_xero_python_sdk_can_be_imported SKIPPED [ 83%]
tests\test_xero_integration.py::test_real_xero_client_class_exists SKIPPED [ 83%]
tests\test_xero_integration.py::test_xero_oauth_url_uses_real_credentials SKIPPED [ 83%]
tests\test_xero_integration.py::test_full_xero_oauth_flow_with_real_api SKIPPED [ 83%]
tests\test_xero_integration.py::test_xero_client_has_real_configuration SKIPPED [ 83%]
tests\test_xero_integration.py::test_token_exchange_structure_matches_xero_api SKIPPED [ 83%]
tests\test_xero_integration.py::test_get_connections_returns_real_tenant_structure SKIPPED [ 83%]
tests\test_xero_integration.py::test_balance_sheet_import_uses_real_xero_api_format SKIPPED [ 83%]
tests\test_xero_integration.py::test_xero_sdk_error_handling SKIPPED     [ 83%]
tests\test_xero_oauth_service.py::test_initiate_xero_oauth_generates_authorization_url FAILED [ 84%]
tests\test_xero_oauth_service.py::test_initiate_xero_oauth_with_invalid_deal FAILED [ 84%]
tests\test_xero_oauth_service.py::test_handle_xero_callback_success FAILED [ 84%]
tests\test_xero_oauth_service.py::test_handle_xero_callback_token_exchange_failure FAILED [ 84%]
tests\test_xero_oauth_service.py::test_refresh_xero_token_success FAILED [ 84%]
tests\test_xero_oauth_service.py::test_refresh_xero_token_when_refresh_fails FAILED [ 84%]
tests\test_xero_oauth_service.py::test_fetch_xero_statements_imports_balance_sheet FAILED [ 84%]
tests\test_xero_oauth_service.py::test_fetch_xero_statements_with_expired_token FAILED [ 84%]
tests\test_xero_oauth_service.py::test_disconnect_xero_removes_connection FAILED [ 84%]
tests\test_xero_oauth_service.py::test_get_xero_connection_status_active FAILED [ 84%]
tests\test_xero_oauth_service.py::test_get_xero_connection_status_not_connected FAILED [ 85%]
tests\test_youtube_service.py::test_upload_video_allowed_for_premium PASSED [ 85%]
tests\test_youtube_service.py::test_upload_video_rejected_for_professional PASSED [ 85%]
tests\test_youtube_service.py::test_upload_video_requires_file_path PASSED [ 85%]
tests\api\test_blog.py::test_list_blog_posts_default ERROR               [ 85%]
tests\api\test_blog.py::test_list_blog_posts_with_category_filter ERROR  [ 85%]
tests\api\test_blog.py::test_list_blog_posts_with_search ERROR           [ 85%]
tests\api\test_blog.py::test_list_blog_posts_include_unpublished ERROR   [ 85%]
tests\api\test_blog.py::test_list_blog_posts_with_pagination ERROR       [ 85%]
tests\api\test_blog.py::test_list_blog_posts_empty_result ERROR          [ 85%]
tests\api\test_blog.py::test_get_blog_post_by_slug_success ERROR         [ 85%]
tests\api\test_blog.py::test_get_blog_post_by_slug_not_found ERROR       [ 86%]
tests\api\test_blog.py::test_get_unpublished_post_by_slug ERROR          [ 86%]
tests\api\test_blog.py::test_list_blog_categories ERROR                  [ 86%]
tests\api\test_blog.py::test_list_blog_categories_empty_database FAILED  [ 86%]
tests\api\test_blog.py::test_list_blog_posts_with_invalid_limit ERROR    [ 86%]
tests\api\test_blog.py::test_list_blog_posts_with_invalid_offset ERROR   [ 86%]
tests\api\test_blog.py::test_blog_post_response_schema ERROR             [ 86%]
tests\api\test_blog.py::test_blog_search_case_insensitive ERROR          [ 86%]
tests\api\test_blog.py::test_blog_list_ordering ERROR                    [ 86%]
tests\api\test_blog_api.py::test_list_blog_posts_returns_200 FAILED      [ 86%]
tests\api\test_blog_api.py::test_list_blog_posts_with_data FAILED        [ 87%]
tests\api\test_blog_api.py::test_list_blog_posts_category_filter FAILED  [ 87%]
tests\api\test_blog_api.py::test_list_blog_posts_search FAILED           [ 87%]
tests\api\test_blog_api.py::test_list_blog_posts_pagination FAILED       [ 87%]
tests\api\test_blog_api.py::test_list_blog_posts_published_only FAILED   [ 87%]
tests\api\test_document_sharing.py::test_create_share_link_for_document ERROR [ 87%]
tests\api\test_document_sharing.py::test_create_share_link_with_password ERROR [ 87%]
tests\api\test_document_sharing.py::test_access_shared_document_valid_link ERROR [ 87%]
tests\api\test_document_sharing.py::test_access_shared_document_expired_link ERROR [ 87%]
tests\api\test_document_sharing.py::test_access_shared_document_with_password ERROR [ 87%]
tests\api\test_document_sharing.py::test_list_active_share_links_for_document ERROR [ 88%]
tests\api\test_document_sharing.py::test_revoke_share_link ERROR         [ 88%]
tests\api\test_document_sharing.py::test_track_share_link_access_count ERROR [ 88%]
tests\api\test_event_api.py::test_create_event_returns_201 ERROR         [ 88%]
tests\api\test_event_api.py::test_create_event_wrong_organization_returns_403 ERROR [ 88%]
tests\api\test_event_api.py::test_list_events_returns_200 ERROR          [ 88%]
tests\api\test_event_api.py::test_list_events_with_status_filter ERROR   [ 88%]
tests\api\test_event_api.py::test_get_event_returns_200 ERROR            [ 88%]
tests\api\test_event_api.py::test_get_event_not_found_returns_404 ERROR  [ 88%]
tests\api\test_event_api.py::test_update_event_returns_200 ERROR         [ 88%]
tests\api\test_event_api.py::test_delete_event_returns_204 ERROR         [ 88%]
tests\api\test_event_api.py::test_create_event_session_returns_201 ERROR [ 89%]
tests\api\test_event_api.py::test_list_event_sessions_returns_200 ERROR  [ 89%]
tests\api\test_event_api.py::test_update_event_session_returns_200 ERROR [ 89%]
tests\api\test_event_api.py::test_delete_event_session_returns_204 ERROR [ 89%]
tests\api\test_event_api.py::test_create_event_ticket_returns_201 ERROR  [ 89%]
tests\api\test_event_api.py::test_list_event_tickets_returns_200 ERROR   [ 89%]
tests\api\test_event_api.py::test_update_event_ticket_returns_200 ERROR  [ 89%]
tests\api\test_event_api.py::test_delete_event_ticket_returns_204 ERROR  [ 89%]
tests\api\test_event_api.py::test_create_event_registration_returns_201 ERROR [ 89%]
tests\api\test_event_api.py::test_list_event_registrations_returns_200 ERROR [ 89%]
tests\api\test_event_api.py::test_update_event_registration_returns_200 ERROR [ 90%]
tests\api\test_event_api.py::test_delete_event_registration_returns_204 ERROR [ 90%]
tests\api\test_event_api.py::test_get_event_analytics_returns_200 ERROR  [ 90%]
tests\api\test_event_api.py::test_export_registrations_csv_returns_200 ERROR [ 90%]
tests\api\test_event_api.py::test_export_registrations_empty_event_returns_200 ERROR [ 90%]
tests\api\test_event_api.py::test_list_events_requires_authentication ERROR [ 90%]
tests\api\test_event_api.py::test_create_event_requires_authentication ERROR [ 90%]
tests\api\test_marketing.py::test_submit_contact_form_success FAILED     [ 90%]
tests\api\test_marketing.py::test_submit_contact_form_validation_error PASSED [ 90%]
tests\api\test_marketing.py::test_subscribe_newsletter_success FAILED    [ 90%]
tests\api\test_marketing.py::test_subscribe_newsletter_is_idempotent FAILED [ 91%]
tests\master_admin\test_models.py::TestAdminGoal::test_create_admin_goal ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_unique_constraint ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_repr ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_default_targets ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminActivity::test_create_admin_activity ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_types ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_statuses ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_default_amount ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_repr ERROR [ 91%]
tests\master_admin\test_models.py::TestAdminScore::test_create_admin_score ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_unique_constraint ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_valid_range ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_default_values ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminScore::test_admin_score_repr ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_create_focus_session ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_complete_focus_session ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_focus_session_default_duration ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminFocusSession::test_focus_session_repr ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminNudge::test_create_nudge ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_types ERROR [ 92%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_priorities ERROR [ 93%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_default_priority ERROR [ 93%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_read_status ERROR [ 93%]
tests\master_admin\test_models.py::TestAdminNudge::test_nudge_repr ERROR [ 93%]
tests\master_admin\test_models.py::TestAdminMeeting::test_create_meeting ERROR [ 93%]
tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_types ERROR [ 93%]
tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_default_duration ERROR [ 93%]
tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_repr ERROR [ 93%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_create_valid PASSED [ 93%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_create_defaults PASSED [ 93%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_create_negative_targets PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_update_partial PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminGoalSchemas::test_goal_response_from_dict PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_valid PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_type_alias PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_default_amount PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_create_invalid_amount PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_update_partial PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminActivitySchemas::test_activity_response_serialization PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_create_valid PASSED [ 94%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_create_boundaries PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_create_defaults PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminScoreSchemas::test_score_update_partial PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_create_valid PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_create_default_duration PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_create_invalid_duration PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_update_completion PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminFocusSessionSchemas::test_focus_session_response PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_valid PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_type_alias PASSED [ 95%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_default_priority PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_create_empty_message PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_update_read_status PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminNudgeSchemas::test_nudge_response_expiration PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_valid PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_type_alias PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_default_duration PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_invalid_title PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_create_long_title PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_update_partial PASSED [ 96%]
tests\master_admin\test_schemas.py::TestAdminMeetingSchemas::test_meeting_response PASSED [ 96%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_date_field_validation PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_datetime_field_validation PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_enum_validation PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_optional_fields_as_none PASSED [ 97%]
tests\master_admin\test_schemas.py::TestSchemaValidationEdgeCases::test_model_config_from_attributes PASSED [ 97%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_role_change_creates_audit_entry FAILED [ 97%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_role_change_captures_before_after_values FAILED [ 97%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_user_deleted FAILED [ 97%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_user_restored FAILED [ 97%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_rejects_invalid_action FAILED [ 97%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_claim_mismatch_sanitizes_claims FAILED [ 98%]
tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_claim_mismatch_logs_org_and_user_ids FAILED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_require_min_role_admin_always_passes FAILED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_require_min_role_hierarchy_validation FAILED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_enforce_claim_integrity_creates_missing_org SKIPPED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_enforce_claim_integrity_logs_mismatch SKIPPED [ 98%]
tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_get_current_user_rejects_missing_clerk_id SKIPPED [ 98%]
tests\services\test_rbac_permissions.py::TestPermissionHierarchy::test_role_level_function_returns_correct_values PASSED [ 98%]
tests\services\test_rbac_permissions.py::TestPermissionHierarchy::test_admin_override_bypasses_exact_role_requirement FAILED [ 98%]
tests\services\test_rbac_permissions.py::TestPermissionHierarchy::test_feature_access_respects_subscription_tier SKIPPED [ 98%]
tests\test_migrations\test_user_foreign_keys.py::TestUserForeignKeyTypes::test_users_id_column_is_string_type PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestUserForeignKeyTypes::test_all_user_foreign_key_columns_match_users_id_type PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestUserForeignKeyTypes::test_foreign_key_constraints_exist PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_folder_rejects_invalid_created_by ERROR [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_document_rejects_invalid_uploaded_by ERROR [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_document_permission_rejects_invalid_user_id ERROR [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_valid_user_references_succeed ERROR [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestModelSchemAlignment::test_folder_model_matches_database_schema PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestModelSchemAlignment::test_document_model_matches_database_schema PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestModelSchemAlignment::test_all_user_fk_columns_are_nullable_correct PASSED [ 99%]
tests\test_migrations\test_user_foreign_keys.py::TestMigrationRollback::test_downgrade_path_exists PASSED [100%]

=================================== ERRORS ====================================
_________ ERROR at setup of test_create_checkout_session_invalid_tier _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAEF490>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_get_subscription_not_found ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECDAF50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of test_cancel_subscription_requires_active_subscription ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F203850>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_customer_portal_redirect _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8AEB90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ ERROR at setup of test_create_post ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA7DA50>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_get_post_by_id ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D6DDBD0>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_get_post_by_id_wrong_org _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8AF8D0>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ ERROR at setup of test_update_post ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F251DD0>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_update_post_unauthorized _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E98A190>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ ERROR at setup of test_delete_post ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD62610>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_delete_post_unauthorized _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D72C610>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ ERROR at setup of test_list_posts ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E906490>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_list_posts_filter_by_category _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBEF390>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ ERROR at setup of test_list_posts_search ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E863C90>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_create_comment ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECA1590>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_create_comment_on_nonexistent_post __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBCD410>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_create_nested_comment _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDDBCD0>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_delete_comment ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECD9950>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_delete_comment_unauthorized ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F1A1090>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_get_comments_for_post _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F1A3CD0>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ ERROR at setup of test_add_reaction _____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECA3B10>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_add_reaction_duplicate ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7115D0>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ ERROR at setup of test_remove_reaction ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70707750>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_get_reactions _____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F279450>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ ERROR at setup of test_follow_user ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F720750>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ ERROR at setup of test_follow_user_self ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70D4E310>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_follow_user_duplicate _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB3B150>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_unfollow_user _____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F628D50>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ ERROR at setup of test_get_follow_stats ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA41710>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_moderate_content_flag _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E7F0910>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_moderate_content_delete ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E800610>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ ERROR at setup of test_get_flagged_content __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB69110>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_get_community_analytics ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBE1C10>

    @pytest.fixture
    def test_org_user(db_session):
        """Create a test user with organization."""
>       user = User(
            id=str(uuid.uuid4()),
            clerk_user_id=f"clerk_{uuid.uuid4()}",
            email="test@example.com",
            first_name="Test",
            last_name="User",
            role=UserRole.growth,
            organization_id=str(uuid.uuid4()),
        )

tests\test_community_service.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingCriteriaAPI.test_create_criteria_success __

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA60040>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingCriteriaAPI.test_create_criteria_requires_auth _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA2A3E0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestDealMatchingCriteriaAPI.test_list_criteria _______

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E938AE0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestDealMatchingAPI.test_find_matches_for_deal _______

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA2A020>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestDealMatchingAPI.test_find_matches_requires_auth ____

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B7F60>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestDealMatchingAPI.test_list_matches_for_deal _______

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E938860>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestDealMatchingAPI.test_list_matches_requires_auth ____

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9F3380>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestDealMatchingAPI.test_list_matches_deal_not_found ____

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA2BC40>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestDealMatchingAPI.test_find_matches_deal_not_found ____

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E88AE80>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestDealMatchActionsAPI.test_record_match_action_view ___

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84D9E0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestDealMatchActionsAPI.test_record_match_action_save ___

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B5F80>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestDealMatchActionsAPI.test_record_match_action_pass ___

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA6C900>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchActionsAPI.test_record_match_action_request_intro _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93A5C0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchActionsAPI.test_record_match_action_requires_auth _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84FC40>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchActionsAPI.test_record_match_action_match_not_found _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93BEC0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingIntegration.test_create_criteria_and_find_matches_workflow _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA6E660>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchCriteriaModel.test_create_deal_match_criteria_with_required_fields _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E889D00>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchCriteriaModel.test_create_criteria_with_optional_fields _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA6EC00>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchCriteriaModel.test_criteria_enforces_organization_isolation _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93A520>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of TestDealMatchModel.test_create_deal_match _________

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E88B100>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestDealMatchModel.test_match_score_validation _______

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97E7A0>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestDealMatchModel.test_match_status_tracking _______

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B5260>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestDealMatchActionModel.test_create_match_action _____

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84DB20>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchActionModel.test_track_multiple_actions_on_match _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F5120>

    @pytest.fixture
    def match_org(create_organization):
        """Create organization for matching tests."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\test_deal_matching_models.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_calculate_industry_match_exact _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9F3EC0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_calculate_industry_match_partial _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA2A2A0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_calculate_industry_match_none _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E88BCE0>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_calculate_size_match_within_range _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93BC40>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_calculate_size_match_outside_range _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84C220>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_calculate_geography_match_exact _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E88BE20>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_calculate_geography_match_none _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F6200>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestDealMatchingService.test_calculate_weighted_score ___

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E88BE20>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_find_matches_returns_ranked_results _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F266E80>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_find_matches_filters_low_scores _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F7A60>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestDealMatchingService.test_match_result_contains_explanation _

create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E88A020>

    @pytest.fixture()
    def match_org(create_organization):
        """Create organization for matching tests (professional tier for DEV-018)."""
>       return create_organization(name="Match Test Org", subscription_tier="professional")

tests\conftest.py:644: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_create_folder_success _________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E938860>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93A660>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_upload_document_success ________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E9B7A60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B4860>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_upload_document_rejects_large_files __________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84FB00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84F420>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_list_documents_filters_by_folder ___________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FB600>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8FAA20>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_download_document_records_access_log _________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84E0C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84F380>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_set_document_permission ________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E8F94E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8FBCE0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_list_folders_lazy_loading _______________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84D1C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84E700>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_list_folders_supports_search _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F4860>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F5A80>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ ERROR at setup of test_create_nested_folder _________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84F7E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B4A40>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_rename_folder _____________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E93A2A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93B880>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ ERROR at setup of test_delete_empty_folder __________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6ECC68E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97C2C0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_delete_non_empty_folder_fails _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6F193BA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F193A60>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_folder_requires_authentication ____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F4900>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F44A0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_folder_organization_isolation _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E9F3EC0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B7F60>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_upload_multiple_documents _______________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84E020>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84D080>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_upload_unsupported_file_type _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6AC70540>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC70B80>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_upload_creates_audit_log _______________

create_user = <function create_user.<locals>._create_user at 0x000002DF6EAE9DA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84FB00>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_search_documents_by_filename _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F42C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F4720>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_filter_documents_by_file_type _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84D620>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84D9E0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_upload_same_name_creates_new_version _________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F72E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F6520>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_list_document_versions ________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84C680>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84E5C0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_download_specific_version _______________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F4E00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F6340>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_restore_previous_version _______________

create_user = <function create_user.<locals>._create_user at 0x000002DF6AC72980>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC72AC0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_max_versions_enforced _________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F5760>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F5F80>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_delete_document_archives_all_versions _________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E93A520>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8FB2E0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_viewer_cannot_delete_document _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84DA80>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84EAC0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_viewer_can_download_document _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FA5C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8F96C0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of test_editor_can_upload_with_folder_permission _______

create_user = <function create_user.<locals>._create_user at 0x000002DF6AC73F60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFC80E0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of test_granting_folder_permission_creates_audit_log _____

create_user = <function create_user.<locals>._create_user at 0x000002DF6E9B7F60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B4860>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of test_revoking_folder_permission_creates_audit_log _____

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F5BC0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F5E40>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of test_revoking_document_permission_creates_audit_log ____

create_user = <function create_user.<locals>._create_user at 0x000002DF4AFC8400>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFC8EA0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_editor_cannot_delete_others_document _________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F6020>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F4860>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_editor_can_delete_own_document ____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6AC70540>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC72020>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of test_delete_document_requires_editor_permission ______

create_user = <function create_user.<locals>._create_user at 0x000002DF6E8F9800>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8F9DA0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_delete_document_records_audit_log ___________

create_user = <function create_user.<locals>._create_user at 0x000002DF6AC72C00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC73100>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_access_logs_include_user_name _____________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F4680>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F63E0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_bulk_download_documents ________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E84EA20>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84DB20>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_bulk_download_requires_permission ___________

create_user = <function create_user.<locals>._create_user at 0x000002DF4AFCAB60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFCACA0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_bulk_delete_documents _________________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F6D40>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F5E40>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_bulk_delete_requires_owner_permission _________

create_user = <function create_user.<locals>._create_user at 0x000002DF6AC73240>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC734C0>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_bulk_delete_partial_failure ______________

create_user = <function create_user.<locals>._create_user at 0x000002DF4AFC82C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFCB420>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_document_question_workflow ______________

create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FA5C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8F9800>

    @pytest.fixture()
    def auth_context(create_user, create_organization):
        """Provision a user + org, returning auth headers, cleanup callback, and org id."""
>       org = create_organization(name="Doc Org")

tests\test_document_endpoints.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_create_document_template _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC3D890>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ ERROR at setup of test_template_status_enum _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC51CD0>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_template_version_tracking _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8C7A90>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_template_repr _____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC7C0D0>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_create_generated_document _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7047E790>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_generated_document_status_enum ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA75250>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_generated_document_timestamps _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E87C650>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_generated_document_file_path _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E87EC90>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_template_document_relationship ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB11E10>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_template_variables_json_field _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC7FB90>

    @pytest.fixture
    def test_organization(db_session: Session):
        """Create a test organization for document generation tests"""
        from app.models.organization import Organization
    
>       org = Organization(
            id="doc-test-org-123",
            name="Document Test Organization",
            slug="doc-test-org",
        )

tests\test_document_generation_models.py:22: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of TestEventModel.test_create_event ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705FE490>

    @pytest.fixture
    def sample_organization(db_session):
        """Create a sample organization for testing"""
>       org = Organization(
            id=str(uuid4()),
            name="Test Organization",
            slug="test-org",
        )

tests\test_event_models.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestEventModel.test_event_requires_organization ______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70054610>

    @pytest.fixture
    def sample_organization(db_session):
        """Create a sample organization for testing"""
>       org = Organization(
            id=str(uuid4()),
            name="Test Organization",
            slug="test-org",
        )

tests\test_event_models.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of TestEventModel.test_event_location_types __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF703DA610>

    @pytest.fixture
    def sample_organization(db_session):
        """Create a sample organization for testing"""
>       org = Organization(
            id=str(uuid4()),
            name="Test Organization",
            slug="test-org",
        )

tests\test_event_models.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestEventTicketModel.test_create_event_ticket _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF703D8710>

    @pytest.fixture
    def sample_organization(db_session):
        """Create a sample organization for testing"""
>       org = Organization(
            id=str(uuid4()),
            name="Test Organization",
            slug="test-org",
        )

tests\test_event_models.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestEventRegistrationModel.test_create_registration ____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705917D0>

    @pytest.fixture
    def sample_organization(db_session):
        """Create a sample organization for testing"""
>       org = Organization(
            id=str(uuid4()),
            name="Test Organization",
            slug="test-org",
        )

tests\test_event_models.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestEventSessionModel.test_create_event_session ______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705E3510>

    @pytest.fixture
    def sample_organization(db_session):
        """Create a sample organization for testing"""
>       org = Organization(
            id=str(uuid4()),
            name="Test Organization",
            slug="test-org",
        )

tests\test_event_models.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestEventAnalyticsModel.test_create_event_analytics ____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F974350>

    @pytest.fixture
    def sample_organization(db_session):
        """Create a sample organization for testing"""
>       org = Organization(
            id=str(uuid4()),
            name="Test Organization",
            slug="test-org",
        )

tests\test_event_models.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of TestEventService.test_create_event _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC7F750>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of TestEventService.test_get_event ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAED750>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestEventService.test_get_event_wrong_organization _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70AF8A50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestEventService.test_list_events_pagination ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FE410>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of TestEventService.test_update_event _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E819190>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestEventService.test_delete_event_soft_delete _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA22E10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of TestEventTicketService.test_create_ticket _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F4BC150>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestEventTicketService.test_create_ticket_invalid_event __

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E7E00D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestEventRegistrationService.test_create_registration ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A5ABD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestEventRegistrationService.test_create_registration_with_ticket _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC51610>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestEventRegistrationService.test_create_registration_sold_out_ticket _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DA0810>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestEventRegistrationService.test_cancel_registration_updates_ticket _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FA5D850>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestEventAnalyticsService.test_get_event_analytics _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E81AD90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestEventAnalyticsService.test_analytics_with_sessions ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ABA250>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_calculate_financial_ratios_endpoint __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70057490>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of test_calculate_ratios_requires_authentication _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70D4EA10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_calculate_ratios_deal_not_found ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E9BFCD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_calculate_ratios_with_partial_data __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705FCA50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of test_get_financial_connections_endpoint_returns_empty_list_when_no_connections _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDCCA50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of test_get_financial_connections_endpoint_returns_connections _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70248CD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_get_financial_ratios_not_found ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9699D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_get_financial_narrative_not_found ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A2B210>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_connect_xero_initiates_oauth_flow ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD54A50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_connect_xero_with_invalid_deal ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB43110>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_xero_oauth_callback_success ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDF8A10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_xero_oauth_callback_missing_code ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E7FFC10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_sync_financial_data_success ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8AE450>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_sync_financial_data_no_connection ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E813210>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of test_connect_quickbooks_initiates_oauth_flow ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E98A090>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_connect_quickbooks_with_invalid_deal _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70070B50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_quickbooks_oauth_callback_success ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBF2050>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of test_quickbooks_oauth_callback_missing_params _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8BB050>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_sync_quickbooks_financial_data_success ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70057490>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of test_sync_quickbooks_financial_data_no_connection _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DA6E90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_quickbooks_connection_status _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ABA250>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_disconnect_quickbooks_connection ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705C2590>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_connect_netsuite_initiates_oauth_flow _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9A5ED0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_connect_netsuite_with_invalid_deal __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F344050>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_netsuite_oauth_callback_success ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD7F490>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_sync_netsuite_financial_data_success _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB055D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of test_sync_netsuite_financial_data_no_connection ______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBE4210>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_connect_sage_initiates_oauth_flow ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7077D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_connect_sage_with_invalid_deal ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FEE50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_sage_oauth_callback_success ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA04FD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_sync_sage_financial_data_success ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6AFE19D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_sync_sage_financial_data_no_connection ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA27150>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_get_readiness_score_success ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F713990>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_get_readiness_score_no_narrative ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDD2D50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_goal_crud_flow ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8022D0>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_activity_crud_and_listing _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70576710>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_scores_and_dashboard_stats ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8FF090>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ ERROR at setup of test_focus_session_flow __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F268890>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ ERROR at setup of test_nudge_management ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD05D50>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_meeting_template_management ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E7F1650>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ ERROR at setup of test_prospect_crud_flow __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF700D0890>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ ERROR at setup of test_deal_pipeline_flow __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF4AF28B10>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_campaign_and_recipient_management ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F269150>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_content_script_and_piece_flow _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A44A50>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ ERROR at setup of test_lead_capture_flow ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70AFE610>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_collateral_library_flow ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF708125D0>

    @pytest.fixture()
    def admin_user(db_session):
        """Create and return a test admin user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-admin",
            name="Admin Test Org",
            slug="admin-test-org",
            subscription_tier="enterprise"
        )

tests\conftest.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of TestAdminGoalModel.test_create_admin_goal _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB79AD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestAdminGoalModel.test_admin_goal_unique_constraint ____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70585E10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestAdminGoalModel.test_admin_goal_defaults ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA75890>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of TestAdminGoalModel.test_admin_goal_repr __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705FCFD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestAdminActivityModel.test_create_admin_activity _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF700FAA50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestAdminActivityModel.test_admin_activity_default_amount _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D209BD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestAdminActivityModel.test_admin_activity_with_prospect __

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9AC190>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestAdminScoreModel.test_create_admin_score ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB600D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestAdminScoreModel.test_admin_score_range_constraint ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECF0450>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestAdminScoreModel.test_admin_score_unique_constraint ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB73D50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestAdminScoreModel.test_admin_score_defaults _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8D9B10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestAdminFocusSessionModel.test_create_focus_session ____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F711310>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestAdminFocusSessionModel.test_complete_focus_session ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC7E450>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestAdminFocusSessionModel.test_interrupted_focus_session _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB7A410>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of TestAdminNudgeModel.test_create_nudge ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ADF550>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestAdminNudgeModel.test_mark_nudge_as_read ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DA4B50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestAdminMeetingModel.test_create_meeting_template _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDD2F10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestAdminMeetingModel.test_meeting_default_duration ____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E810810>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_create_and_list_pipeline_templates __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70586D90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_update_pipeline_template _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F2684D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_delete_pipeline_template _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC99DD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_get_current_admin_user_with_admin ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70517D50>

    @pytest.fixture
    def admin_user(db_session: Session) -> User:
        """Create an admin user."""
>       user = User(
            clerk_user_id="user_admin123",
            email="admin@example.com",
            role=UserRole.admin,
        )

tests\test_rbac.py:57: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_get_current_admin_user_with_non_admin _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70619F50>

    @pytest.fixture
    def solo_user(db_session: Session) -> User:
        """Create a solo tier user."""
>       user = User(
            clerk_user_id="user_solo123",
            email="solo@example.com",
            role=UserRole.solo,
        )

tests\test_rbac.py:15: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_require_role_exact_match _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9D8E50>

    @pytest.fixture
    def growth_user(db_session: Session) -> User:
        """Create a growth tier user."""
>       user = User(
            clerk_user_id="user_growth123",
            email="growth@example.com",
            role=UserRole.growth,
        )

tests\test_rbac.py:29: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_require_role_no_match _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705E2810>

    @pytest.fixture
    def solo_user(db_session: Session) -> User:
        """Create a solo tier user."""
>       user = User(
            clerk_user_id="user_solo123",
            email="solo@example.com",
            role=UserRole.solo,
        )

tests\test_rbac.py:15: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_require_role_admin_override ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70D78610>

    @pytest.fixture
    def admin_user(db_session: Session) -> User:
        """Create an admin user."""
>       user = User(
            clerk_user_id="user_admin123",
            email="admin@example.com",
            role=UserRole.admin,
        )

tests\test_rbac.py:57: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_require_min_role_exact_match _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70305350>

    @pytest.fixture
    def growth_user(db_session: Session) -> User:
        """Create a growth tier user."""
>       user = User(
            clerk_user_id="user_growth123",
            email="growth@example.com",
            role=UserRole.growth,
        )

tests\test_rbac.py:29: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_require_min_role_higher_role _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F3469D0>

    @pytest.fixture
    def enterprise_user(db_session: Session) -> User:
        """Create an enterprise tier user."""
>       user = User(
            clerk_user_id="user_enterprise123",
            email="enterprise@example.com",
            role=UserRole.enterprise,
        )

tests\test_rbac.py:43: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_require_min_role_lower_role ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D35AD10>

    @pytest.fixture
    def solo_user(db_session: Session) -> User:
        """Create a solo tier user."""
>       user = User(
            clerk_user_id="user_solo123",
            email="solo@example.com",
            role=UserRole.solo,
        )

tests\test_rbac.py:15: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_require_min_role_admin_override ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBF1250>

    @pytest.fixture
    def admin_user(db_session: Session) -> User:
        """Create an admin user."""
>       user = User(
            clerk_user_id="user_admin123",
            email="admin@example.com",
            role=UserRole.admin,
        )

tests\test_rbac.py:57: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_create_checkout_session_value_error __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7071B6D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of test_create_checkout_session_general_exception _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70AB95D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_get_my_subscription_not_found _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FCA50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_billing_dashboard_no_subscription ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF72EB1B50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_billing_dashboard_with_subscription __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707C7A10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_billing_dashboard_zero_counts _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70D3F490>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_change_tier_value_error ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70AF9F10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_change_tier_general_exception _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE912D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_cancel_subscription_value_error ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF700273D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_cancel_subscription_general_exception _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DD8B50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ ERROR at setup of test_create_subscription __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D2882D0>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_subscription_defaults _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC41E50>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_subscription_status_transitions ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAC8E10>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_subscription_cancellation_scheduling _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D3675D0>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_subscription_trial_period _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7006F5D0>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_subscription_unique_per_organization _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAF7810>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of test_subscription_relationship_to_organization _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBE2250>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ ERROR at setup of test_create_invoice ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E819E10>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ ERROR at setup of test_invoice_statuses ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D7F7E90>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_invoice_relationship_to_subscription _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FA2F610>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_invoice_pdf_url_storage ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7006ED50>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_subscription_cascade_delete_invoices _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8F5CD0>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_create_task_returns_201 ________________

create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF4AFCBD80>

    @pytest.fixture()
    def deal_context(create_deal_for_org):
>       deal, owner, org = create_deal_for_org()

tests\test_task_crud.py:16: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_list_tasks_scopes_to_deal _______________

create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70DAC040>

    @pytest.fixture()
    def deal_context(create_deal_for_org):
>       deal, owner, org = create_deal_for_org()

tests\test_task_crud.py:16: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of test_update_task_allows_status_and_due_date_change _____

create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70775E40>

    @pytest.fixture()
    def deal_context(create_deal_for_org):
>       deal, owner, org = create_deal_for_org()

tests\test_task_crud.py:16: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_delete_task_returns_204 ________________

create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70D5BB00>

    @pytest.fixture()
    def deal_context(create_deal_for_org):
>       deal, owner, org = create_deal_for_org()

tests\test_task_crud.py:16: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_starter_tier_cannot_create_tasks ___________

create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70D599E0>

    @pytest.fixture()
    def deal_context(create_deal_for_org):
>       deal, owner, org = create_deal_for_org()

tests\test_task_crud.py:16: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_cannot_access_tasks_from_other_org __________

create_user = <function create_user.<locals>._create_user at 0x000002DF70D14400>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D144A0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70657010>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestValuationApi.test_growth_user_can_create_valuation ___

create_user = <function create_user.<locals>._create_user at 0x000002DF6FA8A980>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA8B100>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB706D0>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestValuationApi.test_solo_user_gets_forbidden _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF700D3290>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestValuationApi.test_get_valuation_returns_data ______

create_user = <function create_user.<locals>._create_user at 0x000002DF70D02980>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D01080>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE5E410>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of TestValuationApi.test_update_valuation ___________

create_user = <function create_user.<locals>._create_user at 0x000002DF70D07740>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D06DE0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F957490>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of TestValuationApi.test_delete_valuation ___________

create_user = <function create_user.<locals>._create_user at 0x000002DF6FA9B740>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA9B060>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FED1A50>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestValuationApi.test_cannot_access_other_org_valuation __

create_user = <function create_user.<locals>._create_user at 0x000002DF707B9D00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF707B9440>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A47C10>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestValuationApi.test_add_comparable_via_api ________

create_user = <function create_user.<locals>._create_user at 0x000002DF6F3DA0C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3DBF60>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707F4B50>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestValuationApi.test_add_precedent_via_api ________

create_user = <function create_user.<locals>._create_user at 0x000002DF707B8EA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF707BAD40>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70783F50>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestValuationApi.test_create_scenario_via_api _______

create_user = <function create_user.<locals>._create_user at 0x000002DF6FA8A0C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D02980>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F362210>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestValuationApi.test_generate_export_creates_log _____

create_user = <function create_user.<locals>._create_user at 0x000002DF70D04EA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D07920>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F335490>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationApi.test_generate_export_returns_log_id_and_persists_entry _

create_user = <function create_user.<locals>._create_user at 0x000002DF70D17060>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D16FC0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DD7490>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationApi.test_generate_export_allows_scenario_id __

create_user = <function create_user.<locals>._create_user at 0x000002DF707B8E00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF707B9800>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FED1710>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationApi.test_generate_export_forbidden_for_solo __

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F827810>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationApi.test_generate_export_rejects_foreign_scenario _

create_user = <function create_user.<locals>._create_user at 0x000002DF6FA9BCE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA99080>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA2CA50>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestValuationApi.test_list_exports_returns_recent_logs ___

create_user = <function create_user.<locals>._create_user at 0x000002DF70D160C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D15440>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70782DD0>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationApi.test_get_export_status_reflects_updates __

create_user = <function create_user.<locals>._create_user at 0x000002DF70D02020>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D011C0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F2691D0>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestValuationApi.test_run_monte_carlo_simulation ______

create_user = <function create_user.<locals>._create_user at 0x000002DF707B8720>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF707B9260>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707DFD50>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestValuationApi.test_run_monte_carlo_validation ______

create_user = <function create_user.<locals>._create_user at 0x000002DF70D067A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D04360>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDFAED0>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestValuationApi.test_get_scenario_summary_via_api _____

create_user = <function create_user.<locals>._create_user at 0x000002DF70DCD1C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70DCF740>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD0D050>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationApi.test_get_scenario_summary_forbidden_for_solo_tier _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA225D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationCrudApi.test_create_valuation_creates_record _

create_user = <function create_user.<locals>._create_user at 0x000002DF70D045E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D14D60>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DA7590>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationCrudApi.test_create_valuation_requires_growth_tier _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB07E90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationCrudApi.test_update_valuation_modifies_record _

create_user = <function create_user.<locals>._create_user at 0x000002DF70D01E40>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D01440>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70304190>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestValuationCrudApi.test_delete_valuation_returns_204 ___

create_user = <function create_user.<locals>._create_user at 0x000002DF70D15F80>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D15580>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F620850>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestValuationCrudApi.test_add_comparable_company ______

create_user = <function create_user.<locals>._create_user at 0x000002DF6B214D60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFC8F40>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FEA2E50>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ ERROR at setup of TestValuationCrudApi.test_add_precedent_transaction ____

create_user = <function create_user.<locals>._create_user at 0x000002DF70DCF920>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70DCF420>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9743D0>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationCrudApi.test_create_scenario_requires_growth_tier _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FBB2C10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationAccessControl.test_cannot_access_other_org_deal _

create_user = <function create_user.<locals>._create_user at 0x000002DF70D07420>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D05BC0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B202790>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationExportService.test_export_to_pdf_creates_file _

create_user = <function create_user.<locals>._create_user at 0x000002DF70D03920>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D02F20>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705857D0>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationExportService.test_export_to_excel_creates_file _

create_user = <function create_user.<locals>._create_user at 0x000002DF707B9D00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF707B8EA0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B202B90>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationExportService.test_export_updates_export_log _

create_user = <function create_user.<locals>._create_user at 0x000002DF70D16FC0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D16840>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DDF8D0>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationExportService.test_export_includes_valuation_data _

create_user = <function create_user.<locals>._create_user at 0x000002DF70D58C20>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70D5B740>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA5CA50>

    @pytest.fixture()
    def growth_user(create_user, create_organization, db_session):
>       org = create_organization(subscription_tier="growth")

tests\conftest.py:542: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestMultiplesAndScenarioAnalytics.test_comparable_analysis_excludes_outliers_and_weighs_results _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBE4990>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestMultiplesAndScenarioAnalytics.test_precedent_analysis_flags_stale_transactions _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F962E10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestScenarioAnalytics.test_calculate_scenario_summary_returns_expected_stats _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA20AD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ ERROR at setup of TestExportLogging.test_log_export_creates_audit_record ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D6B1F10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationServiceOperations.test_update_valuation_recalculates_metrics _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FEE70D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationServiceOperations.test_delete_valuation_removes_related_records _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F2457D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationServiceOperations.test_calculate_precedent_multiples_handles_no_records _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F938190>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestValuationServiceOperations.test_list_helpers_return_entries _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FED7B10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_list_blog_posts_default ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ADFA10>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_list_blog_posts_with_category_filter _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FEE4D90>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_list_blog_posts_with_search ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC40510>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_list_blog_posts_include_unpublished __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707F9CD0>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_list_blog_posts_with_pagination ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E904050>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_list_blog_posts_empty_result _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7060E1D0>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_get_blog_post_by_slug_success _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70440E90>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_get_blog_post_by_slug_not_found ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A286D0>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_get_unpublished_post_by_slug _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9743D0>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ ERROR at setup of test_list_blog_categories _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE3BB50>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_list_blog_posts_with_invalid_limit __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBAFA50>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_list_blog_posts_with_invalid_offset __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7001EA10>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of test_blog_post_response_schema _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FEC6710>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of test_blog_search_case_insensitive _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FED4A50>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ ERROR at setup of test_blog_list_ordering __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF706DD8D0>

    @pytest.fixture
    def sample_blog_posts(db_session: Session):
        """Create a set of blog posts covering published/unpublished scenarios."""
        posts = [
>           BlogPost(
                title="Test M&A Strategy Post",
                slug="test-ma-strategy-post",
                excerpt="A comprehensive guide to M&A strategy in 2025",
                content="# M&A Strategy\n\nThis is a test post about M&A strategy.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="M&A strategy",
                secondary_keywords="deal flow, mergers, acquisitions",
                meta_description="Learn M&A strategy fundamentals and best practices for 2025",
                featured_image_url="https://example.com/image1.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=8,
            ),
            BlogPost(
                title="Advanced FP&A Techniques",
                slug="advanced-fpa-techniques",
                excerpt="Master FP&A with these advanced techniques",
                content="# FP&A Techniques\n\nLearn advanced FP&A methodologies.",
                author="Dudley Peacock",
                category="FP&A",
                primary_keyword="FP&A techniques",
                secondary_keywords="financial planning, analysis, forecasting",
                meta_description="Advanced FP&A techniques for finance professionals",
                featured_image_url="https://example.com/image2.png",
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=10,
            ),
            BlogPost(
                title="PMI Best Practices",
                slug="pmi-best-practices",
                excerpt="Post-merger integration strategies that work",
                content="# PMI Best Practices\n\nSuccessful integration strategies.",
                author="Dudley Peacock",
                category="PMI",
                primary_keyword="post-merger integration",
                secondary_keywords="PMI, integration, M&A",
                meta_description="PMI best practices for successful post-merger integration",
                featured_image_url=None,
                published=True,
                published_at=datetime.now(timezone.utc),
                read_time_minutes=12,
            ),
            BlogPost(
                title="Unpublished Draft Post",
                slug="unpublished-draft-post",
                excerpt="This post is not yet published",
                content="# Draft\n\nThis is an unpublished draft.",
                author="Dudley Peacock",
                category="M&A Strategy",
                primary_keyword="draft",
                secondary_keywords="test",
                meta_description="Draft post for testing",
                featured_image_url=None,
                published=False,
                published_at=None,
                read_time_minutes=5,
            ),
        ]

tests\api\test_blog.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_create_share_link_for_document ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7060F490>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_create_share_link_with_password ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE5A910>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of test_access_shared_document_valid_link ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF706A7E10>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_access_shared_document_expired_link __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707DE210>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_access_shared_document_with_password _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70421D10>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_list_active_share_links_for_document _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD0BE10>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ ERROR at setup of test_revoke_share_link ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FB5D790>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_track_share_link_access_count _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD07B50>

    @pytest.fixture()
    def test_organization(db_session):
        """Create and return a test organization for subscription tests."""
        from app.models.organization import Organization
    
>       org = Organization(
            id="test-org-subscription",
            name="Subscription Test Org",
            slug="subscription-test-org",
            subscription_tier="professional"
        )

tests\conftest.py:506: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_create_event_returns_201 _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE32B10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of test_create_event_wrong_organization_returns_403 ______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF700D00D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_list_events_returns_200 ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70626710>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_list_events_with_status_filter ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F620150>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ ERROR at setup of test_get_event_returns_200 _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FB5FF10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_get_event_not_found_returns_404 ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705FE050>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_update_event_returns_200 _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7006EE90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ ERROR at setup of test_delete_event_returns_204 _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701DF990>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_create_event_session_returns_201 ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF706A6990>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_list_event_sessions_returns_200 ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7079CA10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_update_event_session_returns_200 ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70455DD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_delete_event_session_returns_204 ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707DCB90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_create_event_ticket_returns_201 ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECF2910>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of test_list_event_tickets_returns_200 ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA23D90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_update_event_ticket_returns_200 ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E85CF50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_delete_event_ticket_returns_204 ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E894050>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_create_event_registration_returns_201 _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ADDA50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_list_event_registrations_returns_200 _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D451B10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_update_event_registration_returns_200 _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70415450>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of test_delete_event_registration_returns_204 _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70676310>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of test_get_event_analytics_returns_200 ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E95C850>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_export_registrations_csv_returns_200 _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF4AF28D10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of test_export_registrations_empty_event_returns_200 _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB191D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_list_events_requires_authentication __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70675590>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ ERROR at setup of test_create_event_requires_authentication _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E897E50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of TestAdminGoal.test_create_admin_goal ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD743D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestAdminGoal.test_admin_goal_unique_constraint ______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705C6E50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of TestAdminGoal.test_admin_goal_repr _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7079DB10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestAdminGoal.test_admin_goal_default_targets _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E9BE4D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestAdminActivity.test_create_admin_activity ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF706A4390>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestAdminActivity.test_admin_activity_types ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA697D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestAdminActivity.test_admin_activity_statuses _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD7FC50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ ERROR at setup of TestAdminActivity.test_admin_activity_default_amount ____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD18F90>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestAdminActivity.test_admin_activity_repr _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701E1F50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ ERROR at setup of TestAdminScore.test_create_admin_score ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF4AF2B910>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestAdminScore.test_admin_score_unique_constraint _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70422990>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestAdminScore.test_admin_score_valid_range ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707C7490>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestAdminScore.test_admin_score_default_values _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF704A6A10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of TestAdminScore.test_admin_score_repr ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70081810>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestAdminFocusSession.test_create_focus_session ______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF4B09B450>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ ERROR at setup of TestAdminFocusSession.test_complete_focus_session _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF4B09B110>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestAdminFocusSession.test_focus_session_default_duration _

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE5D250>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ ERROR at setup of TestAdminFocusSession.test_focus_session_repr _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB07510>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ ERROR at setup of TestAdminNudge.test_create_nudge ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701E3D10>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of TestAdminNudge.test_nudge_types ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7049EBD0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of TestAdminNudge.test_nudge_priorities ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707F57D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ ERROR at setup of TestAdminNudge.test_nudge_default_priority _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D5C7C50>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of TestAdminNudge.test_nudge_read_status ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701F5350>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ ERROR at setup of TestAdminNudge.test_nudge_repr _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70121050>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ ERROR at setup of TestAdminMeeting.test_create_meeting ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF704564D0>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of TestAdminMeeting.test_meeting_types ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7B7150>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ ERROR at setup of TestAdminMeeting.test_meeting_default_duration _______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B20E850>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ ERROR at setup of TestAdminMeeting.test_meeting_repr _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B20E650>

    @pytest.fixture()
    def solo_user(db_session):
        """Create and return a test solo user."""
        from app.models.user import User
        from app.models.organization import Organization
    
        # Create test organization
>       org = Organization(
            id="test-org-solo",
            name="Solo Test Org",
            slug="solo-test-org",
            subscription_tier="starter"
        )

tests\conftest.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestForeignKeyIntegrity.test_folder_rejects_invalid_created_by _

self = <test_migrations.test_user_foreign_keys.TestForeignKeyIntegrity object at 0x000002DF6D6522D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D618DD0>

    @pytest.fixture(autouse=True)
    def setup_test_data(self, db_session):
        """Create test organization and user for FK testing."""
        # Create organization
        org_id = str(uuid4())
>       self.org = Organization(
            id=org_id,
            name="Test Org",
            slug="test-org",  # Required field
            subscription_tier="professional"
        )

tests\test_migrations\test_user_foreign_keys.py:116: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestForeignKeyIntegrity.test_document_rejects_invalid_uploaded_by _

self = <test_migrations.test_user_foreign_keys.TestForeignKeyIntegrity object at 0x000002DF6D652A10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70805C10>

    @pytest.fixture(autouse=True)
    def setup_test_data(self, db_session):
        """Create test organization and user for FK testing."""
        # Create organization
        org_id = str(uuid4())
>       self.org = Organization(
            id=org_id,
            name="Test Org",
            slug="test-org",  # Required field
            subscription_tier="professional"
        )

tests\test_migrations\test_user_foreign_keys.py:116: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestForeignKeyIntegrity.test_document_permission_rejects_invalid_user_id _

self = <test_migrations.test_user_foreign_keys.TestForeignKeyIntegrity object at 0x000002DF6D653150>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA436D0>

    @pytest.fixture(autouse=True)
    def setup_test_data(self, db_session):
        """Create test organization and user for FK testing."""
        # Create organization
        org_id = str(uuid4())
>       self.org = Organization(
            id=org_id,
            name="Test Org",
            slug="test-org",  # Required field
            subscription_tier="professional"
        )

tests\test_migrations\test_user_foreign_keys.py:116: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ ERROR at setup of TestForeignKeyIntegrity.test_valid_user_references_succeed _

self = <test_migrations.test_user_foreign_keys.TestForeignKeyIntegrity object at 0x000002DF6D6538D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F2030D0>

    @pytest.fixture(autouse=True)
    def setup_test_data(self, db_session):
        """Create test organization and user for FK testing."""
        # Create organization
        org_id = str(uuid4())
>       self.org = Organization(
            id=org_id,
            name="Test Org",
            slug="test-org",  # Required field
            subscription_tier="professional"
        )

tests\test_migrations\test_user_foreign_keys.py:116: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
================================== FAILURES ===================================
______________ test_enforce_claim_integrity_validates_org_match _______________

self = <Mapper at 0x2df49496190; GeneratedDocument>, key = 'export_jobs'
_configure_mappers = False

    def get_property(
        self, key: str, _configure_mappers: bool = False
    ) -> MapperProperty[Any]:
        """return a MapperProperty associated with the given key."""
    
        if _configure_mappers:
            self._check_configure()
    
        try:
>           return self._props[key]
E           KeyError: 'export_jobs'

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2505: KeyError

The above exception was the direct cause of the following exception:

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECC0A90>

    def test_enforce_claim_integrity_validates_org_match(db_session: Session):
        """Test _enforce_claim_integrity validates organization claim matches DB."""
>       org = Organization(
            id="org_match",
            name="Test Org",
            slug="test-org",
            subscription_tier="professional"
        )

tests\test_auth_helpers.py:110: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4240: in _do_configure_registries
    mapper._post_configure_properties()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2403: in _post_configure_properties
    prop.init()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\interfaces.py:579: in init
    self.do_init()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py:1640: in do_init
    self._generate_backref()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py:2129: in _generate_backref
    self._add_reverse_property(self.back_populates)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py:1571: in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Mapper at 0x2df49496190; GeneratedDocument>, key = 'export_jobs'
_configure_mappers = False

    def get_property(
        self, key: str, _configure_mappers: bool = False
    ) -> MapperProperty[Any]:
        """return a MapperProperty associated with the given key."""
    
        if _configure_mappers:
            self._check_configure()
    
        try:
            return self._props[key]
        except KeyError as err:
>           raise sa_exc.InvalidRequestError(
                f"Mapper '{self}' has no property '{key}'.  If this property "
                "was indicated from other mappers or configure events, ensure "
                "registry.configure() has been called."
            ) from err
E           sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2507: InvalidRequestError
______________ test_enforce_claim_integrity_rejects_org_mismatch ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8BBA10>

    def test_enforce_claim_integrity_rejects_org_mismatch(db_session: Session):
        """Test _enforce_claim_integrity rejects mismatched organization claims."""
>       user = User(
            clerk_user_id="user_mismatch",
            email="test@example.com",
            role=UserRole.growth,
            organization_id="org_db"
        )

tests\test_auth_helpers.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ test_enforce_claim_integrity_rejects_missing_org_claim_when_user_has_org ___

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E9C9A10>

    def test_enforce_claim_integrity_rejects_missing_org_claim_when_user_has_org(db_session: Session):
        """Test _enforce_claim_integrity rejects missing org claim when user has organization."""
>       user = User(
            clerk_user_id="user_no_claim",
            email="test@example.com",
            role=UserRole.growth,
            organization_id="org_exists"
        )

tests\test_auth_helpers.py:164: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ test_enforce_claim_integrity_creates_missing_org_from_clerk _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E9CBD50>

    def test_enforce_claim_integrity_creates_missing_org_from_clerk(db_session: Session):
        """Test _enforce_claim_integrity creates organization when missing from Clerk sync."""
>       user = User(
            clerk_user_id="user_new_org",
            email="test@example.com",
            role=UserRole.growth,
            organization_id=None  # No org yet
        )

tests\test_auth_helpers.py:188: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ test_enforce_claim_integrity_validates_role_match ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB0FCD0>

    def test_enforce_claim_integrity_validates_role_match(db_session: Session):
        """Test _enforce_claim_integrity validates role claim matches DB."""
>       user = User(
            clerk_user_id="user_role_match",
            email="test@example.com",
            role=UserRole.enterprise,
            organization_id=None
        )

tests\test_auth_helpers.py:220: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ test_enforce_claim_integrity_rejects_role_mismatch ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA68510>

    def test_enforce_claim_integrity_rejects_role_mismatch(db_session: Session):
        """Test _enforce_claim_integrity rejects mismatched role claims."""
>       user = User(
            clerk_user_id="user_role_mismatch",
            email="test@example.com",
            role=UserRole.solo,
            organization_id=None
        )

tests\test_auth_helpers.py:240: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ test_enforce_claim_integrity_rejects_unknown_role_claim ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB7F110>

    def test_enforce_claim_integrity_rejects_unknown_role_claim(db_session: Session):
        """Test _enforce_claim_integrity rejects unknown role values."""
>       user = User(
            clerk_user_id="user_unknown_role",
            email="test@example.com",
            role=UserRole.growth,
            organization_id=None
        )

tests\test_auth_helpers.py:263: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ test_enforce_claim_integrity_logs_claim_mismatches ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBCD350>

    def test_enforce_claim_integrity_logs_claim_mismatches(db_session: Session):
        """Test _enforce_claim_integrity logs mismatches to rbac_audit_log."""
>       user = User(
            clerk_user_id="user_audit_log",
            email="test@example.com",
            role=UserRole.growth,
            organization_id="org_audit"
        )

tests\test_auth_helpers.py:286: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ test_enforce_claim_integrity_allows_missing_role_claim ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB70A10>

    def test_enforce_claim_integrity_allows_missing_role_claim(db_session: Session):
        """Test _enforce_claim_integrity allows missing role claim (optional field)."""
>       user = User(
            clerk_user_id="user_no_role_claim",
            email="test@example.com",
            role=UserRole.growth,
            organization_id=None
        )

tests\test_auth_helpers.py:327: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_get_current_user_enforces_claim_integrity ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E801E90>

    @pytest.mark.asyncio
    async def test_get_current_user_enforces_claim_integrity(db_session: Session):
        """Test get_current_user decodes JWT and enforces claim integrity."""
>       user = User(
            clerk_user_id="user_get_current",
            email="current@example.com",
            role=UserRole.growth,
            organization_id="org_get_current",
        )

tests\test_auth_helpers.py:349: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ test_require_feature_allows_access_with_sufficient_tier ___________

    @pytest.mark.asyncio
    async def test_require_feature_allows_access_with_sufficient_tier():
        """Test require_feature allows access when entitlement service grants access."""
>       user = User(
            clerk_user_id="user_feature_access",
            email="feature@example.com",
            role=UserRole.growth,
            organization_id="org_feature",
        )

tests\test_auth_helpers.py:388: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ test_require_feature_blocks_access_with_insufficient_tier __________

    @pytest.mark.asyncio
    async def test_require_feature_blocks_access_with_insufficient_tier():
        """Test require_feature returns 403 with upgrade guidance when tier lacks access."""
>       user = User(
            clerk_user_id="user_feature_block",
            email="block@example.com",
            role=UserRole.growth,
            organization_id="org_block",
        )

tests\test_auth_helpers.py:408: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_create_checkout_session_success _____________________

client = <starlette.testclient.TestClient object at 0x000002DF6EB0E210>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB77A10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EC4CA40>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EC4F920>

    def test_create_checkout_session_success(client: TestClient, db_session, create_user, create_organization):
        """Test creating Stripe Checkout session for new subscription."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
        # Arrange
>       org = create_organization(name="Startup Co")

tests\test_billing_endpoints.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ test_create_checkout_session_existing_subscription ______________

client = <starlette.testclient.TestClient object at 0x000002DF6EAF9290>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F1A30D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EAEAC00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EAEA200>

    def test_create_checkout_session_existing_subscription(client: TestClient, db_session, create_user, create_organization):
        """Test creating checkout session when organization already has active subscription."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Existing Sub Org")

tests\test_billing_endpoints.py:91: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_create_checkout_session_with_trial ___________________

client = <starlette.testclient.TestClient object at 0x000002DF6ECF00D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F4BCCD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6ECC5F80>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6ECC5C60>

    def test_create_checkout_session_with_trial(client: TestClient, db_session, create_user, create_organization):
        """Test creating checkout session includes 14-day trial."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Trial Org")

tests\test_billing_endpoints.py:141: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_get_customer_portal_success _______________________

client = <starlette.testclient.TestClient object at 0x000002DF6ECF0E10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EB5D440>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EB5C180>

    def test_get_customer_portal_success(client: TestClient, create_user, create_organization):
        """Test retrieving Stripe billing portal URL."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Portal Org")

tests\test_billing_endpoints.py:181: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_get_customer_portal_handles_value_errors ________________

client = <starlette.testclient.TestClient object at 0x000002DF6EB51A50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6ECC4860>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6ECC4040>

    def test_get_customer_portal_handles_value_errors(client: TestClient, create_user, create_organization):
        """Test billing portal endpoint returns 400 when service raises ValueError."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Portal Error Org")

tests\test_billing_endpoints.py:209: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________________ test_get_subscription_success ________________________

client = <starlette.testclient.TestClient object at 0x000002DF6EB52690>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAF6A10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6D7C96C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6D7CA160>

    def test_get_subscription_success(client: TestClient, db_session, create_user, create_organization):
        """Test retrieving current subscription."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Sub Org")

tests\test_billing_endpoints.py:236: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_update_subscription_tier_upgrade ____________________

client = <starlette.testclient.TestClient object at 0x000002DF6EA78990>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E7FFD50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EA6CAE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA6C220>

    def test_update_subscription_tier_upgrade(client: TestClient, db_session, create_user, create_organization):
        """Test upgrading subscription tier."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Upgrade Org")

tests\test_billing_endpoints.py:299: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_update_subscription_tier_downgrade ___________________

client = <starlette.testclient.TestClient object at 0x000002DF6E81DCD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E94A710>
create_user = <function create_user.<locals>._create_user at 0x000002DF6ECC72E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6ECC7380>

    def test_update_subscription_tier_downgrade(client: TestClient, db_session, create_user, create_organization):
        """Test downgrading subscription tier (at period end)."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Downgrade Org")

tests\test_billing_endpoints.py:354: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_cancel_subscription_at_period_end ____________________

client = <starlette.testclient.TestClient object at 0x000002DF6E81F210>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAC8E10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EAEA020>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EAEB7E0>

    def test_cancel_subscription_at_period_end(client: TestClient, db_session, create_user, create_organization):
        """Test canceling subscription at end of billing period."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Cancel Org")

tests\test_billing_endpoints.py:403: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_cancel_subscription_immediately _____________________

client = <starlette.testclient.TestClient object at 0x000002DF6E81EB90>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAE7490>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EB5ED40>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EB5CAE0>

    def test_cancel_subscription_immediately(client: TestClient, db_session, create_user, create_organization):
        """Test canceling subscription immediately."""
        from app.api.dependencies.auth import get_current_user
        from app.main import app
    
>       org = create_organization(name="Immediate Cancel Org")

tests\test_billing_endpoints.py:448: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________________ test_webhook_creates_user __________________________

client = <starlette.testclient.TestClient object at 0x000002DF6B1F4890>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECA0E50>

    def test_webhook_creates_user(client, db_session: Session) -> None:
        """Test user.created webhook creates a new user."""
        payload = {
            "type": "user.created",
            "data": {
                "id": "user_create_123",
                "email_addresses": [{"email_address": "create@example.com"}],
                "first_name": "Create",
                "last_name": "User",
                "public_metadata": {"role": "growth"},
            },
        }
        signature, body = _sign_payload(payload)
    
>       response = client.post(
            "/api/webhooks/clerk",
            data=body,
            headers={"svix-signature": signature, "content-type": "application/json"},
        )

tests\test_clerk_auth_complete.py:58: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:590: in post
    return super().post(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1145: in post
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app\api\webhooks\clerk.py:43: in handle_clerk_webhook
    user_service.create_user_from_clerk(db, data)
app\services\user_service.py:52: in create_user_from_clerk
    existing = get_user_by_clerk_id(db, clerk_id)
app\services\user_service.py:106: in get_user_by_clerk_id
    return db.query(User).filter(User.clerk_user_id == clerk_user_id).first()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2912: in query
    return self._query_cls(entities, self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:276: in __init__
    self._set_entities(entities)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:288: in _set_entities
    self._raw_columns = [
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:289: in <listcomp>
    coercions.expect(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py:406: in expect
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_webhook_updates_existing_user ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6E8C4550>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8C93D0>

    def test_webhook_updates_existing_user(client, db_session: Session) -> None:
        """Test user.updated webhook updates an existing user."""
        # Create initial user
>       user = User(
            clerk_user_id="user_update_123",
            email="original@example.com",
            first_name="Original",
            last_name="Name",
            role=UserRole.solo,
        )

tests\test_clerk_auth_complete.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_webhook_update_creates_if_not_exists __________________

client = <starlette.testclient.TestClient object at 0x000002DF6E904AD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E907490>

    def test_webhook_update_creates_if_not_exists(client, db_session: Session) -> None:
        """Test user.updated creates user if it doesn't exist (fallback)."""
        payload = {
            "type": "user.updated",
            "data": {
                "id": "user_new_via_update",
                "email_addresses": [{"email_address": "newupdate@example.com"}],
                "first_name": "NewUpdate",
                "public_metadata": {"role": "admin"},
            },
        }
        signature, body = _sign_payload(payload)
    
>       response = client.post(
            "/api/webhooks/clerk",
            data=body,
            headers={"svix-signature": signature, "content-type": "application/json"},
        )

tests\test_clerk_auth_complete.py:157: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:590: in post
    return super().post(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1145: in post
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app\api\webhooks\clerk.py:46: in handle_clerk_webhook
    user_service.update_user_from_clerk(db, clerk_user_id, data)
app\services\user_service.py:74: in update_user_from_clerk
    user = get_user_by_clerk_id(db, clerk_user_id)
app\services\user_service.py:106: in get_user_by_clerk_id
    return db.query(User).filter(User.clerk_user_id == clerk_user_id).first()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2912: in query
    return self._query_cls(entities, self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:276: in __init__
    self._set_entities(entities)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:288: in _set_entities
    self._raw_columns = [
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:289: in <listcomp>
    coercions.expect(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py:406: in expect
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_webhook_soft_deletes_user ________________________

client = <starlette.testclient.TestClient object at 0x000002DF6F9A6D10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F720890>

    def test_webhook_soft_deletes_user(client, db_session: Session) -> None:
        """Test user.deleted webhook soft deletes a user."""
>       user = User(
            clerk_user_id="user_delete_123",
            email="delete@example.com",
        )

tests\test_clerk_auth_complete.py:173: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ test_webhook_updates_last_login_on_session_created ______________

client = <starlette.testclient.TestClient object at 0x000002DF6D806550>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D807490>

    def test_webhook_updates_last_login_on_session_created(client, db_session: Session) -> None:
        """Test session.created webhook updates last_login_at."""
>       user = User(
            clerk_user_id="user_login_123",
            email="login@example.com",
        )

tests\test_clerk_auth_complete.py:197: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_webhook_handles_session_ended ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6E8F7990>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC89CD0>

    def test_webhook_handles_session_ended(client, db_session: Session) -> None:
        """Test session.ended webhook updates last_login_at."""
>       user = User(
            clerk_user_id="user_logout_123",
            email="logout@example.com",
        )

tests\test_clerk_auth_complete.py:228: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_webhook_handles_missing_email_addresses _________________

client = <starlette.testclient.TestClient object at 0x000002DF6ECCE610>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E87CA50>

    def test_webhook_handles_missing_email_addresses(client, db_session: Session) -> None:
        """Test webhook handles user data without email_addresses field."""
        payload = {
            "type": "user.created",
            "data": {
                "id": "user_no_email",
                "email": "fallback@example.com",  # Fallback email field
                "first_name": "NoEmail",
            },
        }
        signature, body = _sign_payload(payload)
    
>       response = client.post(
            "/api/webhooks/clerk",
            data=body,
            headers={"svix-signature": signature, "content-type": "application/json"},
        )

tests\test_clerk_auth_complete.py:266: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:590: in post
    return super().post(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1145: in post
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app\api\webhooks\clerk.py:43: in handle_clerk_webhook
    user_service.create_user_from_clerk(db, data)
app\services\user_service.py:52: in create_user_from_clerk
    existing = get_user_by_clerk_id(db, clerk_id)
app\services\user_service.py:106: in get_user_by_clerk_id
    return db.query(User).filter(User.clerk_user_id == clerk_user_id).first()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2912: in query
    return self._query_cls(entities, self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:276: in __init__
    self._set_entities(entities)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:288: in _set_entities
    self._raw_columns = [
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:289: in <listcomp>
    coercions.expect(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py:406: in expect
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ test_webhook_upserts_organization_metadata __________________

client = <starlette.testclient.TestClient object at 0x000002DF6F3F55D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7027ECD0>

    def test_webhook_upserts_organization_metadata(client, db_session: Session) -> None:
        """organization.updated should upsert organization and clear cache."""
    
>       org = Organization(id="org_123", name="Legacy Org", slug="legacy-org", subscription_tier="starter")

tests\test_clerk_auth_complete.py:281: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_webhook_creates_organization_when_missing ________________

client = <starlette.testclient.TestClient object at 0x000002DF6E8C8850>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8DB2D0>

    def test_webhook_creates_organization_when_missing(client, db_session: Session) -> None:
        """organization.created should create organization records."""
    
        payload = {
            "type": "organization.created",
            "data": {
                "id": "org_new",
                "name": "New Org",
                "slug": "new-org",
                "public_metadata": {"subscription_tier": "enterprise"},
            },
        }
        signature, body = _sign_payload(payload)
    
        with patch("app.api.webhooks.clerk.clear_tier_cache") as mock_clear:
>           response = client.post(
                "/api/webhooks/clerk",
                data=body,
                headers={"svix-signature": signature, "content-type": "application/json"},
            )

tests\test_clerk_auth_complete.py:326: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:590: in post
    return super().post(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1145: in post
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app\api\webhooks\clerk.py:53: in handle_clerk_webhook
    organization = organization_service.upsert_from_clerk(db, data)
app\services\organization_service.py:73: in upsert_from_clerk
    organization = db.get(Organization, org_id)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_webhook_deactivates_organization_on_delete _______________

client = <starlette.testclient.TestClient object at 0x000002DF6E8C9710>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA15D50>

    def test_webhook_deactivates_organization_on_delete(client, db_session: Session) -> None:
        """organization.deleted should mark organization inactive and clear cache."""
    
>       org = Organization(id="org_to_remove", name="Remove Org", slug="remove-org", subscription_tier="premium")

tests\test_clerk_auth_complete.py:344: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_webhook_handles_invalid_role_gracefully _________________

client = <starlette.testclient.TestClient object at 0x000002DF6E8C8450>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7B5910>

    def test_webhook_handles_invalid_role_gracefully(client, db_session: Session) -> None:
        """Test webhook defaults to solo role for invalid role values."""
        payload = {
            "type": "user.created",
            "data": {
                "id": "user_invalid_role",
                "email_addresses": [{"email_address": "invalidrole@example.com"}],
                "public_metadata": {"role": "super_admin"},  # Invalid role
            },
        }
        signature, body = _sign_payload(payload)
    
>       response = client.post(
            "/api/webhooks/clerk",
            data=body,
            headers={"svix-signature": signature, "content-type": "application/json"},
        )

tests\test_clerk_auth_complete.py:379: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:590: in post
    return super().post(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1145: in post
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app\api\webhooks\clerk.py:43: in handle_clerk_webhook
    user_service.create_user_from_clerk(db, data)
app\services\user_service.py:52: in create_user_from_clerk
    existing = get_user_by_clerk_id(db, clerk_id)
app\services\user_service.py:106: in get_user_by_clerk_id
    return db.query(User).filter(User.clerk_user_id == clerk_user_id).first()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2912: in query
    return self._query_cls(entities, self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:276: in __init__
    self._set_entities(entities)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:288: in _set_entities
    self._raw_columns = [
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:289: in <listcomp>
    coercions.expect(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py:406: in expect
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_auth_me_returns_current_user ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6F346BD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA16E90>

    def test_auth_me_returns_current_user(client, db_session: Session) -> None:
        """Test /api/auth/me returns authenticated user."""
>       user = User(
            clerk_user_id="user_auth_me",
            email="authme@example.com",
            first_name="Auth",
            last_name="User",
            role=UserRole.enterprise,
        )

tests\test_clerk_auth_complete.py:398: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_auth_me_rejects_token_for_nonexistent_user _______________

client = <starlette.testclient.TestClient object at 0x000002DF6EB53210>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E95E050>

    def test_auth_me_rejects_token_for_nonexistent_user(client, db_session: Session) -> None:
        """Test /api/auth/me returns 401 if user not in database."""
        token = _make_token("user_does_not_exist")
    
>       response = client.get("/api/auth/me", headers={"Authorization": f"Bearer {token}"})

tests\test_clerk_auth_complete.py:438: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:499: in get
    return super().get(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1054: in get
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:264: in app
    solved_result = await solve_dependencies(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\dependencies\utils.py:594: in solve_dependencies
    solved = await run_in_threadpool(call, **sub_values)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py:41: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py:33: in run_sync
    return await get_asynclib().run_sync_in_worker_thread(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py:877: in run_sync_in_worker_thread
    return await future
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py:807: in run
    result = context.run(func, *args)
app\api\dependencies\auth.py:107: in get_current_user
    user = get_user_by_clerk_id(db, clerk_user_id)
app\services\user_service.py:106: in get_user_by_clerk_id
    return db.query(User).filter(User.clerk_user_id == clerk_user_id).first()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2912: in query
    return self._query_cls(entities, self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:276: in __init__
    self._set_entities(entities)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:288: in _set_entities
    self._raw_columns = [
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:289: in <listcomp>
    coercions.expect(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py:406: in expect
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_auth_me_rejects_org_claim_mismatch ___________________

client = <starlette.testclient.TestClient object at 0x000002DF70DC3C10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705229D0>

    def test_auth_me_rejects_org_claim_mismatch(client, db_session: Session) -> None:
        """Organization claims must match the persisted user organization."""
>       org = Organization(id="org-secure", name="Secure Org", slug="secure-org", subscription_tier="starter")

tests\test_clerk_auth_complete.py:461: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_auth_me_rejects_role_claim_mismatch ___________________

client = <starlette.testclient.TestClient object at 0x000002DF6EA5DCD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB6AA50>

    def test_auth_me_rejects_role_claim_mismatch(client, db_session: Session) -> None:
        """Role escalation attempts via claims are rejected and audited."""
>       user = User(
            clerk_user_id="user_role_mismatch",
            email="rolemismatch@example.com",
            role=UserRole.solo,
        )

tests\test_clerk_auth_complete.py:484: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_auth_me_populates_missing_org_from_claim ________________

client = <starlette.testclient.TestClient object at 0x000002DF6EA99910>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB62810>

    def test_auth_me_populates_missing_org_from_claim(client, db_session: Session) -> None:
        """Users without org assignment inherit org_id from trusted claim."""
>       user = User(
            clerk_user_id="user_org_assign",
            email="orgassign@example.com",
            role=UserRole.growth,
        )

tests\test_clerk_auth_complete.py:503: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_user_creation_with_all_roles ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6EA15AD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF700C2990>

    def test_user_creation_with_all_roles(client, db_session: Session) -> None:
        """Test creating users with all valid role types."""
        roles = ["solo", "growth", "enterprise", "admin"]
    
        for idx, role_name in enumerate(roles):
            payload = {
                "type": "user.created",
                "data": {
                    "id": f"user_role_{role_name}_{idx}",
                    "email_addresses": [{"email_address": f"{role_name}{idx}@example.com"}],
                    "public_metadata": {"role": role_name},
                },
            }
            signature, body = _sign_payload(payload)
    
>           response = client.post(
                "/api/webhooks/clerk",
                data=body,
                headers={"svix-signature": signature, "content-type": "application/json"},
            )

tests\test_clerk_auth_complete.py:571: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:590: in post
    return super().post(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1145: in post
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app\api\webhooks\clerk.py:43: in handle_clerk_webhook
    user_service.create_user_from_clerk(db, data)
app\services\user_service.py:52: in create_user_from_clerk
    existing = get_user_by_clerk_id(db, clerk_id)
app\services\user_service.py:106: in get_user_by_clerk_id
    return db.query(User).filter(User.clerk_user_id == clerk_user_id).first()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2912: in query
    return self._query_cls(entities, self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:276: in __init__
    self._set_entities(entities)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:288: in _set_entities
    self._raw_columns = [
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:289: in <listcomp>
    coercions.expect(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py:406: in expect
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_webhook_handles_invalid_timestamp_format ________________

client = <starlette.testclient.TestClient object at 0x000002DF70249450>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FA82C10>

    def test_webhook_handles_invalid_timestamp_format(client, db_session: Session) -> None:
        """Test webhook handles malformed timestamp gracefully."""
>       user = User(
            clerk_user_id="user_bad_timestamp",
            email="badtime@example.com",
        )

tests\test_clerk_auth_complete.py:585: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________________ test_full_user_lifecycle ___________________________

client = <starlette.testclient.TestClient object at 0x000002DF70249D10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7078D0>

    def test_full_user_lifecycle(client, db_session: Session) -> None:
        """Test complete user lifecycle: create -> update -> login -> delete."""
        # Step 1: Create user
        create_payload = {
            "type": "user.created",
            "data": {
                "id": "user_lifecycle",
                "email_addresses": [{"email_address": "lifecycle@example.com"}],
                "first_name": "Lifecycle",
                "public_metadata": {"role": "solo"},
            },
        }
        signature, body = _sign_payload(create_payload)
>       response = client.post(
            "/api/webhooks/clerk",
            data=body,
            headers={"svix-signature": signature, "content-type": "application/json"},
        )

tests\test_clerk_auth_complete.py:629: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:590: in post
    return super().post(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1145: in post
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app\api\webhooks\clerk.py:43: in handle_clerk_webhook
    user_service.create_user_from_clerk(db, data)
app\services\user_service.py:52: in create_user_from_clerk
    existing = get_user_by_clerk_id(db, clerk_id)
app\services\user_service.py:106: in get_user_by_clerk_id
    return db.query(User).filter(User.clerk_user_id == clerk_user_id).first()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2912: in query
    return self._query_cls(entities, self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:276: in __init__
    self._set_entities(entities)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:288: in _set_entities
    self._raw_columns = [
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py:289: in <listcomp>
    coercions.expect(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py:406: in expect
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________________ test_create_post _______________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F2F3910>
test_user_data = {'clerk_user_id': 'clerk_2ae3c51e-fc8d-4596-b22d-945c0aae0b7b', 'email': 'test@example.com', 'first_name': 'Test', 'id': '9690009f-db87-47ed-85cf-6ad4dc5fb027', ...}

    def test_create_post(db_session, test_user_data: dict):
        """Test creating a post."""
        # Create user first
>       user = User(**test_user_data)

tests\test_community_models.py:54: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________________ test_post_with_tags _____________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA2C090>
test_user_data = {'clerk_user_id': 'clerk_fbb3ad00-32de-4a5d-bdfa-232d7fe83d7d', 'email': 'test@example.com', 'first_name': 'Test', 'id': '4312ab57-082f-4cb5-afcd-4cfa826cbb82', ...}

    def test_post_with_tags(db_session, test_user_data: dict):
        """Test creating a post with tags."""
>       user = User(**test_user_data)

tests\test_community_models.py:85: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________________ test_post_multi_tenancy ___________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD63D50>
test_user_data = {'clerk_user_id': 'clerk_e6d82086-94f2-4d85-8e6f-e3f5e9049f6f', 'email': 'test@example.com', 'first_name': 'Test', 'id': '3a9136f5-35da-4098-ae62-d3ddfffa5209', ...}

    def test_post_multi_tenancy(db_session, test_user_data: dict):
        """Test post multi-tenancy isolation."""
>       user = User(**test_user_data)

tests\test_community_models.py:106: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________________ test_create_comment _____________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA755D0>
test_user_data = {'clerk_user_id': 'clerk_c917a268-7d16-4a3a-a28c-7e7a249685f9', 'email': 'test@example.com', 'first_name': 'Test', 'id': '20bde49c-d0c3-4836-91c0-7f5eef977d4c', ...}

    def test_create_comment(db_session, test_user_data: dict):
        """Test creating a comment."""
>       user = User(**test_user_data)

tests\test_community_models.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________________ test_nested_comments _____________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F27BB50>
test_user_data = {'clerk_user_id': 'clerk_9da8446a-ae54-4967-a52a-31f269a7b186', 'email': 'test@example.com', 'first_name': 'Test', 'id': '335e502e-8346-4b29-8181-74e878046fcc', ...}

    def test_nested_comments(db_session, test_user_data: dict):
        """Test nested comment threading."""
>       user = User(**test_user_data)

tests\test_community_models.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_post_comment_relationship ________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBD0810>
test_user_data = {'clerk_user_id': 'clerk_5a539623-0f6d-48b4-8821-10d985e97961', 'email': 'test@example.com', 'first_name': 'Test', 'id': '9df8ba4c-0a39-46a5-8fc5-4c7281ae1f5e', ...}

    def test_post_comment_relationship(db_session, test_user_data: dict):
        """Test relationship between post and comments."""
>       user = User(**test_user_data)

tests\test_community_models.py:207: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________________ test_create_reaction _____________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F2F37D0>
test_user_data = {'clerk_user_id': 'clerk_177b1cbc-99ee-41f2-8ad2-d17179b1c602', 'email': 'test@example.com', 'first_name': 'Test', 'id': '38dfe763-9d21-4527-8abc-55f204292d65', ...}

    def test_create_reaction(db_session, test_user_data: dict):
        """Test creating a reaction."""
>       user = User(**test_user_data)

tests\test_community_models.py:237: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________________ test_reaction_on_comment ___________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D6DF850>
test_user_data = {'clerk_user_id': 'clerk_cf2059f6-caa0-45a5-825b-74e2022235dc', 'email': 'test@example.com', 'first_name': 'Test', 'id': '53391d0b-676c-46cf-a446-974774f9c601', ...}

    def test_reaction_on_comment(db_session, test_user_data: dict):
        """Test creating a reaction on a comment."""
>       user = User(**test_user_data)

tests\test_community_models.py:270: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_unique_reaction_constraint _______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F5E4E10>
test_user_data = {'clerk_user_id': 'clerk_ee5be082-4fd7-403b-962d-e2dba33ce0b9', 'email': 'test@example.com', 'first_name': 'Test', 'id': 'fa3e8b7f-b09b-48c4-9c6b-52fd3e2f29db', ...}

    def test_unique_reaction_constraint(db_session, test_user_data: dict):
        """Test that a user cannot react twice with the same reaction type."""
>       user = User(**test_user_data)

tests\test_community_models.py:309: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________________ test_create_follow ______________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAE4FD0>
test_user_data = {'clerk_user_id': 'clerk_de76bd93-a125-4ee0-8176-5acbb1b87e6e', 'email': 'test@example.com', 'first_name': 'Test', 'id': 'da7964b1-d191-4b68-8ae1-d7662a979289', ...}
test_user_data_2 = {'clerk_user_id': 'clerk_d3212147-524e-4f79-ae88-91b748674725', 'email': 'test2@example.com', 'first_name': 'Test2', 'id': 'f870bd7f-6dae-4c36-b553-173781820527', ...}

    def test_create_follow(db_session, test_user_data: dict, test_user_data_2: dict):
        """Test creating a follow relationship."""
>       user1 = User(**test_user_data)

tests\test_community_models.py:348: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________________ test_unique_follow_constraint ________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBCD5D0>
test_user_data = {'clerk_user_id': 'clerk_5beadfe0-99bd-4ab1-834f-a8d22ae34a6d', 'email': 'test@example.com', 'first_name': 'Test', 'id': '778f642c-5636-4cba-a371-5a939aa8cbc6', ...}
test_user_data_2 = {'clerk_user_id': 'clerk_74be2edc-0ecf-4d61-a26e-01179dabbee1', 'email': 'test2@example.com', 'first_name': 'Test2', 'id': '52115050-45d1-4fdb-9de3-518398c0aed1', ...}

    def test_unique_follow_constraint(db_session, test_user_data: dict, test_user_data_2: dict):
        """Test that a user cannot follow the same user twice."""
>       user1 = User(**test_user_data)

tests\test_community_models.py:372: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________________ test_create_moderation_action ________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E89D250>
test_user_data = {'clerk_user_id': 'clerk_23097372-3ef9-46b2-bd57-669946e15cb6', 'email': 'test@example.com', 'first_name': 'Test', 'id': '5fcf7d43-ae06-4d92-886a-170dc1c93aaa', ...}

    def test_create_moderation_action(db_session, test_user_data: dict):
        """Test creating a moderation action."""
>       user = User(**test_user_data)

tests\test_community_models.py:402: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________________ test_moderation_action_types _________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAEDF50>
test_user_data = {'clerk_user_id': 'clerk_4f489ade-affe-462d-88df-92ae63366f03', 'email': 'test@example.com', 'first_name': 'Test', 'id': 'ef3a1153-39bb-42ac-a9a2-04ac06172701', ...}

    def test_moderation_action_types(db_session, test_user_data: dict):
        """Test different moderation action types."""
>       user = User(**test_user_data)

tests\test_community_models.py:437: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________________ test_create_deal_success ___________________________

client = <starlette.testclient.TestClient object at 0x000002DF6F827F10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E88AA20>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E88AFC0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ED02090>

    def test_create_deal_success(client, create_user, create_organization, db_session):
        """User can create a deal with all required fields."""
>       org = create_organization(name="Deal Org")

tests\test_deal_endpoints.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_create_deal_validation_errors ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6D80EC10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E9B5440>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B6980>

    def test_create_deal_validation_errors(client, create_user, create_organization):
        """Invalid inputs are rejected with validation errors."""
>       org = create_organization(name="Deal Org")

tests\test_deal_endpoints.py:63: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_create_deal_sets_owner_and_org _____________________

client = <starlette.testclient.TestClient object at 0x000002DF6F250790>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E97F060>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97E700>

    def test_create_deal_sets_owner_and_org(client, create_user, create_organization):
        """Deal is automatically associated with user's organization and set as owner."""
>       org = create_organization(name="Auto Org")

tests\test_deal_endpoints.py:87: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_create_deal_default_stage ________________________

client = <starlette.testclient.TestClient object at 0x000002DF6F244450>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EA60040>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA61580>

    def test_create_deal_default_stage(client, create_user, create_organization):
        """Deal defaults to 'sourcing' stage if not specified."""
>       org = create_organization(name="Default Org")

tests\test_deal_endpoints.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_list_deals_returns_org_deals_only ____________________

client = <starlette.testclient.TestClient object at 0x000002DF6F363D50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EB9A7A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EBBCAE0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E959F90>

    def test_list_deals_returns_org_deals_only(client, create_user, create_organization, db_session):
        """Users only see deals from their organization (multi-tenant isolation)."""
>       org1 = create_organization(name="Org 1")

tests\test_deal_endpoints.py:153: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_list_deals_pagination_works _______________________

client = <starlette.testclient.TestClient object at 0x000002DF6D0FA350>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FB240>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8FB1A0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E863450>

    def test_list_deals_pagination_works(client, create_user, create_organization, db_session):
        """Pagination returns correct number of items."""
>       org = create_organization(name="Pagination Org")

tests\test_deal_endpoints.py:197: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_list_deals_filter_by_stage _______________________

client = <starlette.testclient.TestClient object at 0x000002DF6F344290>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E9F02C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9F0400>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7024AE10>

    def test_list_deals_filter_by_stage(client, create_user, create_organization, db_session):
        """Users can filter deals by stage."""
>       org = create_organization(name="Filter Org")

tests\test_deal_endpoints.py:239: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_list_deals_search_by_name ________________________

client = <starlette.testclient.TestClient object at 0x000002DF6E89F650>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E9F2700>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9F32E0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F76B6D0>

    def test_list_deals_search_by_name(client, create_user, create_organization, db_session):
        """Users can search deals by name or target company."""
>       org = create_organization(name="Search Org")

tests\test_deal_endpoints.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_list_deals_sort_by_created_at ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6F620210>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EA616C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA62480>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7047F490>

    def test_list_deals_sort_by_created_at(client, create_user, create_organization, db_session):
        """Deals can be sorted by created_at."""
>       org = create_organization(name="Sort Org")

tests\test_deal_endpoints.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_list_deals_excludes_archived ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6E801CD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E97F920>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97F740>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E95FE90>

    def test_list_deals_excludes_archived(client, create_user, create_organization, db_session):
        """Archived deals are hidden by default."""
>       org = create_organization(name="Archive Org")

tests\test_deal_endpoints.py:381: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________________ test_get_deal_success ____________________________

client = <starlette.testclient.TestClient object at 0x000002DF6EB60F10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EB9B7E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EB98040>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBF1510>

    def test_get_deal_success(client, create_user, create_organization, db_session):
        """User can retrieve deal details by ID."""
>       org = create_organization(name="Get Org")

tests\test_deal_endpoints.py:437: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________________ test_get_deal_not_found ___________________________

client = <starlette.testclient.TestClient object at 0x000002DF6ED09110>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EAE8AE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EAEA160>

    def test_get_deal_not_found(client, create_user, create_organization):
        """Non-existent deal returns 404."""
>       org = create_organization(name="404 Org")

tests\test_deal_endpoints.py:481: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_get_deal_forbidden_other_org ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6E8C1910>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E97EC00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97EAC0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DC19D0>

    def test_get_deal_forbidden_other_org(client, create_user, create_organization, db_session):
        """User cannot view deals from other organizations (returns 404 to not leak info)."""
>       org1 = create_organization(name="Org A")

tests\test_deal_endpoints.py:499: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________________ test_update_deal_success ___________________________

client = <starlette.testclient.TestClient object at 0x000002DF6EC1BED0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E8F8220>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8FB600>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBE3290>

    def test_update_deal_success(client, create_user, create_organization, db_session):
        """User can update all deal fields."""
>       org = create_organization(name="Update Org")

tests\test_deal_endpoints.py:546: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________________ test_update_deal_stage_change ________________________

client = <starlette.testclient.TestClient object at 0x000002DF70D47750>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FBD80>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8FA5C0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ED02CD0>

    def test_update_deal_stage_change(client, create_user, create_organization, db_session):
        """User can progress deal through pipeline stages."""
>       org = create_organization(name="Stage Org")

tests\test_deal_endpoints.py:601: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_update_deal_partial_update _______________________

client = <starlette.testclient.TestClient object at 0x000002DF6EA5C310>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E97E200>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97DC60>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FED90>

    def test_update_deal_partial_update(client, create_user, create_organization, db_session):
        """Partial updates work (only specified fields are updated)."""
>       org = create_organization(name="Partial Org")

tests\test_deal_endpoints.py:638: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_update_deal_forbidden_other_org _____________________

client = <starlette.testclient.TestClient object at 0x000002DF6EAF8ED0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E9B56C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9B6980>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA6A350>

    def test_update_deal_forbidden_other_org(client, create_user, create_organization, db_session):
        """User cannot update deals from other organizations."""
>       org1 = create_organization(name="Org X")

tests\test_deal_endpoints.py:679: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_update_deal_validation_errors ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6F76A710>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FADE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8FB380>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D6C58D0>

    def test_update_deal_validation_errors(client, create_user, create_organization, db_session):
        """Invalid update inputs are rejected."""
>       org = create_organization(name="Validation Org")

tests\test_deal_endpoints.py:718: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________________ test_archive_deal_success __________________________

client = <starlette.testclient.TestClient object at 0x000002DF6F268B90>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E97D120>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA28720>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F26AC10>

    def test_archive_deal_success(client, create_user, create_organization, db_session):
        """User can archive a deal (soft delete)."""
>       org = create_organization(name="Archive Org")

tests\test_deal_endpoints.py:759: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_archive_deal_forbidden_other_org ____________________

client = <starlette.testclient.TestClient object at 0x000002DF70249B50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E9F3420>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9F3240>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F620810>

    def test_archive_deal_forbidden_other_org(client, create_user, create_organization, db_session):
        """User cannot archive deals from other organizations."""
>       org1 = create_organization(name="Org P")

tests\test_deal_endpoints.py:797: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________________ test_unarchive_deal_success _________________________

client = <starlette.testclient.TestClient object at 0x000002DF703D97D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6EA6F740>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6EA602C0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E947E50>

    def test_unarchive_deal_success(client, create_user, create_organization, db_session):
        """User can restore an archived deal."""
>       org = create_organization(name="Restore Org")

tests\test_deal_endpoints.py:832: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_unarchive_deal_forbidden_other_org ___________________

client = <starlette.testclient.TestClient object at 0x000002DF6F938F10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E8F9940>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8F87C0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D80BED0>

    def test_unarchive_deal_forbidden_other_org(client, create_user, create_organization, db_session):
        """User cannot restore deals from other organizations."""
>       org1 = create_organization(name="Org R")

tests\test_deal_endpoints.py:869: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestAISuggestionEndpoints.test_fetch_ai_suggestions _____________

self = <test_document_ai_and_versions.TestAISuggestionEndpoints object at 0x000002DF6D19CB50>
client = <starlette.testclient.TestClient object at 0x000002DF6FE91650>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FA020>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8F9760>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70523050>

    def test_fetch_ai_suggestions(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test fetching AI suggestions for a document"""
>       org = create_organization(name="Template Org")

tests\test_document_ai_and_versions.py:29: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestAISuggestionEndpoints.test_accept_ai_suggestion _____________

self = <test_document_ai_and_versions.TestAISuggestionEndpoints object at 0x000002DF6D19D210>
client = <starlette.testclient.TestClient object at 0x000002DF6ECBF810>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E938860>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93BB00>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9DAF10>

    def test_accept_ai_suggestion(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test accepting an AI suggestion"""
>       org = create_organization(name="Template Org")

tests\test_document_ai_and_versions.py:85: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestAISuggestionEndpoints.test_reject_ai_suggestion _____________

self = <test_document_ai_and_versions.TestAISuggestionEndpoints object at 0x000002DF6D19D8D0>
client = <starlette.testclient.TestClient object at 0x000002DF6E7E4B50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F1922A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F192AC0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC9A590>

    def test_reject_ai_suggestion(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test rejecting an AI suggestion"""
>       org = create_organization(name="Template Org")

tests\test_document_ai_and_versions.py:142: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestVersionHistoryEndpoints.test_list_document_versions ___________

self = <test_document_ai_and_versions.TestVersionHistoryEndpoints object at 0x000002DF6D19DF50>
client = <starlette.testclient.TestClient object at 0x000002DF6F489710>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E88B740>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8885E0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECA0890>

    def test_list_document_versions(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test listing document versions"""
>       org = create_organization(name="Template Org")

tests\test_document_ai_and_versions.py:203: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ TestVersionHistoryEndpoints.test_restore_document_version __________

self = <test_document_ai_and_versions.TestVersionHistoryEndpoints object at 0x000002DF6D19E610>
client = <starlette.testclient.TestClient object at 0x000002DF6F2F3F90>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E93A7A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E93BC40>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EC40890>

    def test_restore_document_version(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test restoring a document version"""
>       org = create_organization(name="Template Org")

tests\test_document_ai_and_versions.py:267: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestDocumentTemplateEndpoints.test_create_template ______________

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1F4910>
client = <starlette.testclient.TestClient object at 0x000002DF6EBD1210>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AC719E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC73560>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D6DF2D0>

    def test_create_template(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test creating a new document template"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ TestDocumentTemplateEndpoints.test_create_template_forbidden_other_org ____

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1F5010>
client = <starlette.testclient.TestClient object at 0x000002DF6D6DD850>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AC73B00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC70220>

    def test_create_template_forbidden_other_org(
        self,
        client,
        create_user,
        create_organization,
    ):
        """Test cannot create template for another organization"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:64: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ TestDocumentTemplateEndpoints.test_list_templates ______________

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1F56D0>
client = <starlette.testclient.TestClient object at 0x000002DF6ECA7F10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E939800>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E9393A0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF708EF2D0>

    def test_list_templates(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test listing templates for an organization"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:97: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ TestDocumentTemplateEndpoints.test_list_templates_with_filters ________

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1CE850>
client = <starlette.testclient.TestClient object at 0x000002DF4AF2BC10>
create_user = <function create_user.<locals>._create_user at 0x000002DF4AFC9DA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFCAA20>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E7EA750>

    def test_list_templates_with_filters(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test listing templates with status and type filters"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ TestDocumentTemplateEndpoints.test_get_template _______________

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1F4550>
client = <starlette.testclient.TestClient object at 0x000002DF6F9A7050>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E88BB00>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E889DA0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E95B8D0>

    def test_get_template(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test getting a specific template by ID"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:188: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ TestDocumentTemplateEndpoints.test_get_template_not_found __________

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1F5C10>
client = <starlette.testclient.TestClient object at 0x000002DF6D6DC0D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AC73240>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC736A0>

    def test_get_template_not_found(
        self,
        client,
        create_user,
        create_organization,
    ):
        """Test getting non-existent template returns 404"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestDocumentTemplateEndpoints.test_update_template ______________

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1F5F50>
client = <starlette.testclient.TestClient object at 0x000002DF6EC437D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF4AFCB240>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFC84A0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAF8890>

    def test_update_template(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test updating an existing template"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:243: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestDocumentTemplateEndpoints.test_delete_template ______________

self = <test_document_generation_api.TestDocumentTemplateEndpoints object at 0x000002DF6D1F62D0>
client = <starlette.testclient.TestClient object at 0x000002DF6D7F7AD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E888D60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E888540>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70304A50>

    def test_delete_template(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test archiving a template (soft delete)"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:286: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestDocumentGenerationEndpoints.test_generate_document ____________

self = <test_document_generation_api.TestDocumentGenerationEndpoints object at 0x000002DF6D1F68D0>
client = <starlette.testclient.TestClient object at 0x000002DF6F98BBD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E8FA5C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E8F9B20>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E95D510>

    def test_generate_document(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test generating a document from a template"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:325: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestDocumentGenerationEndpoints.test_generate_document_missing_variables ___

self = <test_document_generation_api.TestDocumentGenerationEndpoints object at 0x000002DF6D1F6F90>
client = <starlette.testclient.TestClient object at 0x000002DF6EB87ED0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E84CA40>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E84D580>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F5E6190>

    def test_generate_document_missing_variables(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test generating document with missing required variables fails"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:377: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestDocumentGenerationEndpoints.test_generate_document_template_not_found __

self = <test_document_generation_api.TestDocumentGenerationEndpoints object at 0x000002DF6D1F7690>
client = <starlette.testclient.TestClient object at 0x000002DF6F7B5AD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E97E520>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97CAE0>

    def test_generate_document_template_not_found(
        self,
        client,
        create_user,
        create_organization,
    ):
        """Test generating from non-existent template returns 404"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:420: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestGeneratedDocumentEndpoints.test_list_generated_documents _________

self = <test_document_generation_api.TestGeneratedDocumentEndpoints object at 0x000002DF6D1F7F10>
client = <starlette.testclient.TestClient object at 0x000002DF6F2468D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF4AFC9260>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFC96C0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D80E850>

    def test_list_generated_documents(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test listing all generated documents"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:452: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestGeneratedDocumentEndpoints.test_get_generated_document __________

self = <test_document_generation_api.TestGeneratedDocumentEndpoints object at 0x000002DF6D1FC610>
client = <starlette.testclient.TestClient object at 0x000002DF6AFE3510>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AC73560>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC70900>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FEED0>

    def test_get_generated_document(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test getting a specific generated document"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:501: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestGeneratedDocumentEndpoints.test_update_document_status __________

self = <test_document_generation_api.TestGeneratedDocumentEndpoints object at 0x000002DF6D1FCCD0>
client = <starlette.testclient.TestClient object at 0x000002DF6D8064D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E7F6200>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F4CC0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECA1110>

    def test_update_document_status(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test updating generated document status"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:546: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestGeneratedDocumentEndpoints.test_update_document_content _________

self = <test_document_generation_api.TestGeneratedDocumentEndpoints object at 0x000002DF6D1FD3D0>
client = <starlette.testclient.TestClient object at 0x000002DF6D805F10>
create_user = <function create_user.<locals>._create_user at 0x000002DF4AFCA160>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF4AFCB920>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E7F3A10>

    def test_update_document_content(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test updating generated document content"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:591: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestTemplateRenderingService.test_complex_template_rendering _________

self = <test_document_generation_api.TestTemplateRenderingService object at 0x000002DF6D1FDB90>
client = <starlette.testclient.TestClient object at 0x000002DF70D46450>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F192660>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AC73CE0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBAD0D0>

    def test_complex_template_rendering(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test rendering a complex template with multiple variables"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:646: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestDocumentExportEndpoints.test_export_document_as_pdf ___________

self = <test_document_generation_api.TestDocumentExportEndpoints object at 0x000002DF6D1FE450>
client = <starlette.testclient.TestClient object at 0x000002DF6F2F2590>
create_user = <function create_user.<locals>._create_user at 0x000002DF6E97EDE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E97FEC0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FF7D0>

    def test_export_document_as_pdf(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test exporting a document as PDF"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:718: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ TestDocumentExportEndpoints.test_export_document_as_docx ___________

self = <test_document_generation_api.TestDocumentExportEndpoints object at 0x000002DF6D1FEB10>
client = <starlette.testclient.TestClient object at 0x000002DF6E963DD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AFE4180>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AFE49A0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E830690>

    def test_export_document_as_docx(
        self,
        client,
        create_user,
        create_organization,
        db_session: Session,
    ):
        """Test exporting a document as DOCX"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:775: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestDocumentExportEndpoints.test_export_document_not_found __________

self = <test_document_generation_api.TestDocumentExportEndpoints object at 0x000002DF6D1FF210>
client = <starlette.testclient.TestClient object at 0x000002DF6E8C98D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AC71800>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6E7F4B80>

    def test_export_document_not_found(
        self,
        client,
        create_user,
        create_organization,
    ):
        """Test exporting non-existent document returns 404"""
>       org = create_organization(name="Template Org")

tests\test_document_generation_api.py:827: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_trim_document_versions_keeps_latest_twenty _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8FCF50>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6F2D36A0>

    @pytest.mark.asyncio
    async def test_trim_document_versions_keeps_latest_twenty(db_session, create_deal_for_org):
        """Ensure only the 20 most recent versions remain and newest upload is preserved."""
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service.py:39: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ test_trim_document_versions_noop_when_within_limit ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7047DF90>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6AFE7BA0>

    @pytest.mark.asyncio
    async def test_trim_document_versions_noop_when_within_limit(db_session, create_deal_for_org):
        """Trimming within the allowed limit should leave documents untouched."""
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_bulk_download_documents_logs_access ___________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002DF6F09CB10>
tmp_path = WindowsPath('C:/Users/User/AppData/Local/Temp/pytest-of-User/pytest-50/test_bulk_download_documents_l0')
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF4AD32690>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6AC73CE0>

    @pytest.mark.asyncio
    async def test_bulk_download_documents_logs_access(monkeypatch, tmp_path, db_session, create_deal_for_org):
        """Bulk download should emit audit logs and include accessible documents."""
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service.py:185: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ test_bulk_download_documents_requires_viewer_permission ___________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002DF6EB14750>
tmp_path = WindowsPath('C:/Users/User/AppData/Local/Temp/pytest-of-User/pytest-50/test_bulk_download_documents_r0')
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FA8C450>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6F2D1A80>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F2D25C0>

    @pytest.mark.asyncio
    async def test_bulk_download_documents_requires_viewer_permission(
        monkeypatch,
        tmp_path,
        db_session,
        create_deal_for_org,
        create_user,
    ):
        """Bulk download should fail when the user lacks viewer permission."""
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service.py:241: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ test_delete_folder_with_documents_raises_value_error _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB6A3D0>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6E88A520>

    def test_delete_folder_with_documents_raises_value_error(
        db_session: Session,
        create_deal_for_org,
    ):
        """
        TDD RED: delete_folder should raise ValueError when folder contains documents
    
        Tests line 854: raise ValueError("Folder is not empty - contains documents")
        """
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service_error_paths.py:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ test_delete_folder_with_subfolders_raises_value_error ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F628E50>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6AFE6C00>

    def test_delete_folder_with_subfolders_raises_value_error(
        db_session: Session,
        create_deal_for_org,
    ):
        """
        TDD RED: delete_folder should raise ValueError when folder contains subfolders
    
        Tests line 862: raise ValueError("Folder is not empty - contains subfolders")
        """
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service_error_paths.py:85: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ test_upload_document_unsupported_file_type __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA2C350>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6AC73E20>

    @pytest.mark.asyncio
    async def test_upload_document_unsupported_file_type(
        db_session: Session,
        create_deal_for_org,
    ):
        """
        TDD RED: upload_document should raise HTTPException for unsupported file types
    
        Tests lines 405-409: Unsupported file type error
        """
        from fastapi import UploadFile
        from io import BytesIO
        from unittest.mock import Mock
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service_error_paths.py:144: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_upload_document_file_size_exceeds_limit _________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8D8A10>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6AFE6480>

    @pytest.mark.asyncio
    async def test_upload_document_file_size_exceeds_limit(
        db_session: Session,
        create_deal_for_org,
    ):
        """
        TDD RED: upload_document should raise HTTPException for files exceeding size limit
    
        Tests lines 415-419: File size exceeds limit error
        """
        from fastapi import UploadFile
        from io import BytesIO
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service_error_paths.py:178: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ test_create_folder_insufficient_permissions_for_subfolder __________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E93D910>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6F2D13A0>

    def test_create_folder_insufficient_permissions_for_subfolder(
        db_session: Session,
        create_deal_for_org,
    ):
        """
        TDD RED: create_folder should raise HTTPException when user lacks permissions for subfolder
    
        Tests lines 349-352: Insufficient permissions error for subfolder creation
        """
        from app.schemas.document import FolderCreate
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service_error_paths.py:210: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ test_create_folder_non_owner_cannot_create_top_level _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D80BFD0>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6AFE6660>

    def test_create_folder_non_owner_cannot_create_top_level(
        db_session: Session,
        create_deal_for_org,
    ):
        """
        TDD RED: create_folder should raise HTTPException when non-owner tries to create top-level folder
    
        Tests lines 354-358: Only deal owners can create top-level folders
        """
        from app.schemas.document import FolderCreate
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service_error_paths.py:262: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ test_upload_document_non_owner_cannot_upload_to_root _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FA4B290>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF4AFC9580>

    @pytest.mark.asyncio
    async def test_upload_document_non_owner_cannot_upload_to_root(
        db_session: Session,
        create_deal_for_org,
    ):
        """
        TDD RED: upload_document should raise HTTPException when non-owner tries to upload to root
    
        Tests lines 399-403: Only deal owners can upload to root data room
        """
        from fastapi import UploadFile
        from io import BytesIO
    
>       deal, owner, organization = create_deal_for_org()

tests\test_document_service_error_paths.py:304: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ TestEventTicketModel.test_ticket_requires_event _______________

self = <test_event_models.TestEventTicketModel object at 0x000002DF6D250510>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E894C10>

    def test_ticket_requires_event(self, db_session):
        """Test that ticket requires event_id"""
>       ticket = EventTicket(
            id=str(uuid4()),
            event_id=None,  # Missing event
            name="Test Ticket",
            price=50.00,
            currency="GBP",
            organization_id=str(uuid4()),
            created_by_user_id=str(uuid4()),
        )

tests\test_event_models.py:173: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestEventRegistrationModel.test_registration_requires_event_and_user _____

self = <test_event_models.TestEventRegistrationModel object at 0x000002DF6D251410>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E803210>

    def test_registration_requires_event_and_user(self, db_session):
        """Test that registration requires event_id and user_id"""
>       registration = EventRegistration(
            id=str(uuid4()),
            event_id=None,  # Missing event
            attendee_name="Test User",
            attendee_email="test@example.com",
            status=RegistrationStatus.CONFIRMED,
            organization_id=str(uuid4()),
        )

tests\test_event_models.py:213: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ TestEventSessionModel.test_session_requires_event ______________

self = <test_event_models.TestEventSessionModel object at 0x000002DF6D252290>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FA81F50>

    def test_session_requires_event(self, db_session):
        """Test that session requires event_id"""
>       session = EventSession(
            id=str(uuid4()),
            event_id=None,  # Missing event
            name="Test Session",
            start_time=datetime.now(),
            end_time=datetime.now() + timedelta(hours=1),
            organization_id=str(uuid4()),
            created_by_user_id=str(uuid4()),
        )

tests\test_event_models.py:253: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_create_financial_connection _______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8DB610>

    def test_create_financial_connection(db_session: Session):
        """Test creating a basic financial connection."""
        # Arrange
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-1",
            deal_id="deal-1",
        )

tests\test_financial_models_sync.py:76: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_financial_connection_cascade_delete ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FA5E150>

    def test_financial_connection_cascade_delete(db_session: Session):
        """Test that deleting a deal cascades to delete financial connections."""
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-2",
            deal_id="deal-2",
        )

tests\test_financial_models_sync.py:102: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_create_financial_statement_balance_sheet ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A58A90>

    def test_create_financial_statement_balance_sheet(db_session: Session):
        """Test creating a balance sheet statement."""
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-3",
            deal_id="deal-3",
        )

tests\test_financial_models_sync.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_financial_statement_with_json_fields __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD74D10>

    def test_financial_statement_with_json_fields(db_session: Session):
        """Test statement with JSON fields (raw_data, missing_fields)."""
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-4",
            deal_id="deal-4",
        )

tests\test_financial_models_sync.py:175: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________________ test_create_financial_ratios _________________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E905FD0>

    def test_create_financial_ratios(db_session: Session):
        """Test creating financial ratios with all 47 fields."""
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-5",
            deal_id="deal-5",
        )

tests\test_financial_models_sync.py:215: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_financial_ratio_nullable_fields _____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA6B290>

    def test_financial_ratio_nullable_fields(db_session: Session):
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-6",
            deal_id="deal-6",
        )

tests\test_financial_models_sync.py:254: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_create_financial_narrative _______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7B5490>

    def test_create_financial_narrative(db_session: Session):
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-7",
            deal_id="deal-7",
        )

tests\test_financial_models_sync.py:292: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_financial_narrative_version_control ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70AFAF10>

    def test_financial_narrative_version_control(db_session: Session):
>       org, _, deal = seed_org_user_deal(
            db_session,
            org_id="org-8",
            deal_id="deal-8",
        )

tests\test_financial_models_sync.py:313: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_financial_models_sync.py:39: in seed_org_user_deal
    org = Organization(**org_data)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_complete_financial_data_chain ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F298A90>

    def test_complete_financial_data_chain(db_session: Session):
        """Test complete chain: Deal \u2192 Connection \u2192 Statement \u2192 Ratios \u2192 Narrative."""
>       org = Organization(id="org-9", name="Org 9", slug="org-9-slug")

tests\test_financial_models_sync.py:349: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_cascade_delete_all_financial_data ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F30E210>

    def test_cascade_delete_all_financial_data(db_session: Session):
        """Test that deleting a deal cascades to all financial data."""
>       org = Organization(id="org-10", name="Org 10", slug="org-10-slug")

tests\test_financial_models_sync.py:391: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_generate_financial_narrative_success __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B202950>

    @pytest.mark.asyncio
    async def test_generate_financial_narrative_success(db_session):
        """Test successful narrative generation with mocked OpenAI."""
        # Create test data
>       org = Organization(id="org-narrative-1", name="Test Org", slug="test-org")

tests\test_financial_narrative_service.py:281: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ test_generate_financial_narrative_returns_existing_by_default ________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8F4150>

    @pytest.mark.asyncio
    async def test_generate_financial_narrative_returns_existing_by_default(db_session):
        """Test that generate_financial_narrative returns existing narrative without regenerate flag."""
        # Create test data
>       org = Organization(id="org-narrative-2", name="Test Org 2", slug="test-org-2")

tests\test_financial_narrative_service.py:382: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ test_generate_financial_narrative_raises_error_when_no_data _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D191E10>

    @pytest.mark.asyncio
    async def test_generate_financial_narrative_raises_error_when_no_data(db_session):
        """Test that generate_financial_narrative raises error when no financial data exists."""
        # Create deal without financial data
>       org = Organization(id="org-narrative-3", name="Test Org 3", slug="test-org-3")

tests\test_financial_narrative_service.py:430: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ test_generate_financial_narrative_raises_error_when_deal_not_found ______

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F9D9750>

    @pytest.mark.asyncio
    async def test_generate_financial_narrative_raises_error_when_deal_not_found(db_session):
        """Test that generate_financial_narrative raises error for non-existent deal."""
        with pytest.raises(ValueError, match="Deal .* not found"):
>           await generate_financial_narrative("nonexistent-deal-id", db_session)

tests\test_financial_narrative_service.py:452: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\financial_narrative_service.py:437: in generate_financial_narrative
    result = db.execute(select(Deal).where(Deal.id == deal_id))
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_create_financial_connection _______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F955090>

    def test_create_financial_connection(db_session: Session):
>       organization, user, deal = _seed_org_user_deal(
            db_session,
            org_id="org-fc-1",
            deal_id="deal-fc-1",
            owner_id="user-fc-123",
        )

tests\test_models_financial_connection.py:53: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_models_financial_connection.py:23: in _seed_org_user_deal
    organization = Organization(id=org_id, name=f"Org {org_id}", slug=org_id)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_financial_connection_with_optional_fields ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E897E50>

    def test_financial_connection_with_optional_fields(db_session: Session):
>       organization, user, deal = _seed_org_user_deal(
            db_session,
            org_id="org-fc-2",
            deal_id="deal-fc-2",
            owner_id="user-fc-456",
        )

tests\test_models_financial_connection.py:76: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_models_financial_connection.py:23: in _seed_org_user_deal
    organization = Organization(id=org_id, name=f"Org {org_id}", slug=org_id)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ test_financial_connection_cascade_delete_with_deal ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D193510>

    def test_financial_connection_cascade_delete_with_deal(db_session: Session):
>       organization, user, deal = _seed_org_user_deal(
            db_session,
            org_id="org-fc-3",
            deal_id="deal-fc-3",
            owner_id="user-fc-789",
        )

tests\test_models_financial_connection.py:102: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_models_financial_connection.py:23: in _seed_org_user_deal
    organization = Organization(id=org_id, name=f"Org {org_id}", slug=org_id)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_financial_connection_relationship_to_deal ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FD4D0>

    def test_financial_connection_relationship_to_deal(db_session: Session):
>       organization, user, deal = _seed_org_user_deal(
            db_session,
            org_id="org-fc-4",
            deal_id="deal-fc-4",
            owner_id="user-fc-rel",
        )

tests\test_models_financial_connection.py:126: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_models_financial_connection.py:23: in _seed_org_user_deal
    organization = Organization(id=org_id, name=f"Org {org_id}", slug=org_id)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_financial_connection_soft_delete ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705FFFD0>

    def test_financial_connection_soft_delete(db_session: Session):
>       organization, user, deal = _seed_org_user_deal(
            db_session,
            org_id="org-fc-5",
            deal_id="deal-fc-5",
            owner_id="user-fc-soft",
        )

tests\test_models_financial_connection.py:149: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_models_financial_connection.py:23: in _seed_org_user_deal
    organization = Organization(id=org_id, name=f"Org {org_id}", slug=org_id)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_financial_connection_status_values ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A46590>

    def test_financial_connection_status_values(db_session: Session):
>       organization, user, deal = _seed_org_user_deal(
            db_session,
            org_id="org-fc-6",
            deal_id="deal-fc-6",
            owner_id="user-fc-status",
        )

tests\test_models_financial_connection.py:173: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_models_financial_connection.py:23: in _seed_org_user_deal
    organization = Organization(id=org_id, name=f"Org {org_id}", slug=org_id)
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestOrganizationService.test_upsert_from_clerk_creates_with_defaults _____

self = <test_organization_service.TestOrganizationService object at 0x000002DF6D30CDD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ABDF50>

    def test_upsert_from_clerk_creates_with_defaults(self, db_session: Session) -> None:
>       org = upsert_from_clerk(db_session, {"id": "org_100"})

tests\test_organization_service.py:15: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\organization_service.py:73: in upsert_from_clerk
    organization = db.get(Organization, org_id)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestOrganizationService.test_upsert_from_clerk_normalizes_subscription_tier _

self = <test_organization_service.TestOrganizationService object at 0x000002DF6D30D490>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDFD490>

    def test_upsert_from_clerk_normalizes_subscription_tier(self, db_session: Session) -> None:
>       org = upsert_from_clerk(
            db_session,
            {
                "id": "org_professional",
                "name": "Professional Org",
                "public_metadata": {"subscription_tier": "Professional"},
            },
        )

tests\test_organization_service.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\organization_service.py:73: in upsert_from_clerk
    organization = db.get(Organization, org_id)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestOrganizationService.test_upsert_from_clerk_falls_back_to_starter_on_invalid_tier _

self = <test_organization_service.TestOrganizationService object at 0x000002DF6D2FDD90>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D0C1B90>

    def test_upsert_from_clerk_falls_back_to_starter_on_invalid_tier(self, db_session: Session) -> None:
>       first = upsert_from_clerk(
            db_session,
            {
                "id": "org_invalid",
                "name": "Initial Org",
                "public_metadata": {"subscription_tier": "premium"},
            },
        )

tests\test_organization_service.py:36: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\organization_service.py:73: in upsert_from_clerk
    organization = db.get(Organization, org_id)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestOrganizationService.test_upsert_from_clerk_generates_unique_slug _____

self = <test_organization_service.TestOrganizationService object at 0x000002DF6D30C850>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7024A650>

    def test_upsert_from_clerk_generates_unique_slug(self, db_session: Session) -> None:
>       first = upsert_from_clerk(
            db_session,
            {
                "id": "org_slug_1",
                "name": "Acme Corp",
                "slug": "acme-corp",
            },
        )

tests\test_organization_service.py:58: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\organization_service.py:73: in upsert_from_clerk
    organization = db.get(Organization, org_id)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ TestOrganizationService.test_deactivate_organization_marks_inactive _____

self = <test_organization_service.TestOrganizationService object at 0x000002DF6D30D110>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70782110>

    def test_deactivate_organization_marks_inactive(self, db_session: Session) -> None:
>       org = upsert_from_clerk(
            db_session,
            {
                "id": "org_deactivate",
                "name": "Deactivate Org",
            },
        )

tests\test_organization_service.py:80: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\organization_service.py:73: in upsert_from_clerk
    organization = db.get(Organization, org_id)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestPodcastEpisodeCreation.test_starter_user_blocked_from_creating_episode __

self = <test_podcast_api.TestPodcastEpisodeCreation object at 0x000002DF6D341B90>
client = <starlette.testclient.TestClient object at 0x000002DF70523950>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A1760>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3A31A0>

    def test_starter_user_blocked_from_creating_episode(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="starter")

tests\test_podcast_api.py:47: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ TestPodcastEpisodeCreation.test_quota_service_passes_db_session _______

self = <test_podcast_api.TestPodcastEpisodeCreation object at 0x000002DF6D341F50>
client = <starlette.testclient.TestClient object at 0x000002DF705C17D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3D96C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3D9580>

    def test_quota_service_passes_db_session(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:81: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestPodcastEpisodeCreation.test_professional_user_can_create_episode _____

self = <test_podcast_api.TestPodcastEpisodeCreation object at 0x000002DF6D342510>
client = <starlette.testclient.TestClient object at 0x000002DF6E89CB10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F31A660>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F319300>

    def test_professional_user_can_create_episode(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:114: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestPodcastEpisodeCreation.test_professional_user_quota_exceeded_returns_429 _

self = <test_podcast_api.TestPodcastEpisodeCreation object at 0x000002DF6D342C50>
client = <starlette.testclient.TestClient object at 0x000002DF6F38EA50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F90E520>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F90C220>

    def test_professional_user_quota_exceeded_returns_429(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:154: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestPodcastEpisodeCreation.test_professional_user_blocked_from_video_episode _

self = <test_podcast_api.TestPodcastEpisodeCreation object at 0x000002DF6D343350>
client = <starlette.testclient.TestClient object at 0x000002DF6F8A0D10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3DB100>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3D8F40>

    def test_professional_user_blocked_from_video_episode(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:183: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestPodcastEpisodeCreation.test_premium_user_can_create_video_episode ____

self = <test_podcast_api.TestPodcastEpisodeCreation object at 0x000002DF6D343A50>
client = <starlette.testclient.TestClient object at 0x000002DF6F299CD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F90D800>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F90CFE0>

    def test_premium_user_can_create_video_episode(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:214: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestPodcastListEndpoint.test_list_episodes_returns_organizations_episodes __

self = <test_podcast_api.TestPodcastListEndpoint object at 0x000002DF6D34DD10>
client = <starlette.testclient.TestClient object at 0x000002DF707C5490>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA8B1A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA8BD80>

    def test_list_episodes_returns_organizations_episodes(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:683: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestPodcastListEndpoint.test_list_episodes_filters_by_status _________

self = <test_podcast_api.TestPodcastListEndpoint object at 0x000002DF6D34CA90>
client = <starlette.testclient.TestClient object at 0x000002DF6E7FEA50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F9A2AC0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F9A39C0>

    def test_list_episodes_filters_by_status(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:711: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestPodcastGetSingleEndpoint.test_get_single_episode_returns_episode _____

self = <test_podcast_api.TestPodcastGetSingleEndpoint object at 0x000002DF6D34C590>
client = <starlette.testclient.TestClient object at 0x000002DF6ED02210>
create_user = <function create_user.<locals>._create_user at 0x000002DF70AF3880>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF7009A2A0>

    def test_get_single_episode_returns_episode(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:742: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestPodcastGetSingleEndpoint.test_get_single_episode_returns_404_when_not_found _

self = <test_podcast_api.TestPodcastGetSingleEndpoint object at 0x000002DF6D34E610>
client = <starlette.testclient.TestClient object at 0x000002DF6F363DD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA91C60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA90180>

    def test_get_single_episode_returns_404_when_not_found(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:787: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestPodcastUpdateEndpoint.test_update_episode_modifies_fields ________

self = <test_podcast_api.TestPodcastUpdateEndpoint object at 0x000002DF6D34EED0>
client = <starlette.testclient.TestClient object at 0x000002DF6FE92F10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F31A660>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F31AD40>

    def test_update_episode_modifies_fields(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:817: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestPodcastDeleteEndpoint.test_delete_episode_removes_episode ________

self = <test_podcast_api.TestPodcastDeleteEndpoint object at 0x000002DF6D34F710>
client = <starlette.testclient.TestClient object at 0x000002DF6F2F0590>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A2B60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3A3920>

    def test_delete_episode_removes_episode(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:864: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestPodcastDeleteEndpoint.test_delete_episode_returns_404_when_not_found ___

self = <test_podcast_api.TestPodcastDeleteEndpoint object at 0x000002DF6D34FE10>
client = <starlette.testclient.TestClient object at 0x000002DF705C4C10>
create_user = <function create_user.<locals>._create_user at 0x000002DF7009ADE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF70099B20>

    def test_delete_episode_returns_404_when_not_found(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:896: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ TestPodcastYouTubeUpload.test_premium_user_can_publish_video_to_youtube ___

self = <test_podcast_api.TestPodcastYouTubeUpload object at 0x000002DF6D358790>
client = <starlette.testclient.TestClient object at 0x000002DF6F361E90>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A3060>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3A2D40>

    def test_premium_user_can_publish_video_to_youtube(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:926: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestPodcastYouTubeUpload.test_podcast_youtube_upload_requires_video_asset __

self = <test_podcast_api.TestPodcastYouTubeUpload object at 0x000002DF6D358E90>
client = <starlette.testclient.TestClient object at 0x000002DF6D251590>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA93EC0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA93560>

    def test_podcast_youtube_upload_requires_video_asset(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:985: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestPodcastYouTubeUpload.test_youtube_upload_permission_error_returns_403 __

self = <test_podcast_api.TestPodcastYouTubeUpload object at 0x000002DF6D359590>
client = <starlette.testclient.TestClient object at 0x000002DF7047F550>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F318220>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FD585E0>

    def test_youtube_upload_permission_error_returns_403(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:1023: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestAudioUpload.test_upload_audio_professional_success ____________

self = <test_podcast_api.TestAudioUpload object at 0x000002DF6D35B3D0>
client = <starlette.testclient.TestClient object at 0x000002DF70DA7150>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA91760>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA92A20>

    def test_upload_audio_professional_success(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
        """Test Professional tier can upload audio files."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1183: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ TestAudioUpload.test_upload_audio_starter_blocked ______________

self = <test_podcast_api.TestAudioUpload object at 0x000002DF6D35BAD0>
client = <starlette.testclient.TestClient object at 0x000002DF6E85E550>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AFE67A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AFE51C0>

    def test_upload_audio_starter_blocked(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
        """Test Starter tier cannot upload audio files."""
>       org = create_organization(subscription_tier="starter")

tests\test_podcast_api.py:1236: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestAudioUpload.test_upload_audio_validates_file_format ___________

self = <test_podcast_api.TestAudioUpload object at 0x000002DF6D35BA90>
client = <starlette.testclient.TestClient object at 0x000002DF6F1A0FD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F9A3BA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F9A0FE0>

    def test_upload_audio_validates_file_format(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
        """Test endpoint validates audio file format (MP3, WAV, M4A only)."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1275: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestAudioUpload.test_upload_audio_validates_file_size ____________

self = <test_podcast_api.TestAudioUpload object at 0x000002DF6D35B2D0>
client = <starlette.testclient.TestClient object at 0x000002DF7005E150>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A0040>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3A3060>

    def test_upload_audio_validates_file_size(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
        """Test endpoint validates file size (max 500MB)."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1315: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestAudioUpload.test_upload_audio_updates_episode_audio_url _________

self = <test_podcast_api.TestAudioUpload object at 0x000002DF6D35A810>
client = <starlette.testclient.TestClient object at 0x000002DF6E800F10>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA937E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA90720>

    def test_upload_audio_updates_episode_audio_url(
        self,
        client,
        create_user,
        create_organization,
    ) -> None:
        """Test successful upload updates episode's audio_file_url."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1367: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ TestVideoUpload.test_upload_video_premium_success ______________

self = <test_podcast_api.TestVideoUpload object at 0x000002DF6D3599D0>
client = <starlette.testclient.TestClient object at 0x000002DF6F1BECD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3DBE20>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3DBBA0>

    def test_upload_video_premium_success(
        self, client, create_user, create_organization
    ):
        """Test Premium tier can upload video files."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:1402: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestVideoUpload.test_upload_video_professional_blocked ____________

self = <test_podcast_api.TestVideoUpload object at 0x000002DF6D358590>
client = <starlette.testclient.TestClient object at 0x000002DF6FD0C610>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A1DA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3A2700>

    def test_upload_video_professional_blocked(
        self, client, create_user, create_organization
    ):
        """Test Professional tier cannot upload video files (403)."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1449: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestVideoUpload.test_upload_video_validates_file_format ___________

self = <test_podcast_api.TestVideoUpload object at 0x000002DF6D34F510>
client = <starlette.testclient.TestClient object at 0x000002DF70057AD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AFE49A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AFE60C0>

    def test_upload_video_validates_file_format(
        self, client, create_user, create_organization
    ):
        """Test only MP4/MOV formats are accepted."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:1480: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestVideoUpload.test_upload_video_validates_file_size ____________

self = <test_podcast_api.TestVideoUpload object at 0x000002DF6D364210>
client = <starlette.testclient.TestClient object at 0x000002DF70DF43D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3D99E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3DAD40>

    def test_upload_video_validates_file_size(
        self, client, create_user, create_organization
    ):
        """Test endpoint validates file size (max 2GB)."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:1516: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestVideoUpload.test_upload_video_generates_thumbnail ____________

self = <test_podcast_api.TestVideoUpload object at 0x000002DF6D364910>
client = <starlette.testclient.TestClient object at 0x000002DF6F977B50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F9A0FE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F9A2520>

    def test_upload_video_generates_thumbnail(
        self, client, create_user, create_organization
    ):
        """Uploading video should trigger thumbnail generation and persist thumbnail_url."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:1568: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestVideoUpload.test_upload_video_accepts_mov_format _____________

self = <test_podcast_api.TestVideoUpload object at 0x000002DF6D365010>
client = <starlette.testclient.TestClient object at 0x000002DF6E9C9B90>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA920C0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA90A40>

    def test_upload_video_accepts_mov_format(
        self, client, create_user, create_organization
    ):
        """MOV uploads should be accepted for premium users."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:1615: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestVideoUpload.test_upload_video_updates_episode_video_url _________

self = <test_podcast_api.TestVideoUpload object at 0x000002DF6D365710>
client = <starlette.testclient.TestClient object at 0x000002DF6EA68ED0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F90CA40>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F90C900>

    def test_upload_video_updates_episode_video_url(
        self, client, create_user, create_organization
    ):
        """Test successful upload updates episode's video_file_url."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:1662: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestTranscription.test_transcribe_audio_professional_success _________

self = <test_podcast_api.TestTranscription object at 0x000002DF6D365ED0>
client = <starlette.testclient.TestClient object at 0x000002DF6F360310>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AFE6FC0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AFE49A0>

    def test_transcribe_audio_professional_success(
        self, client, create_user, create_organization
    ):
        """Test Professional+ tier can transcribe audio files."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1715: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ TestTranscription.test_transcribe_starter_blocked ______________

self = <test_podcast_api.TestTranscription object at 0x000002DF6D3665D0>
client = <starlette.testclient.TestClient object at 0x000002DF6D80EA90>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A1EE0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FD584A0>

    def test_transcribe_starter_blocked(
        self, client, create_user, create_organization
    ):
        """Test Starter tier cannot transcribe (403)."""
>       org = create_organization(subscription_tier="starter")

tests\test_podcast_api.py:1760: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestTranscription.test_transcribe_requires_audio_file ____________

self = <test_podcast_api.TestTranscription object at 0x000002DF6D366CD0>
client = <starlette.testclient.TestClient object at 0x000002DF6EC3CDD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AFE5A80>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AFE4360>

    def test_transcribe_requires_audio_file(
        self, client, create_user, create_organization
    ):
        """Test transcription requires audio file to be uploaded first."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1784: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestTranscription.test_transcribe_updates_episode_transcript _________

self = <test_podcast_api.TestTranscription object at 0x000002DF6D367410>
client = <starlette.testclient.TestClient object at 0x000002DF6FD16F90>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3DA020>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3D84A0>

    def test_transcribe_updates_episode_transcript(
        self, client, create_user, create_organization
    ):
        """Test successful transcription updates episode's transcript field."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1821: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestTranscription.test_transcribe_handles_whisper_api_error _________

self = <test_podcast_api.TestTranscription object at 0x000002DF6D367B10>
client = <starlette.testclient.TestClient object at 0x000002DF6EBF2FD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A3100>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3A2AC0>

    def test_transcribe_handles_whisper_api_error(
        self, client, create_user, create_organization
    ):
        """Test graceful handling of Whisper API errors."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1867: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestTranscription.test_transcribe_multi_language_requires_enterprise _____

self = <test_podcast_api.TestTranscription object at 0x000002DF6D36C250>
client = <starlette.testclient.TestClient object at 0x000002DF6D251D50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA919E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA90040>

    def test_transcribe_multi_language_requires_enterprise(
        self, client, create_user, create_organization
    ) -> None:
        """Requesting non-English transcription should require enterprise tier."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1907: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ TestTranscription.test_transcribe_multi_language_enterprise_success _____

self = <test_podcast_api.TestTranscription object at 0x000002DF6D36C950>
client = <starlette.testclient.TestClient object at 0x000002DF6EAEEBD0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6AFE44A0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6AFE5BC0>

    def test_transcribe_multi_language_enterprise_success(
        self, client, create_user, create_organization
    ) -> None:
        """Enterprise tier can transcribe with alternate language and persist metadata."""
>       org = create_organization(subscription_tier="enterprise")

tests\test_podcast_api.py:1948: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestTranscription.test_transcribe_response_includes_metadata _________

self = <test_podcast_api.TestTranscription object at 0x000002DF6D36D050>
client = <starlette.testclient.TestClient object at 0x000002DF6D7F5E50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA93240>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA92B60>

    def test_transcribe_response_includes_metadata(
        self, client, create_user, create_organization
    ):
        """Transcription response should include language + word count metadata."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:1998: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestTranscriptDownload.test_download_transcript_txt_success _________

self = <test_podcast_api.TestTranscriptDownload object at 0x000002DF6D36D8D0>
client = <starlette.testclient.TestClient object at 0x000002DF6F5E7550>
create_user = <function create_user.<locals>._create_user at 0x000002DF700C8D60>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF700CB060>

    def test_download_transcript_txt_success(
        self, client, create_user, create_organization
    ):
        """Test downloading transcript in TXT format."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:2051: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestTranscriptDownload.test_download_transcript_srt_success _________

self = <test_podcast_api.TestTranscriptDownload object at 0x000002DF6D3679D0>
client = <starlette.testclient.TestClient object at 0x000002DF70780990>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3A1940>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3A2A20>

    def test_download_transcript_srt_success(
        self, client, create_user, create_organization
    ):
        """Test downloading transcript in SRT format."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:2089: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ TestTranscriptDownload.test_download_transcript_requires_transcript _____

self = <test_podcast_api.TestTranscriptDownload object at 0x000002DF6D364E10>
client = <starlette.testclient.TestClient object at 0x000002DF6D809590>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA91300>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA90900>

    def test_download_transcript_requires_transcript(
        self, client, create_user, create_organization
    ):
        """Test downloading transcript when none exists."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:2129: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ TestTranscriptDownload.test_download_transcript_starter_blocked _______

self = <test_podcast_api.TestTranscriptDownload object at 0x000002DF6D35B750>
client = <starlette.testclient.TestClient object at 0x000002DF7001DF50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3D8EA0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3DAAC0>

    def test_download_transcript_starter_blocked(
        self, client, create_user, create_organization
    ):
        """Test Starter tier cannot download transcripts."""
>       org = create_organization(subscription_tier="starter")

tests\test_podcast_api.py:2166: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ TestThumbnailGeneration.test_generate_thumbnail_premium_success _______

self = <test_podcast_api.TestThumbnailGeneration object at 0x000002DF6D36D7D0>
client = <starlette.testclient.TestClient object at 0x000002DF700541D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF6FA914E0>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA90040>

    def test_generate_thumbnail_premium_success(
        self, client, create_user, create_organization
    ):
        """Test Premium tier can generate video thumbnails."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:2195: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ TestThumbnailGeneration.test_generate_thumbnail_requires_video ________

self = <test_podcast_api.TestThumbnailGeneration object at 0x000002DF6D36CC50>
client = <starlette.testclient.TestClient object at 0x000002DF6E80FC10>
create_user = <function create_user.<locals>._create_user at 0x000002DF700C9580>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF700CA200>

    def test_generate_thumbnail_requires_video(
        self, client, create_user, create_organization
    ):
        """Test thumbnail generation requires video file."""
>       org = create_organization(subscription_tier="premium")

tests\test_podcast_api.py:2236: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestThumbnailGeneration.test_generate_thumbnail_professional_blocked _____

self = <test_podcast_api.TestThumbnailGeneration object at 0x000002DF6D36DC90>
client = <starlette.testclient.TestClient object at 0x000002DF6F27AB50>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F3D8220>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6F3DB600>

    def test_generate_thumbnail_professional_blocked(
        self, client, create_user, create_organization
    ):
        """Test Professional tier cannot generate thumbnails (video feature)."""
>       org = create_organization(subscription_tier="professional")

tests\test_podcast_api.py:2269: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ TestPodcastService.test_create_episode ____________________

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D36FD50>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705C1210>

    def test_create_episode(self, db_session: Session):
        """Creating a podcast episode should persist core metadata."""
    
>       _ensure_org_and_user(
            db_session,
            organization_id="org-abc",
            user_id="user-123",
        )

tests\test_podcast_service.py:66: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:336: in _ensure_org_and_user
    organization = db.get(Organization, organization_id)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestPodcastService.test_get_episodes_filters_by_status ____________

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37C450>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF72593D90>

    def test_get_episodes_filters_by_status(self, db_session: Session):
        """Episodes should be filterable by publication status."""
    
>       create_test_episode(db_session, organization_id="org-abc", status="draft")

tests\test_podcast_service.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestPodcastService.test_publish_episode_sets_timestamp ____________

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37CB10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ADCAD0>

    def test_publish_episode_sets_timestamp(self, db_session: Session):
        """Publishing an episode should update status and published_at."""
    
>       episode = create_test_episode(db_session, organization_id="org-abc", status="draft")

tests\test_podcast_service.py:110: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestPodcastService.test_transcribe_episode_uses_whisper ___________

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37D250>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBAD150>
audio_file = WindowsPath('C:/Users/User/AppData/Local/Temp/pytest-of-User/pytest-50/test_transcribe_episode_uses_w0/sample-episode.mp3')

    @pytest.mark.asyncio
    async def test_transcribe_episode_uses_whisper(self, db_session: Session, audio_file: Path):
        """Transcribing an episode should create transcript records using Whisper."""
    
        Base.metadata.create_all(db_session.get_bind(), checkfirst=True)
    
>       episode = create_test_episode(db_session, organization_id="org-abc")

tests\test_podcast_service.py:127: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______ TestPodcastService.test_transcribe_episode_requires_entitlement _______

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37D910>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD2BD90>
audio_file = WindowsPath('C:/Users/User/AppData/Local/Temp/pytest-of-User/pytest-50/test_transcribe_episode_requir0/sample-episode.mp3')

    @pytest.mark.asyncio
    async def test_transcribe_episode_requires_entitlement(self, db_session: Session, audio_file: Path):
        """Transcription should be blocked when organization lacks entitlement."""
    
        Base.metadata.create_all(db_session.get_bind(), checkfirst=True)
    
>       episode = create_test_episode(db_session, organization_id="org-abc")

tests\test_podcast_service.py:171: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestPodcastService.test_get_episode_analytics_aggregates_platform_totals ___

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37DFD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E98CA50>

    def test_get_episode_analytics_aggregates_platform_totals(self, db_session: Session):
        """Analytics should aggregate listens/downloads across platforms."""
    
>       episode = create_test_episode(db_session, organization_id="org-abc")

tests\test_podcast_service.py:195: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestPodcastService.test_generate_rss_feed_includes_published_episodes ____

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37E690>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EAE4C10>

    def test_generate_rss_feed_includes_published_episodes(self, db_session: Session):
        """Generated RSS feed should list only published episodes ordered by recency."""
    
>       published = create_test_episode(
            db_session,
            title="Published Episode",
            status="published",
            organization_id="org-abc",
        )

tests\test_podcast_service.py:213: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ TestPodcastService.test_multi_tenant_isolation ________________

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37ED50>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E98C1D0>

    def test_multi_tenant_isolation(self, db_session: Session):
        """Episodes from other organizations should not be accessible."""
    
>       episode = create_test_episode(db_session, organization_id="org-abc")

tests\test_podcast_service.py:237: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestPodcastService.test_update_episode_mutates_fields ____________

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37F410>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA42C50>

    def test_update_episode_mutates_fields(self, db_session: Session):
        """Updating an episode should mutate provided fields and persist changes."""
    
>       episode = create_test_episode(db_session, organization_id="org-abc", title="Original Title")

tests\test_podcast_service.py:249: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestPodcastService.test_delete_episode_removes_record ____________

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37FA90>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF72593310>

    def test_delete_episode_removes_record(self, db_session: Session):
        """Deleting an episode should remove it and return True."""
    
>       episode = create_test_episode(db_session, organization_id="org-abc")

tests\test_podcast_service.py:268: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_podcast_service.py:310: in create_test_episode
    episode = podcast_service.create_episode(
app\services\podcast_service.py:45: in create_episode
    episode = PodcastEpisode(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ TestPodcastService.test_transcribe_episode_missing_episode_raises ______

self = <test_podcast_service.TestPodcastService object at 0x000002DF6D37FA10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70574E90>
audio_file = WindowsPath('C:/Users/User/AppData/Local/Temp/pytest-of-User/pytest-50/test_transcribe_episode_missin0/sample-episode.mp3')

    @pytest.mark.asyncio
    async def test_transcribe_episode_missing_episode_raises(self, db_session: Session, audio_file: Path):
        """Attempting to transcribe missing episode should raise ValueError."""
    
        with pytest.raises(ValueError):
>           await podcast_service.transcribe_episode(
                db=db_session,
                episode_id=str(uuid4()),
                audio_file_path=str(audio_file),
                organization_id="org-abc",
            )

tests\test_podcast_service.py:287: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\podcast_service.py:168: in transcribe_episode
    episode = get_episode(db=db, episode_id=episode_id, organization_id=organization_id)
app\services\podcast_service.py:98: in get_episode
    return db.scalar(stmt)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2358: in scalar
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ TestIncrementEpisodeCount.test_increments_usage_count_in_database ______

self = <test_quota_service.TestIncrementEpisodeCount object at 0x000002DF6D3AD650>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D809310>

    @async_test
    async def test_increments_usage_count_in_database(self, db_session) -> None:
        org_id = "org_123"
        current_month = datetime.now(UTC).replace(day=1, hour=0, minute=0, second=0, microsecond=0)
    
>       usage = PodcastUsage(
            organization_id=org_id,
            month=current_month,
            episode_count=5,
        )

tests\test_quota_service.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestIncrementEpisodeCount.test_sync_session_increments_usage _________

self = <test_quota_service.TestIncrementEpisodeCount object at 0x000002DF6D3ADC90>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F96B0D0>

    @async_test
    async def test_sync_session_increments_usage(self, db_session) -> None:
        org_id = "org_sync"
        current_month = datetime.now(UTC).replace(day=1, hour=0, minute=0, second=0, microsecond=0)
    
>       usage = PodcastUsage(
            organization_id=org_id,
            month=current_month,
            episode_count=2,
        )

tests\test_quota_service.py:195: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestIncrementEpisodeCount.test_creates_new_usage_record_for_first_episode __

self = <test_quota_service.TestIncrementEpisodeCount object at 0x000002DF6D3AE2D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F974A50>

    @async_test
    async def test_creates_new_usage_record_for_first_episode(self, db_session) -> None:
        org_id = "org_new"
        current_month = datetime.now(UTC).replace(day=1, hour=0, minute=0, second=0, microsecond=0)
    
>       await increment_episode_count(org_id, db_session)

tests\test_quota_service.py:220: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\quota_service.py:143: in increment_episode_count
    result = db.execute(stmt)  # type: ignore[arg-type]
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestGetMonthlyUsage.test_returns_current_month_usage_count __________

self = <test_quota_service.TestGetMonthlyUsage object at 0x000002DF6D3AEAD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F252550>

    @async_test
    async def test_returns_current_month_usage_count(self, db_session) -> None:
        org_id = "org_123"
        current_month = datetime.now(UTC).replace(day=1, hour=0, minute=0, second=0, microsecond=0)
    
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=current_month,
            episode_count=5,
        )

tests\test_quota_service.py:241: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestGetMonthlyUsage.test_sync_session_returns_usage _____________

self = <test_quota_service.TestGetMonthlyUsage object at 0x000002DF6D3AF110>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E95CA90>

    @async_test
    async def test_sync_session_returns_usage(self, db_session) -> None:
        org_id = "org_sync"
        current_month = datetime.now(UTC).replace(day=1, hour=0, minute=0, second=0, microsecond=0)
    
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=current_month,
            episode_count=4,
        )

tests\test_quota_service.py:258: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestGetMonthlyUsage.test_returns_zero_when_no_usage_records _________

self = <test_quota_service.TestGetMonthlyUsage object at 0x000002DF6D3AF750>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70AFA390>

    @async_test
    async def test_returns_zero_when_no_usage_records(self, db_session) -> None:
        org_id = "org_new"
    
>       usage = await get_monthly_usage(org_id, db_session)

tests\test_quota_service.py:274: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\quota_service.py:172: in get_monthly_usage
    return _query_usage_sync(organization_id, db)  # type: ignore[arg-type]
app\services\quota_service.py:199: in _query_usage_sync
    result = db.execute(stmt)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2570: in to_compile_state
    _ColumnEntity._for_columns(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2917: in _for_columns
    _ORMColumnEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:3131: in __init__
    _entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestGetQuotaSummary.test_usage_resets_when_new_month_starts _________

self = <test_quota_service.TestGetQuotaSummary object at 0x000002DF6D3B8CD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D39F290>

    @async_test
    async def test_usage_resets_when_new_month_starts(self, db_session) -> None:
        """Ensure previous month usage does not count toward current month quota."""
    
        org_id = "org_reset"
        previous_month = datetime(2025, 9, 1, tzinfo=UTC)
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=previous_month,
            episode_count=10,
        )

tests\test_quota_service.py:439: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ TestResetMonthlyUsage.test_reset_monthly_usage_creates_zero_record ______

self = <test_quota_service.TestResetMonthlyUsage object at 0x000002DF6D3BA1D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B202A10>

    @async_test
    async def test_reset_monthly_usage_creates_zero_record(self, db_session) -> None:
        org_id = "org_reset_helper"
        previous_month = datetime(2025, 9, 1, tzinfo=UTC)
    
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=previous_month,
            episode_count=7,
        )

tests\test_quota_service.py:501: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ TestResetMonthlyUsage.test_reset_monthly_usage_is_idempotent _________

self = <test_quota_service.TestResetMonthlyUsage object at 0x000002DF6D3BA810>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE93AD0>

    @async_test
    async def test_reset_monthly_usage_is_idempotent(self, db_session) -> None:
        org_id = "org_reset_idempotent"
        current_month = datetime(2025, 10, 1, tzinfo=UTC)
    
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=current_month,
            episode_count=3,
        )

tests\test_quota_service.py:535: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestMonthlyQuotaReset.test_quota_resets_when_new_billing_cycle_starts ____

self = <test_quota_service.TestMonthlyQuotaReset object at 0x000002DF6D3BB010>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F335F10>

    @async_test
    async def test_quota_resets_when_new_billing_cycle_starts(self, db_session) -> None:
        """Test that quota automatically resets when checking in a new month."""
        org_id = "org_reset_test"
    
        # Create usage record for previous month (September 2025)
        previous_month = datetime(2025, 9, 1, tzinfo=UTC)
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=previous_month,
            episode_count=10,  # Hit quota limit in September
        )

tests\test_quota_service.py:564: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ TestMonthlyQuotaReset.test_usage_count_returns_zero_in_new_month _______

self = <test_quota_service.TestMonthlyQuotaReset object at 0x000002DF6D3BB650>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7006C750>

    @async_test
    async def test_usage_count_returns_zero_in_new_month(self, db_session) -> None:
        """Test that get_monthly_usage returns 0 when checking a new month with stale data."""
        org_id = "org_usage_reset"
    
        # Create usage record for previous month
        previous_month = datetime(2025, 8, 1, tzinfo=UTC)
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=previous_month,
            episode_count=8,
        )

tests\test_quota_service.py:609: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ TestMonthlyQuotaReset.test_remaining_quota_resets_after_month_boundary ____

self = <test_quota_service.TestMonthlyQuotaReset object at 0x000002DF6D3BBC90>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7061B1D0>

    @async_test
    async def test_remaining_quota_resets_after_month_boundary(self, db_session) -> None:
        """Test that get_remaining_quota returns full quota in new month."""
        org_id = "org_remaining_reset"
    
        # Create usage record for previous month at quota limit
        previous_month = datetime(2025, 7, 1, tzinfo=UTC)
>       usage_record = PodcastUsage(
            organization_id=org_id,
            month=previous_month,
            episode_count=10,
        )

tests\test_quota_service.py:629: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_subscription_tier_enum_values ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDF8CD0>

    def test_subscription_tier_enum_values(db_session):
        """Test all subscription tier enum values are valid."""
        from uuid import uuid4
    
        tiers = [
            SubscriptionTier.STARTER,
            SubscriptionTier.PROFESSIONAL,
            SubscriptionTier.ENTERPRISE,
            SubscriptionTier.COMMUNITY,
        ]
    
        # Create separate organization for each tier since org_id must be unique
        for tier in tiers:
>           org = Organization(
                id=f"test-org-{tier.value}",
                name=f"{tier.value.title()} Tier Org",
                slug=f"{tier.value}-org-{uuid4().hex[:6]}",
                subscription_tier=tier.value,
            )

tests\test_subscription_model.py:71: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_create_checkout_session_with_invalid_tier ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707FB550>

    def test_create_checkout_session_with_invalid_tier(db_session: Session):
        """Test create_checkout_session rejects invalid tier."""
>       org = Organization(
            id="org_invalid_tier",
            name="Invalid Tier Org",
            slug="invalid-tier",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ test_create_checkout_session_with_missing_organization ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FCECD10>

    def test_create_checkout_session_with_missing_organization(db_session: Session):
        """Test create_checkout_session rejects nonexistent organization."""
        with pytest.raises(ValueError, match="Organization not found"):
>           subscription_service.create_checkout_session(
                organization_id="org_does_not_exist",
                tier=SubscriptionTier.PROFESSIONAL,
                db=db_session
            )

tests\test_subscription_service_edge_cases.py:43: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\subscription_service.py:128: in create_checkout_session
    result = _execute(db, select(Organization).where(Organization.id == organization_id))
app\services\subscription_service.py:114: in _execute
    return db.execute(statement)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ test_create_checkout_session_with_annual_billing _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F1A2590>

    def test_create_checkout_session_with_annual_billing(db_session: Session):
        """Test create_checkout_session uses annual price ID for annual billing."""
>       org = Organization(
            id="org_annual",
            name="Annual Billing Org",
            slug="annual",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:62: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________ test_create_checkout_session_reuses_existing_customer_id ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F968E90>

    def test_create_checkout_session_reuses_existing_customer_id(db_session: Session):
        """Test create_checkout_session reuses existing Stripe customer ID."""
>       org = Organization(
            id="org_existing_customer",
            name="Existing Customer Org",
            slug="existing",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_create_checkout_session_with_custom_urls ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70D3CDD0>

    def test_create_checkout_session_with_custom_urls(db_session: Session):
        """Test create_checkout_session accepts custom success/cancel URLs."""
>       org = Organization(
            id="org_custom_urls",
            name="Custom URLs Org",
            slug="custom",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:130: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ test_update_subscription_tier_with_no_subscription ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F363390>

    def test_update_subscription_tier_with_no_subscription(db_session: Session):
        """Test update_subscription_tier rejects org with no subscription."""
>       org = Organization(
            id="org_no_sub",
            name="No Subscription Org",
            slug="no-sub",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:171: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ test_update_subscription_tier_with_no_stripe_subscription_id _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70DDC510>

    def test_update_subscription_tier_with_no_stripe_subscription_id(db_session: Session):
        """Test update_subscription_tier rejects subscription without Stripe ID."""
>       org = Organization(
            id="org_no_stripe_id",
            name="No Stripe ID Org",
            slug="no-stripe",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:190: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_update_subscription_tier_with_invalid_tier _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D2FF6D0>

    def test_update_subscription_tier_with_invalid_tier(db_session: Session):
        """Test update_subscription_tier rejects invalid tier."""
>       org = Organization(
            id="org_invalid_new_tier",
            name="Invalid New Tier Org",
            slug="invalid-new",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:218: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_update_subscription_tier_without_proration _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8DBF50>

    def test_update_subscription_tier_without_proration(db_session: Session):
        """Test update_subscription_tier can disable proration."""
>       org = Organization(
            id="org_no_prorate",
            name="No Prorate Org",
            slug="no-prorate",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:246: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ test_update_subscription_tier_prorates_by_default ______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E86A810>

    def test_update_subscription_tier_prorates_by_default(db_session: Session):
        """Test update_subscription_tier uses proration when not explicitly disabled."""
>       org = Organization(
            id="org_prorate_default",
            name="Prorate Default Org",
            slug="prorate-default",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:283: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_cancel_subscription_with_no_subscription ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D3BB210>

    def test_cancel_subscription_with_no_subscription(db_session: Session):
        """Test cancel_subscription rejects org with no subscription."""
>       org = Organization(
            id="org_cancel_no_sub",
            name="Cancel No Sub Org",
            slug="cancel-no-sub",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:328: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ test_cancel_subscription_with_no_stripe_subscription_id ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D7EA750>

    def test_cancel_subscription_with_no_stripe_subscription_id(db_session: Session):
        """Test cancel_subscription rejects subscription without Stripe ID."""
>       org = Organization(
            id="org_cancel_no_stripe",
            name="Cancel No Stripe Org",
            slug="cancel-no-stripe",
            subscription_tier="starter"
        )

tests\test_subscription_service_edge_cases.py:346: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_cancel_subscription_immediately _____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705CBE50>

    def test_cancel_subscription_immediately(db_session: Session):
        """Test cancel_subscription with immediately=True deletes subscription."""
>       org = Organization(
            id="org_cancel_immediate",
            name="Cancel Immediate Org",
            slug="cancel-immediate",
            subscription_tier="professional"
        )

tests\test_subscription_service_edge_cases.py:373: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_cancel_subscription_at_period_end ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F2F0890>

    def test_cancel_subscription_at_period_end(db_session: Session):
        """Test cancel_subscription with immediately=False schedules cancellation."""
>       org = Organization(
            id="org_cancel_period_end",
            name="Cancel Period End Org",
            slug="cancel-period-end",
            subscription_tier="professional"
        )

tests\test_subscription_service_edge_cases.py:410: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ test_create_billing_portal_requires_active_subscription ___________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E8CEFD0>

    def test_create_billing_portal_requires_active_subscription(db_session: Session):
        """Test create_billing_portal_session rejects organizations without a subscription."""
>       org = Organization(
            id="org_portal_no_sub",
            name="Portal No Sub Org",
            slug="portal-no-sub",
            subscription_tier="starter",
        )

tests\test_subscription_service_edge_cases.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________ test_create_billing_portal_requires_customer_id _______________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B1B5B10>

    def test_create_billing_portal_requires_customer_id(db_session: Session):
        """Test create_billing_portal_session rejects subscriptions without Stripe customer ID."""
>       org = Organization(
            id="org_portal_no_customer",
            name="Portal No Customer Org",
            slug="portal-no-customer",
            subscription_tier="starter",
        )

tests\test_subscription_service_edge_cases.py:475: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ test_create_billing_portal_session_success __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70AFA250>

    def test_create_billing_portal_session_success(db_session: Session):
        """Test create_billing_portal_session returns Stripe billing portal URL."""
>       org = Organization(
            id="org_portal_success",
            name="Portal Success Org",
            slug="portal-success",
            subscription_tier="starter",
        )

tests\test_subscription_service_edge_cases.py:502: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________ test_handle_checkout_completed_with_no_existing_subscription _________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6B1B6410>

    def test_handle_checkout_completed_with_no_existing_subscription(db_session: Session):
        """Test handle_checkout_completed when subscription doesn't exist."""
        event_data = {
            "object": {
                "metadata": {"organization_id": "org_nonexistent"},
                "subscription": "sub_new",
                "customer": "cus_new"
            }
        }
    
        with patch('stripe.Subscription.retrieve') as mock_retrieve:
            mock_retrieve.return_value = {
                "current_period_start": int(datetime.now(timezone.utc).timestamp()),
                "current_period_end": int((datetime.now(timezone.utc) + timedelta(days=30)).timestamp())
            }
    
            # Should not raise, just return silently
>           subscription_service.handle_checkout_completed(event_data, db_session)

tests\test_subscription_service_edge_cases.py:554: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\subscription_service.py:304: in handle_checkout_completed
    result = _execute(db, select(Subscription).where(Subscription.organization_id == organization_id))
app\services\subscription_service.py:114: in _execute
    return db.execute(statement)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_handle_invoice_paid_with_no_subscription ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70D7A010>

    def test_handle_invoice_paid_with_no_subscription(db_session: Session):
        """Test handle_invoice_paid when customer has no subscription."""
        event_data = {
            "object": {
                "id": "in_test",
                "customer": "cus_nonexistent",
                "amount_paid": 59800,
                "currency": "gbp",
                "status_transitions": {"paid_at": int(datetime.now(timezone.utc).timestamp())}
            }
        }
    
        # Should not raise, just return silently
>       subscription_service.handle_invoice_paid(event_data, db_session)

tests\test_subscription_service_edge_cases.py:570: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\subscription_service.py:325: in handle_invoice_paid
    result = _execute(db, select(Subscription).where(Subscription.stripe_customer_id == stripe_customer_id))
app\services\subscription_service.py:114: in _execute
    return db.execute(statement)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ test_handle_subscription_updated_with_no_subscription ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FD76ED0>

    def test_handle_subscription_updated_with_no_subscription(db_session: Session):
        """Test handle_subscription_updated when subscription doesn't exist."""
        event_data = {
            "object": {
                "id": "sub_nonexistent",
                "status": "active",
                "current_period_start": int(datetime.now(timezone.utc).timestamp()),
                "current_period_end": int((datetime.now(timezone.utc) + timedelta(days=30)).timestamp()),
                "cancel_at_period_end": False
            }
        }
    
        # Should not raise, just return silently
>       subscription_service.handle_subscription_updated(event_data, db_session)

tests\test_subscription_service_edge_cases.py:586: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\subscription_service.py:348: in handle_subscription_updated
    result = _execute(db, select(Subscription).where(Subscription.stripe_subscription_id == stripe_subscription_id))
app\services\subscription_service.py:114: in _execute
    return db.execute(statement)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ test_handle_subscription_deleted_with_no_subscription ____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D4290D0>

    def test_handle_subscription_deleted_with_no_subscription(db_session: Session):
        """Test handle_subscription_deleted when subscription doesn't exist."""
        event_data = {
            "object": {
                "id": "sub_nonexistent"
            }
        }
    
        # Should not raise, just return silently
>       subscription_service.handle_subscription_deleted(event_data, db_session)

tests\test_subscription_service_edge_cases.py:598: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\subscription_service.py:371: in handle_subscription_deleted
    result = _execute(db, select(Subscription).where(Subscription.stripe_subscription_id == stripe_subscription_id))
app\services\subscription_service.py:114: in _execute
    return db.execute(statement)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____ test_get_organization_subscription_returns_none_for_nonexistent_org _____

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ADC2D0>

    def test_get_organization_subscription_returns_none_for_nonexistent_org(db_session: Session):
        """Test get_organization_subscription returns None for nonexistent org."""
>       result = subscription_service.get_organization_subscription("org_nonexistent", db_session)

tests\test_subscription_service_edge_cases.py:611: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\subscription_service.py:233: in get_organization_subscription
    .options(selectinload(Subscription.organization)),
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\strategy_options.py:2407: in selectinload
    return _generate_from_keys(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\strategy_options.py:2305: in _generate_from_keys
    lead_element = Load(lead_entity)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\strategy_options.py:1012: in __init__
    insp._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______ TestValuationServiceOps.test_create_valuation_calculates_metrics _______

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D52F6D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705928D0>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF4AFC8360>

    def test_create_valuation_calculates_metrics(self, db_session, valuation_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:211: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestValuationServiceOps.test_update_valuation_recalculates __________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D52FE10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701E2190>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70777E20>

    def test_update_valuation_recalculates(self, db_session, valuation_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:228: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestValuationServiceOps.test_add_comparable_records _____________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D538510>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FCEE1D0>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
comparable_payload = {'company_name': 'Peer Co', 'ev_ebitda_multiple': 8.4, 'weight': 1.0}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6FA9A2A0>

    def test_add_comparable_records(self, db_session, valuation_payload, comparable_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:253: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________ TestValuationServiceOps.test_add_precedent_records ______________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D538C10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF4AF2AB10>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
precedent_payload = {'acquirer_company': 'Buyer Inc', 'deal_value': 18000000, 'ev_ebitda_multiple': 7.6, 'target_company': 'Target Co', ...}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70D04360>

    def test_add_precedent_records(self, db_session, valuation_payload, precedent_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:275: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ TestValuationServiceOps.test_create_scenario_persists ____________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D539350>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6ECEBB10>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF707B8040>

    def test_create_scenario_persists(self, db_session, valuation_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:297: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestValuationServiceOps.test_generate_export_log_entry ____________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D539A90>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70A47C50>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70D004A0>

    def test_generate_export_log_entry(self, db_session, valuation_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:321: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________ TestValuationServiceOps.test_delete_valuation_cascades ____________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D52E150>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF707C6190>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
comparable_payload = {'company_name': 'Peer Co', 'ev_ebitda_multiple': 8.4, 'weight': 1.0}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF707BB920>

    def test_delete_valuation_cascades(self, db_session, valuation_payload, comparable_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:348: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestValuationServiceOps.test_calculate_comparable_multiples _________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D539A50>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6E98C310>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70D03A60>

    def test_calculate_comparable_multiples(self, db_session, valuation_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:377: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________ TestValuationServiceOps.test_calculate_precedent_multiples __________

self = <test_valuation_crud.TestValuationServiceOps object at 0x000002DF6D538A90>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FEC6590>
valuation_payload = {'cash_flows': [500000, 650000, 800000, 950000, 1100000], 'discount_rate': 0.12, 'forecast_years': 5, 'net_debt': 2000000, ...}
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF707BA480>

    def test_calculate_precedent_multiples(self, db_session, valuation_payload, create_deal_for_org):
        from app.services import valuation_service
    
>       deal, owner, org = create_deal_for_org()

tests\test_valuation_crud.py:416: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestValuationServiceOperations.test_log_export_event_persists_document_reference _

self = <test_valuation_service.TestValuationServiceOperations object at 0x000002DF6D566110>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FEC4390>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70D177E0>

    def test_log_export_event_persists_document_reference(
        self,
        db_session,
        create_deal_for_org,
    ):
>       deal, owner, _ = create_deal_for_org()

tests\test_valuation_service.py:621: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestValuationServiceOperations.test_log_export_event_rejects_foreign_document _

self = <test_valuation_service.TestValuationServiceOperations object at 0x000002DF6D565450>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB7A090>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF6FA99080>
create_organization = <function create_organization.<locals>._create_org at 0x000002DF6FA9B1A0>

    def test_log_export_event_rejects_foreign_document(
        self,
        db_session,
        create_deal_for_org,
        create_organization,
    ):
>       deal, owner, _ = create_deal_for_org()

tests\test_valuation_service.py:659: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestValuationServiceOperations.test_log_export_event_accepts_valid_scenario _

self = <test_valuation_service.TestValuationServiceOperations object at 0x000002DF6D566A50>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F973550>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70D58680>

    def test_log_export_event_accepts_valid_scenario(
        self,
        db_session,
        create_deal_for_org,
    ):
>       deal, owner, _ = create_deal_for_org()

tests\test_valuation_service.py:697: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestValuationServiceOperations.test_log_export_event_rejects_scenario_from_other_valuation _

self = <test_valuation_service.TestValuationServiceOperations object at 0x000002DF6D567150>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705D0810>
create_deal_for_org = <function create_deal_for_org.<locals>._create at 0x000002DF70DADEE0>

    def test_log_export_event_rejects_scenario_from_other_valuation(
        self,
        db_session,
        create_deal_for_org,
    ):
>       deal, owner, _ = create_deal_for_org()

tests\test_valuation_service.py:738: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:599: in _create
    owner_user = request.getfixturevalue("growth_user")
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:585: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:607: in _get_active_fixturedef
    self._compute_fixture_value(fixturedef)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:693: in _compute_fixture_value
    fixturedef.execute(request=subrequest)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1069: in execute
    result = ihook.pytest_fixture_setup(fixturedef=self, request=request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:53: in run_old_style_hookwrapper
    return result.get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pluggy\_callers.py:38: in run_old_style_hookwrapper
    res = yield
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:1123: in pytest_fixture_setup
    result = call_fixture_func(fixturefunc, request, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\_pytest\fixtures.py:902: in call_fixture_func
    fixture_result = fixturefunc(**kwargs)
tests\conftest.py:542: in growth_user
    org = create_organization(subscription_tier="growth")
tests\conftest.py:268: in _create_org
    org = Organization(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestGoToMarketKpis.test_ensure_test_reference_entities_noop_when_not_test __

self = <test_valuation_service.TestGoToMarketKpis object at 0x000002DF6D568750>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FEC13D0>
monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002DF43187D10>

    def test_ensure_test_reference_entities_noop_when_not_test(self, db_session, monkeypatch):
        org_id = str(uuid4())
        user_id = str(uuid4())
        monkeypatch.setattr(settings, "environment", "production")
    
        valuation_service._ensure_test_reference_entities(
            db_session,
            organization_id=org_id,
            user_id=user_id,
        )
    
>       assert db_session.get(Organization, org_id) is None

tests\test_valuation_service.py:841: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestGoToMarketKpis.test_ensure_test_reference_entities_creates_placeholders _

self = <test_valuation_service.TestGoToMarketKpis object at 0x000002DF6D568E50>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D567B90>
monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002DF70DA7C90>

    def test_ensure_test_reference_entities_creates_placeholders(self, db_session, monkeypatch):
        org_id = str(uuid4())
        user_id = str(uuid4())
        monkeypatch.setattr(settings, "environment", "test")
    
>       valuation_service._ensure_test_reference_entities(
            db_session,
            organization_id=org_id,
            user_id=user_id,
        )

tests\test_valuation_service.py:849: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\valuation_service.py:128: in _ensure_test_reference_entities
    if organization_id and db.get(Organization, organization_id) is None:
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3653: in get
    return self._get_impl(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:3833: in _get_impl
    return db_load_fn(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py:690: in load_on_pk_identity
    session.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________ test_initiate_xero_oauth_generates_authorization_url _____________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701F7A50>

    def test_initiate_xero_oauth_generates_authorization_url(db_session):
        """Test that initiating OAuth returns Xero authorization URL."""
        # Arrange
>       org = Organization(id="org-1", name="Test Org", slug="test-org")

tests\test_xero_oauth_service.py:37: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ test_initiate_xero_oauth_with_invalid_deal __________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE5E510>

    def test_initiate_xero_oauth_with_invalid_deal(db_session):
        """Test that initiating OAuth with invalid deal raises error."""
        with pytest.raises(ValueError, match="Deal .* not found"):
>           initiate_xero_oauth("invalid-deal-id", db_session)

tests\test_xero_oauth_service.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
app\services\xero_oauth_service.py:259: in initiate_xero_oauth
    result = db.execute(select(Deal).where(Deal.id == deal_id))
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_handle_xero_callback_success ______________________

mock_xero_client = <MagicMock name='xero_client' id='3158056310800'>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE5F3D0>

    @patch("app.services.xero_oauth_service.xero_client")
    def test_handle_xero_callback_success(mock_xero_client, db_session):
        """Test successful OAuth callback creates connection with tokens."""
        # Arrange
>       org = Organization(id="org-2", name="Org 2", slug="org-2")

tests\test_xero_oauth_service.py:68: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ test_handle_xero_callback_token_exchange_failure _______________

mock_xero_client = <MagicMock name='xero_client' id='3158694537744'>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EBEDA50>

    @patch("app.services.xero_oauth_service.xero_client")
    def test_handle_xero_callback_token_exchange_failure(mock_xero_client, db_session):
        """Test OAuth callback when Xero token exchange fails."""
>       org = Organization(id="org-3", name="Org 3", slug="org-3")

tests\test_xero_oauth_service.py:114: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_refresh_xero_token_success _______________________

mock_xero_client = <MagicMock name='xero_client' id='3158678583760'>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D428BD0>

    @patch("app.services.xero_oauth_service.xero_client")
    def test_refresh_xero_token_success(mock_xero_client, db_session):
        """Test successful token refresh updates connection."""
        # Arrange
>       org = Organization(id="org-4", name="Org 4", slug="org-4")

tests\test_xero_oauth_service.py:142: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________ test_refresh_xero_token_when_refresh_fails __________________

mock_xero_client = <MagicMock name='xero_client' id='3158657563088'>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE5F2D0>

    @patch("app.services.xero_oauth_service.xero_client")
    def test_refresh_xero_token_when_refresh_fails(mock_xero_client, db_session):
        """Test token refresh failure marks connection as expired."""
>       org = Organization(id="org-5", name="Org 5", slug="org-5")

tests\test_xero_oauth_service.py:186: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________ test_fetch_xero_statements_imports_balance_sheet _______________

mock_xero_client = <MagicMock name='xero_client' id='3158675008208'>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EA5DD10>

    @patch("app.services.xero_oauth_service.xero_client")
    def test_fetch_xero_statements_imports_balance_sheet(mock_xero_client, db_session):
        """Test fetching statements from Xero imports balance sheet data."""
>       org = Organization(id="org-6", name="Org 6", slug="org-6")

tests\test_xero_oauth_service.py:225: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_fetch_xero_statements_with_expired_token ________________

mock_xero_client = <MagicMock name='xero_client' id='3158691259344'>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70ABBAD0>

    @patch("app.services.xero_oauth_service.xero_client")
    def test_fetch_xero_statements_with_expired_token(mock_xero_client, db_session):
        """Test fetching statements auto-refreshes expired token."""
>       org = Organization(id="org-7", name="Org 7", slug="org-7")

tests\test_xero_oauth_service.py:302: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_disconnect_xero_removes_connection ___________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6D405790>

    def test_disconnect_xero_removes_connection(db_session):
        """Test disconnecting Xero deletes connection record."""
>       org = Organization(id="org-8", name="Org 8", slug="org-8")

tests\test_xero_oauth_service.py:349: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___________________ test_get_xero_connection_status_active ____________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF705C5790>

    def test_get_xero_connection_status_active(db_session):
        """Test getting connection status for active Xero connection."""
>       org = Organization(id="org-9", name="Org 9", slug="org-9")

tests\test_xero_oauth_service.py:382: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
________________ test_get_xero_connection_status_not_connected ________________

db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F7FEA10>

    def test_get_xero_connection_status_not_connected(db_session):
        """Test getting connection status when no Xero connection exists."""
>       org = Organization(id="org-10", name="Org 10", slug="org-10")

tests\test_xero_oauth_service.py:417: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__________________ test_list_blog_categories_empty_database ___________________

client = <starlette.testclient.TestClient object at 0x000002DF6D0B5110>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7069F9D0>

    def test_list_blog_categories_empty_database(client: TestClient, db_session: Session):
>       response = client.get("/api/blog/categories/list")

tests\api\test_blog.py:214: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:499: in get
    return super().get(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1054: in get
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:193: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py:41: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py:33: in run_sync
    return await get_asynclib().run_sync_in_worker_thread(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py:877: in run_sync_in_worker_thread
    return await future
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py:807: in run
    result = context.run(func, *args)
app\api\routes\blog.py:149: in list_categories
    result = db.execute(query)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2570: in to_compile_state
    _ColumnEntity._for_columns(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2917: in _for_columns
    _ORMColumnEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:3131: in __init__
    _entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_list_blog_posts_returns_200 _______________________

client = <starlette.testclient.TestClient object at 0x000002DF6E7E4550>

    def test_list_blog_posts_returns_200(client: TestClient):
        """Test that /api/blog endpoint returns 200 OK (not 500)."""
>       response = client.get("/api/blog?limit=5")

tests\api\test_blog_api.py:15: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:499: in get
    return super().get(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1054: in get
    return self.request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:465: in request
    return super().request(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:827: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1015: in _send_single_request
    response = transport.handle_request(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:342: in handle_request
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\from_thread.py:217: in _call_func
    retval = await retval
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:193: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\concurrency.py:41: in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\to_thread.py:33: in run_sync
    return await get_asynclib().run_sync_in_worker_thread(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py:877: in run_sync_in_worker_thread
    return await future
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py:807: in run
    result = context.run(func, *args)
app\api\routes\blog.py:82: in list_blog_posts
    result = db.execute(query)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:293: in orm_execute_statement
    result = conn.execute(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1416: in execute
    return meth(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:516: in _execute_on_connection
    return connection._execute_clauseelement(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:1631: in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:704: in _compile_w_cache
    compiled_sql = self._compiler(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py:316: in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:1426: in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:867: in __init__
    self.string = self.process(self.statement, **compile_kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:912: in process
    return obj._compiler_dispatch(self, **kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\visitors.py:143: in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\compiler.py:4590: in visit_select
    compile_state = select_stmt._compile_state_factory(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\base.py:687: in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:1091: in create_for_statement
    _QueryEntity.to_compile_state(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2537: in to_compile_state
    _MapperEntity(
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\context.py:2617: in __init__
    entity._post_inspect
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:1260: in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2707: in _post_inspect
    self._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_list_blog_posts_with_data ________________________

client = <starlette.testclient.TestClient object at 0x000002DF7062A890>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70024A50>

    def test_list_blog_posts_with_data(client: TestClient, db_session: Session):
        """Test that blog API returns posts when data exists."""
        # Create test blog post
>       test_post = BlogPost(
            title="Test M&A Post",
            slug="test-ma-post",
            excerpt="Test excerpt for M&A strategy",
            content="# Full content\n\nTest content for M&A post.",
            category="M&A Strategy",
            primary_keyword="M&A testing",
            secondary_keywords="testing,tdd,bmad",
            meta_description="Test meta description",
            author="Test Author",
            read_time_minutes=5,
            published=True,
            featured_image_url="https://example.com/test.jpg",
        )

tests\api\test_blog_api.py:25: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____________________ test_list_blog_posts_category_filter _____________________

client = <starlette.testclient.TestClient object at 0x000002DF6FBB1290>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70442C10>

    def test_list_blog_posts_category_filter(client: TestClient, db_session: Session):
        """Test filtering blog posts by category."""
        # Create posts in different categories
>       fpa_post = BlogPost(
            title="FP&A Best Practices",
            slug="fpa-best-practices",
            excerpt="FP&A excerpt",
            content="FP&A content",
            category="FP&A",
            primary_keyword="FP&A",
            meta_description="FP&A meta",
            author="Test Author",
            read_time_minutes=5,
            published=True,
        )

tests\api\test_blog_api.py:60: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_________________________ test_list_blog_posts_search _________________________

client = <starlette.testclient.TestClient object at 0x000002DF6D5851D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FE3AC10>

    def test_list_blog_posts_search(client: TestClient, db_session: Session):
        """Test searching blog posts by keyword."""
>       searchable_post = BlogPost(
            title="Ultimate Guide to M&A Valuation",
            slug="ma-valuation-guide",
            excerpt="Comprehensive valuation guide",
            content="Detailed valuation methodologies...",
            category="M&A Strategy",
            primary_keyword="valuation",
            meta_description="Valuation guide",
            author="Test Author",
            read_time_minutes=10,
            published=True,
        )

tests\api\test_blog_api.py:99: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_______________________ test_list_blog_posts_pagination _______________________

client = <starlette.testclient.TestClient object at 0x000002DF700CEBD0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF702B7DD0>

    def test_list_blog_posts_pagination(client: TestClient, db_session: Session):
        """Test blog post pagination."""
        # Create multiple posts
        for i in range(15):
>           post = BlogPost(
                title=f"Test Post {i}",
                slug=f"test-post-{i}",
                excerpt=f"Excerpt {i}",
                content=f"Content {i}",
                category="M&A Strategy",
                primary_keyword=f"keyword{i}",
                meta_description=f"Meta {i}",
                author="Test Author",
                read_time_minutes=5,
                published=True,
            )

tests\api\test_blog_api.py:126: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_____________________ test_list_blog_posts_published_only _____________________

client = <starlette.testclient.TestClient object at 0x000002DF70ABD950>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F78D110>

    def test_list_blog_posts_published_only(client: TestClient, db_session: Session):
        """Test that only published posts are returned by default."""
>       published_post = BlogPost(
            title="Published Post",
            slug="published-post",
            excerpt="Published excerpt",
            content="Published content",
            category="M&A Strategy",
            primary_keyword="published",
            meta_description="Published meta",
            author="Test Author",
            read_time_minutes=5,
            published=True,
        )

tests\api\test_blog_api.py:156: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
______________________ test_submit_contact_form_success _______________________

client = <starlette.testclient.TestClient object at 0x000002DF707C4690>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701DDA10>

    def test_submit_contact_form_success(client: TestClient, db_session: Session) -> None:
        payload = {
            "name": "Jane Doe",
            "email": "jane@example.com",
            "company": "Growth Co",
            "message": "We would like to schedule a platform demo for next week.",
        }
    
        response = client.post("/api/marketing/contact", json=payload)
>       assert response.status_code == 200
E       assert 500 == 200
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

tests\api\test_marketing.py:17: AssertionError
------------------------------ Captured log call ------------------------------
ERROR    app.api.routes.marketing:marketing.py:150 Error submitting contact form: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
______________________ test_subscribe_newsletter_success ______________________

client = <starlette.testclient.TestClient object at 0x000002DF6F6B76D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FBEF410>

    def test_subscribe_newsletter_success(client: TestClient, db_session: Session) -> None:
        payload = {"email": "subscriber@example.com", "source": "sticky-cta"}
    
        response = client.post("/api/marketing/subscribe", json=payload)
>       assert response.status_code == 200
E       assert 500 == 200
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

tests\api\test_marketing.py:45: AssertionError
------------------------------ Captured log call ------------------------------
ERROR    app.api.routes.marketing:marketing.py:199 Error subscribing to newsletter: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
___________________ test_subscribe_newsletter_is_idempotent ___________________

client = <starlette.testclient.TestClient object at 0x000002DF6F30D590>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6EB19950>

    def test_subscribe_newsletter_is_idempotent(client: TestClient, db_session: Session) -> None:
        email = "subscriber@example.com"
>       first = NewsletterSubscription(email=email, source="popup")

tests\api\test_marketing.py:60: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestRBACAuditServiceLogging.test_log_role_change_creates_audit_entry _____

self = <test_rbac_permissions.TestRBACAuditServiceLogging object at 0x000002DF6D62E4D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6F86E550>
create_user = <function create_user.<locals>._create_user at 0x000002DF7035C5E0>

    def test_log_role_change_creates_audit_entry(
        self, db_session: Session, create_user
    ):
        """Verify that log_role_change creates a RBACAuditLog entry."""
>       actor = create_user(role=UserRole.admin, email="admin@example.com")

tests\services\test_rbac_permissions.py:35: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestRBACAuditServiceLogging.test_log_role_change_captures_before_after_values _

self = <test_rbac_permissions.TestRBACAuditServiceLogging object at 0x000002DF6D62E9D0>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7033D290>
create_user = <function create_user.<locals>._create_user at 0x000002DF704AC5E0>

    def test_log_role_change_captures_before_after_values(
        self, db_session: Session, create_user
    ):
        """Verify detail field contains from\u2192to format for role transitions."""
>       actor = create_user(role=UserRole.admin)

tests\services\test_rbac_permissions.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestRBACAuditServiceLogging.test_log_user_status_change_user_deleted _____

self = <test_rbac_permissions.TestRBACAuditServiceLogging object at 0x000002DF6D62F090>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF70180390>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F83AA20>

    def test_log_user_status_change_user_deleted(
        self, db_session: Session, create_user
    ):
        """Verify deletion events are logged correctly."""
>       actor = create_user(role=UserRole.admin)

tests\services\test_rbac_permissions.py:76: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestRBACAuditServiceLogging.test_log_user_status_change_user_restored ____

self = <test_rbac_permissions.TestRBACAuditServiceLogging object at 0x000002DF6D62F790>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF702D3D10>
create_user = <function create_user.<locals>._create_user at 0x000002DF702676A0>

    def test_log_user_status_change_user_restored(
        self, db_session: Session, create_user
    ):
        """Verify restoration events are logged correctly."""
>       actor = create_user(role=UserRole.admin)

tests\services\test_rbac_permissions.py:95: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestRBACAuditServiceLogging.test_log_user_status_change_rejects_invalid_action _

self = <test_rbac_permissions.TestRBACAuditServiceLogging object at 0x000002DF6D62FE50>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF7057D4D0>
create_user = <function create_user.<locals>._create_user at 0x000002DF702DA840>

    def test_log_user_status_change_rejects_invalid_action(
        self, db_session: Session, create_user
    ):
        """Verify ValueError is raised on unsupported action types."""
>       actor = create_user(role=UserRole.admin)

tests\services\test_rbac_permissions.py:114: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
____ TestRBACAuditServiceLogging.test_log_claim_mismatch_sanitizes_claims _____

self = <test_rbac_permissions.TestRBACAuditServiceLogging object at 0x000002DF6D644550>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF6FDCC390>
create_user = <function create_user.<locals>._create_user at 0x000002DF70266200>

    def test_log_claim_mismatch_sanitizes_claims(
        self, db_session: Session, create_user
    ):
        """Verify only safe claim keys are stored in snapshot."""
>       actor = create_user(role=UserRole.admin)

tests\services\test_rbac_permissions.py:131: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestRBACAuditServiceLogging.test_log_claim_mismatch_logs_org_and_user_ids __

self = <test_rbac_permissions.TestRBACAuditServiceLogging object at 0x000002DF6D644C10>
db_session = <sqlalchemy.orm.session.Session object at 0x000002DF701DC910>
create_user = <function create_user.<locals>._create_user at 0x000002DF704AE7A0>

    def test_log_claim_mismatch_logs_org_and_user_ids(
        self, db_session: Session, create_user
    ):
        """Verify audit trail contains actor, target, and organization IDs."""
>       actor = create_user(role=UserRole.admin, email="admin@example.com")

tests\services\test_rbac_permissions.py:166: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
___ TestAuthDependencyEnforcement.test_require_min_role_admin_always_passes ___

self = <test_rbac_permissions.TestAuthDependencyEnforcement object at 0x000002DF6D645450>
create_user = <function create_user.<locals>._create_user at 0x000002DF6F83A5C0>

    def test_require_min_role_admin_always_passes(self, create_user):
        """Verify admin bypasses all role checks (level 4)."""
>       admin_user = create_user(role=UserRole.admin)

tests\services\test_rbac_permissions.py:187: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
__ TestAuthDependencyEnforcement.test_require_min_role_hierarchy_validation ___

self = <test_rbac_permissions.TestAuthDependencyEnforcement object at 0x000002DF6D645B10>
create_user = <function create_user.<locals>._create_user at 0x000002DF704AF2E0>

    def test_require_min_role_hierarchy_validation(self, create_user):
        """Verify solo < growth < enterprise < admin ordering."""
>       solo_user = create_user(role=UserRole.solo)

tests\services\test_rbac_permissions.py:194: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
_ TestPermissionHierarchy.test_admin_override_bypasses_exact_role_requirement _

self = <test_rbac_permissions.TestPermissionHierarchy object at 0x000002DF6D62E650>
create_user = <function create_user.<locals>._create_user at 0x000002DF7015D1C0>

    def test_admin_override_bypasses_exact_role_requirement(self, create_user):
        """Verify admin can access role-restricted endpoints."""
>       admin_user = create_user(role=UserRole.admin)

tests\services\test_rbac_permissions.py:253: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\conftest.py:239: in _create_user
    user = User(
<string>:4: in __init__
    ???
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state.py:561: in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\event\attr.py:487: in __call__
    fn(*args, **kw)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4391: in _event_on_init
    instrumenting_mapper._check_configure()
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:2386: in _check_configure
    _configure_registries({self.registry}, cascade=True)
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4199: in _configure_registries
    _do_configure_registries(registries, cascade)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

registries = set(), cascade = True

    @util.preload_module("sqlalchemy.orm.decl_api")
    def _do_configure_registries(
        registries: Set[_RegistryType], cascade: bool
    ) -> None:
        registry = util.preloaded.orm_decl_api.registry
    
        orig = set(registries)
    
        for reg in registry._recurse_with_dependencies(registries):
            has_skip = False
    
            for mapper in reg._mappers_to_configure():
                run_configure = None
    
                for fn in mapper.dispatch.before_mapper_configured:
                    run_configure = fn(mapper, mapper.class_)
                    if run_configure is EXT_SKIP:
                        has_skip = True
                        break
                if run_configure is EXT_SKIP:
                    continue
    
                if getattr(mapper, "_configure_failed", False):
                    e = sa_exc.InvalidRequestError(
                        "One or more mappers failed to initialize - "
                        "can't proceed with initialization of other "
                        "mappers. Triggering mapper: '%s'. "
                        "Original exception was: %s"
                        % (mapper, mapper._configure_failed)
                    )
                    e._configure_failed = mapper._configure_failed  # type: ignore
>                   raise e
E                   sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[DocumentExportJob(document_export_jobs)]'. Original exception was: Mapper 'Mapper[GeneratedDocument(generated_documents)]' has no property 'export_jobs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py:4236: InvalidRequestError
============================== warnings summary ===============================
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
..\..\..\..\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291
  C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.8/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

tests\test_netsuite_integration.py:30
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:30: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:42
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:42: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:59
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:59: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:97
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:97: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:114
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:114: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:132
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:132: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:153
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:153: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:209
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:209: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:229
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:229: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_netsuite_integration.py:249
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_netsuite_integration.py:249: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:29
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:29: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:49
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:49: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:66
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:66: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:104
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:104: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:121
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:121: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:143
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:143: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:164
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:164: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:219
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:219: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_quickbooks_integration.py:238
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_quickbooks_integration.py:238: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:28
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:28: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:40
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:40: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:57
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:57: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:95
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:95: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:112
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:112: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:130
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:130: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:151
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:151: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:206
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:206: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_sage_integration.py:226
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_sage_integration.py:226: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:30
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:30: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:47
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:47: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:63
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:63: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:104
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:104: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:136
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:136: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:153
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:153: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:175
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:175: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:196
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:196: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests\test_xero_integration.py:284
  C:\Projects\ma-saas-platform\M-S-SaaS-apex-deliver\backend\tests\test_xero_integration.py:284: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

backend/tests/test_billing_endpoints.py: 16 warnings
backend/tests/test_billing_simple.py: 3 warnings
backend/tests/test_clerk_auth_complete.py: 26 warnings
backend/tests/test_deal_endpoints.py: 25 warnings
backend/tests/test_document_ai_and_versions.py: 5 warnings
backend/tests/test_document_endpoints.py: 42 warnings
backend/tests/test_document_generation_api.py: 19 warnings
backend/tests/test_financial_api.py: 34 warnings
backend/tests/test_master_admin_api.py: 13 warnings
backend/tests/test_pipeline_template_api.py: 3 warnings
backend/tests/test_podcast_api.py: 54 warnings
backend/tests/test_subscription_error_paths.py: 16 warnings
backend/tests/test_task_crud.py: 6 warnings
backend/tests/test_valuation_api.py: 20 warnings
backend/tests/test_valuation_crud.py: 8 warnings
backend/tests/api/test_blog.py: 16 warnings
backend/tests/api/test_blog_api.py: 6 warnings
backend/tests/api/test_document_sharing.py: 8 warnings
backend/tests/api/test_marketing.py: 4 warnings
  C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:680: DeprecationWarning: The 'app' shortcut is now deprecated. Use the explicit style 'transport=WSGITransport(app=...)' instead.
    warnings.warn(message, DeprecationWarning)

backend/tests/test_clerk_auth_complete.py: 11 warnings
  C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_content.py:202: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.11.9-final-0 _______________

Name                                          Stmts   Miss  Cover
-----------------------------------------------------------------
app\__init__.py                                   1      0   100%
app\api\__init__.py                              24      0   100%
app\api\dependencies\__init__.py                  0      0   100%
app\api\dependencies\auth.py                    101     47    53%
app\api\dependencies\rbac.py                      2      2     0%
app\api\document_sharing.py                     121     92    24%
app\api\routes\__init__.py                        2      0   100%
app\api\routes\auth.py                            9      1    89%
app\api\routes\blog.py                           55     13    76%
app\api\routes\community.py                     123     74    40%
app\api\routes\dashboard.py                      25      7    72%
app\api\routes\deal_matching.py                  77     50    35%
app\api\routes\deals.py                          64     39    39%
app\api\routes\document_generation.py           227    164    28%
app\api\routes\documents.py                     184    114    38%
app\api\routes\events.py                        202    149    26%
app\api\routes\financial.py                     220    164    25%
app\api\routes\marketing.py                      69     24    65%
app\api\routes\master_admin.py                  379    241    36%
app\api\routes\pipeline_templates.py             34     14    59%
app\api\routes\podcasts.py                      306    228    25%
app\api\routes\subscriptions.py                 112     57    49%
app\api\routes\tasks.py                          69     39    43%
app\api\routes\valuation.py                     163    108    34%
app\api\webhooks\__init__.py                      0      0   100%
app\api\webhooks\clerk.py                        52     16    69%
app\core\__init__.py                              0      0   100%
app\core\config.py                               44      0   100%
app\core\database.py                             30     17    43%
app\core\security.py                             23      1    96%
app\core\subscription.py                         52      7    87%
app\db\__init__.py                                0      0   100%
app\db\base.py                                   28     14    50%
app\db\session.py                                 3      0   100%
app\db\types.py                                  11      1    91%
app\main.py                                      27      3    89%
app\models\__init__.py                           23      0   100%
app\models\blog_post.py                          25      1    96%
app\models\community.py                          88      0   100%
app\models\contact_message.py                    16      1    94%
app\models\deal.py                               56      0   100%
app\models\deal_match.py                         71     12    83%
app\models\document.py                          130      6    95%
app\models\document_generation.py               111     25    77%
app\models\enums.py                              65      0   100%
app\models\event.py                             137      5    96%
app\models\financial_connection.py               27      1    96%
app\models\financial_narrative.py                34      0   100%
app\models\financial_ratio.py                    67      0   100%
app\models\financial_statement.py                80      1    99%
app\models\master_admin.py                      272     15    94%
app\models\newsletter_subscription.py            12      1    92%
app\models\organization.py                       19      0   100%
app\models\pipeline_template.py                  30      0   100%
app\models\podcast.py                            49      0   100%
app\models\podcast_usage.py                      15      1    93%
app\models\rbac_audit_log.py                     25      0   100%
app\models\subscription.py                       53      0   100%
app\models\task.py                               68      0   100%
app\models\user.py                               43      0   100%
app\models\valuation.py                         120      0   100%
app\schemas\__init__.py                           4      0   100%
app\schemas\community.py                        131      3    98%
app\schemas\deal.py                              40      0   100%
app\schemas\deal_match.py                        68      0   100%
app\schemas\document.py                         222     25    89%
app\schemas\document_generation.py              127      6    95%
app\schemas\event.py                            154      0   100%
app\schemas\financial.py                         79      0   100%
app\schemas\master_admin.py                     420      0   100%
app\schemas\pipeline_template.py                 53      4    92%
app\schemas\podcast.py                           52      0   100%
app\schemas\subscription.py                      91      0   100%
app\schemas\task.py                              88      0   100%
app\schemas\user.py                              33      1    97%
app\schemas\valuation.py                        258     10    96%
app\services\__init__.py                          6      0   100%
app\services\audio_chunking_service.py          102     21    79%
app\services\community_service.py               167    139    17%
app\services\deal_matching_service.py           161    107    34%
app\services\deal_service.py                     81     66    19%
app\services\document_ai_service.py             135    102    24%
app\services\document_export_service.py         115     92    20%
app\services\document_generation_service.py     129     97    25%
app\services\document_service.py                579    520    10%
app\services\entitlement_service.py              47      4    91%
app\services\event_service.py                   241    197    18%
app\services\financial_narrative_service.py     231     53    77%
app\services\financial_ratios.py                240     10    96%
app\services\invite_service.py                   31     31     0%
app\services\master_admin_service.py            435    363    17%
app\services\netsuite_oauth_service.py          138     95    31%
app\services\organization_service.py             64     33    48%
app\services\pipeline_template_service.py        39     27    31%
app\services\podcast_service.py                 115     87    24%
app\services\quickbooks_oauth_service.py        233    192    18%
app\services\quota_service.py                   165     33    80%
app\services\rbac_audit_service.py               20     11    45%
app\services\s3_storage_service.py               95     95     0%
app\services\sage_oauth_service.py              192    151    21%
app\services\storage_service.py                  65     32    51%
app\services\subscription_service.py            142    100    30%
app\services\task_service.py                     35     23    34%
app\services\task_template_service.py            61     43    30%
app\services\thumbnail_service.py                93     17    82%
app\services\user_service.py                     75     55    27%
app\services\valuation_export_service.py        158    158     0%
app\services\valuation_service.py               350    214    39%
app\services\xero_oauth_service.py              206    168    18%
app\services\youtube_service.py                  57     15    74%
app\tasks\__init__.py                             2      0   100%
app\tasks\task_automation.py                     25      0   100%
app\utils\__init__.py                             0      0   100%
app\utils\datetime.py                             4      1    75%
-----------------------------------------------------------------
TOTAL                                         11329   5156    54%
Coverage HTML written to dir htmlcov
Coverage JSON written to file coverage.json
=========================== short test summary info ===========================
SKIPPED [1] tests\test_financial_xero_integration.py:9: To be implemented in ratio engine phase
SKIPPED [1] tests\test_master_admin_models.py:134: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:148: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:335: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:348: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_master_admin_models.py:405: SQLite doesn't enforce enum constraints - test with PostgreSQL
SKIPPED [1] tests\test_netsuite_integration.py:30: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:42: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:59: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:97: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:114: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:132: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:153: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:209: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:229: NetSuite credentials not configured (set NETSUITE_CLIENT_ID, NETSUITE_CLIENT_SECRET, NETSUITE_ACCOUNT_ID)
SKIPPED [1] tests\test_netsuite_integration.py:249: Requires real NetSuite sandbox OAuth flow - manual test
SKIPPED [1] tests\test_quickbooks_integration.py:29: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:49: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:66: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:104: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:121: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:143: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:164: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:219: QuickBooks credentials not configured (set QUICKBOOKS_CLIENT_ID and QUICKBOOKS_CLIENT_SECRET)
SKIPPED [1] tests\test_quickbooks_integration.py:238: Requires real QuickBooks sandbox OAuth flow - manual test
SKIPPED [1] tests\test_s3_storage_service.py:32: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:54: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:68: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:86: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:109: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:136: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:164: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:194: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:219: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:249: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:273: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:304: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:330: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:355: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:381: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:406: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:433: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:465: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:497: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:516: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_s3_storage_service.py:535: boto3 not installed (optional S3/R2 storage dependency)
SKIPPED [1] tests\test_sage_integration.py:28: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:40: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:57: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:95: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:112: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:130: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:151: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:206: Sage credentials not configured (set SAGE_CLIENT_ID and SAGE_CLIENT_SECRET)
SKIPPED [1] tests\test_sage_integration.py:226: Requires real Sage sandbox OAuth flow - manual test
SKIPPED [1] tests\test_storage_factory.py:48: boto3 not installed - S3 storage optional
SKIPPED [1] tests\test_storage_factory.py:116: boto3 not installed - S3 storage optional
SKIPPED [1] tests\test_subscription_error_paths.py:379: Stripe module imported inside function - mocking complex, error handling already verified in code
SKIPPED [1] tests\test_subscription_error_paths.py:403: Stripe module imported inside function - mocking complex, error handling already verified in code
SKIPPED [1] tests\test_subscription_error_paths.py:431: Stripe module imported inside function - mocking complex, event routing already verified in code
SKIPPED [1] tests\test_subscription_error_paths.py:474: Stripe module imported inside function - mocking complex, exception handling already verified in code
SKIPPED [1] tests\test_xero_integration.py:30: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:47: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:63: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:104: Requires real Xero sandbox OAuth flow - manual test
SKIPPED [1] tests\test_xero_integration.py:136: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:153: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:175: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:196: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\test_xero_integration.py:284: Xero credentials not configured (set XERO_CLIENT_ID and XERO_CLIENT_SECRET)
SKIPPED [1] tests\services\test_rbac_permissions.py:223: Auth dependency integration test - requires auth.py mocking
SKIPPED [1] tests\services\test_rbac_permissions.py:234: Auth dependency integration test - requires auth.py mocking
SKIPPED [1] tests\services\test_rbac_permissions.py:238: Auth dependency integration test - requires FastAPI request context
SKIPPED [1] tests\services\test_rbac_permissions.py:269: Entitlement service test - covered in test_entitlement.py
ERROR tests\test_billing_endpoints.py::test_create_checkout_session_invalid_tier
ERROR tests\test_billing_endpoints.py::test_get_subscription_not_found - sqla...
ERROR tests\test_billing_endpoints.py::test_cancel_subscription_requires_active_subscription
ERROR tests\test_billing_endpoints.py::test_customer_portal_redirect - sqlalc...
ERROR tests\test_community_service.py::test_create_post - sqlalchemy.exc.Inva...
ERROR tests\test_community_service.py::test_get_post_by_id - sqlalchemy.exc.I...
ERROR tests\test_community_service.py::test_get_post_by_id_wrong_org - sqlalc...
ERROR tests\test_community_service.py::test_update_post - sqlalchemy.exc.Inva...
ERROR tests\test_community_service.py::test_update_post_unauthorized - sqlalc...
ERROR tests\test_community_service.py::test_delete_post - sqlalchemy.exc.Inva...
ERROR tests\test_community_service.py::test_delete_post_unauthorized - sqlalc...
ERROR tests\test_community_service.py::test_list_posts - sqlalchemy.exc.Inval...
ERROR tests\test_community_service.py::test_list_posts_filter_by_category - s...
ERROR tests\test_community_service.py::test_list_posts_search - sqlalchemy.ex...
ERROR tests\test_community_service.py::test_create_comment - sqlalchemy.exc.I...
ERROR tests\test_community_service.py::test_create_comment_on_nonexistent_post
ERROR tests\test_community_service.py::test_create_nested_comment - sqlalchem...
ERROR tests\test_community_service.py::test_delete_comment - sqlalchemy.exc.I...
ERROR tests\test_community_service.py::test_delete_comment_unauthorized - sql...
ERROR tests\test_community_service.py::test_get_comments_for_post - sqlalchem...
ERROR tests\test_community_service.py::test_add_reaction - sqlalchemy.exc.Inv...
ERROR tests\test_community_service.py::test_add_reaction_duplicate - sqlalche...
ERROR tests\test_community_service.py::test_remove_reaction - sqlalchemy.exc....
ERROR tests\test_community_service.py::test_get_reactions - sqlalchemy.exc.In...
ERROR tests\test_community_service.py::test_follow_user - sqlalchemy.exc.Inva...
ERROR tests\test_community_service.py::test_follow_user_self - sqlalchemy.exc...
ERROR tests\test_community_service.py::test_follow_user_duplicate - sqlalchem...
ERROR tests\test_community_service.py::test_unfollow_user - sqlalchemy.exc.In...
ERROR tests\test_community_service.py::test_get_follow_stats - sqlalchemy.exc...
ERROR tests\test_community_service.py::test_moderate_content_flag - sqlalchem...
ERROR tests\test_community_service.py::test_moderate_content_delete - sqlalch...
ERROR tests\test_community_service.py::test_get_flagged_content - sqlalchemy....
ERROR tests\test_community_service.py::test_get_community_analytics - sqlalch...
ERROR tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_create_criteria_success
ERROR tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_create_criteria_requires_auth
ERROR tests\test_deal_matching_api.py::TestDealMatchingCriteriaAPI::test_list_criteria
ERROR tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_for_deal
ERROR tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_requires_auth
ERROR tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_for_deal
ERROR tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_requires_auth
ERROR tests\test_deal_matching_api.py::TestDealMatchingAPI::test_list_matches_deal_not_found
ERROR tests\test_deal_matching_api.py::TestDealMatchingAPI::test_find_matches_deal_not_found
ERROR tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_view
ERROR tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_save
ERROR tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_pass
ERROR tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_request_intro
ERROR tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_requires_auth
ERROR tests\test_deal_matching_api.py::TestDealMatchActionsAPI::test_record_match_action_match_not_found
ERROR tests\test_deal_matching_api.py::TestDealMatchingIntegration::test_create_criteria_and_find_matches_workflow
ERROR tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_create_deal_match_criteria_with_required_fields
ERROR tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_create_criteria_with_optional_fields
ERROR tests\test_deal_matching_models.py::TestDealMatchCriteriaModel::test_criteria_enforces_organization_isolation
ERROR tests\test_deal_matching_models.py::TestDealMatchModel::test_create_deal_match
ERROR tests\test_deal_matching_models.py::TestDealMatchModel::test_match_score_validation
ERROR tests\test_deal_matching_models.py::TestDealMatchModel::test_match_status_tracking
ERROR tests\test_deal_matching_models.py::TestDealMatchActionModel::test_create_match_action
ERROR tests\test_deal_matching_models.py::TestDealMatchActionModel::test_track_multiple_actions_on_match
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_exact
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_partial
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_industry_match_none
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_size_match_within_range
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_size_match_outside_range
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_geography_match_exact
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_geography_match_none
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_calculate_weighted_score
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_find_matches_returns_ranked_results
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_find_matches_filters_low_scores
ERROR tests\test_deal_matching_service.py::TestDealMatchingService::test_match_result_contains_explanation
ERROR tests\test_document_endpoints.py::test_create_folder_success - sqlalche...
ERROR tests\test_document_endpoints.py::test_upload_document_success - sqlalc...
ERROR tests\test_document_endpoints.py::test_upload_document_rejects_large_files
ERROR tests\test_document_endpoints.py::test_list_documents_filters_by_folder
ERROR tests\test_document_endpoints.py::test_download_document_records_access_log
ERROR tests\test_document_endpoints.py::test_set_document_permission - sqlalc...
ERROR tests\test_document_endpoints.py::test_list_folders_lazy_loading - sqla...
ERROR tests\test_document_endpoints.py::test_list_folders_supports_search - s...
ERROR tests\test_document_endpoints.py::test_create_nested_folder - sqlalchem...
ERROR tests\test_document_endpoints.py::test_rename_folder - sqlalchemy.exc.I...
ERROR tests\test_document_endpoints.py::test_delete_empty_folder - sqlalchemy...
ERROR tests\test_document_endpoints.py::test_delete_non_empty_folder_fails - ...
ERROR tests\test_document_endpoints.py::test_folder_requires_authentication
ERROR tests\test_document_endpoints.py::test_folder_organization_isolation - ...
ERROR tests\test_document_endpoints.py::test_upload_multiple_documents - sqla...
ERROR tests\test_document_endpoints.py::test_upload_unsupported_file_type - s...
ERROR tests\test_document_endpoints.py::test_upload_creates_audit_log - sqlal...
ERROR tests\test_document_endpoints.py::test_search_documents_by_filename - s...
ERROR tests\test_document_endpoints.py::test_filter_documents_by_file_type - ...
ERROR tests\test_document_endpoints.py::test_upload_same_name_creates_new_version
ERROR tests\test_document_endpoints.py::test_list_document_versions - sqlalch...
ERROR tests\test_document_endpoints.py::test_download_specific_version - sqla...
ERROR tests\test_document_endpoints.py::test_restore_previous_version - sqlal...
ERROR tests\test_document_endpoints.py::test_max_versions_enforced - sqlalche...
ERROR tests\test_document_endpoints.py::test_delete_document_archives_all_versions
ERROR tests\test_document_endpoints.py::test_viewer_cannot_delete_document - ...
ERROR tests\test_document_endpoints.py::test_viewer_can_download_document - s...
ERROR tests\test_document_endpoints.py::test_editor_can_upload_with_folder_permission
ERROR tests\test_document_endpoints.py::test_granting_folder_permission_creates_audit_log
ERROR tests\test_document_endpoints.py::test_revoking_folder_permission_creates_audit_log
ERROR tests\test_document_endpoints.py::test_revoking_document_permission_creates_audit_log
ERROR tests\test_document_endpoints.py::test_editor_cannot_delete_others_document
ERROR tests\test_document_endpoints.py::test_editor_can_delete_own_document
ERROR tests\test_document_endpoints.py::test_delete_document_requires_editor_permission
ERROR tests\test_document_endpoints.py::test_delete_document_records_audit_log
ERROR tests\test_document_endpoints.py::test_access_logs_include_user_name - ...
ERROR tests\test_document_endpoints.py::test_bulk_download_documents - sqlalc...
ERROR tests\test_document_endpoints.py::test_bulk_download_requires_permission
ERROR tests\test_document_endpoints.py::test_bulk_delete_documents - sqlalche...
ERROR tests\test_document_endpoints.py::test_bulk_delete_requires_owner_permission
ERROR tests\test_document_endpoints.py::test_bulk_delete_partial_failure - sq...
ERROR tests\test_document_endpoints.py::test_document_question_workflow - sql...
ERROR tests\test_document_generation_models.py::test_create_document_template
ERROR tests\test_document_generation_models.py::test_template_status_enum - s...
ERROR tests\test_document_generation_models.py::test_template_version_tracking
ERROR tests\test_document_generation_models.py::test_template_repr - sqlalche...
ERROR tests\test_document_generation_models.py::test_create_generated_document
ERROR tests\test_document_generation_models.py::test_generated_document_status_enum
ERROR tests\test_document_generation_models.py::test_generated_document_timestamps
ERROR tests\test_document_generation_models.py::test_generated_document_file_path
ERROR tests\test_document_generation_models.py::test_template_document_relationship
ERROR tests\test_document_generation_models.py::test_template_variables_json_field
ERROR tests\test_event_models.py::TestEventModel::test_create_event - sqlalch...
ERROR tests\test_event_models.py::TestEventModel::test_event_requires_organization
ERROR tests\test_event_models.py::TestEventModel::test_event_location_types
ERROR tests\test_event_models.py::TestEventTicketModel::test_create_event_ticket
ERROR tests\test_event_models.py::TestEventRegistrationModel::test_create_registration
ERROR tests\test_event_models.py::TestEventSessionModel::test_create_event_session
ERROR tests\test_event_models.py::TestEventAnalyticsModel::test_create_event_analytics
ERROR tests\test_event_service.py::TestEventService::test_create_event - sqla...
ERROR tests\test_event_service.py::TestEventService::test_get_event - sqlalch...
ERROR tests\test_event_service.py::TestEventService::test_get_event_wrong_organization
ERROR tests\test_event_service.py::TestEventService::test_list_events_pagination
ERROR tests\test_event_service.py::TestEventService::test_update_event - sqla...
ERROR tests\test_event_service.py::TestEventService::test_delete_event_soft_delete
ERROR tests\test_event_service.py::TestEventTicketService::test_create_ticket
ERROR tests\test_event_service.py::TestEventTicketService::test_create_ticket_invalid_event
ERROR tests\test_event_service.py::TestEventRegistrationService::test_create_registration
ERROR tests\test_event_service.py::TestEventRegistrationService::test_create_registration_with_ticket
ERROR tests\test_event_service.py::TestEventRegistrationService::test_create_registration_sold_out_ticket
ERROR tests\test_event_service.py::TestEventRegistrationService::test_cancel_registration_updates_ticket
ERROR tests\test_event_service.py::TestEventAnalyticsService::test_get_event_analytics
ERROR tests\test_event_service.py::TestEventAnalyticsService::test_analytics_with_sessions
ERROR tests\test_financial_api.py::test_calculate_financial_ratios_endpoint
ERROR tests\test_financial_api.py::test_calculate_ratios_requires_authentication
ERROR tests\test_financial_api.py::test_calculate_ratios_deal_not_found - sql...
ERROR tests\test_financial_api.py::test_calculate_ratios_with_partial_data - ...
ERROR tests\test_financial_api.py::test_get_financial_connections_endpoint_returns_empty_list_when_no_connections
ERROR tests\test_financial_api.py::test_get_financial_connections_endpoint_returns_connections
ERROR tests\test_financial_api.py::test_get_financial_ratios_not_found - sqla...
ERROR tests\test_financial_api.py::test_get_financial_narrative_not_found - s...
ERROR tests\test_financial_api.py::test_connect_xero_initiates_oauth_flow - s...
ERROR tests\test_financial_api.py::test_connect_xero_with_invalid_deal - sqla...
ERROR tests\test_financial_api.py::test_xero_oauth_callback_success - sqlalch...
ERROR tests\test_financial_api.py::test_xero_oauth_callback_missing_code - sq...
ERROR tests\test_financial_api.py::test_sync_financial_data_success - sqlalch...
ERROR tests\test_financial_api.py::test_sync_financial_data_no_connection - s...
ERROR tests\test_financial_api.py::test_connect_quickbooks_initiates_oauth_flow
ERROR tests\test_financial_api.py::test_connect_quickbooks_with_invalid_deal
ERROR tests\test_financial_api.py::test_quickbooks_oauth_callback_success - s...
ERROR tests\test_financial_api.py::test_quickbooks_oauth_callback_missing_params
ERROR tests\test_financial_api.py::test_sync_quickbooks_financial_data_success
ERROR tests\test_financial_api.py::test_sync_quickbooks_financial_data_no_connection
ERROR tests\test_financial_api.py::test_quickbooks_connection_status - sqlalc...
ERROR tests\test_financial_api.py::test_disconnect_quickbooks_connection - sq...
ERROR tests\test_financial_api.py::test_connect_netsuite_initiates_oauth_flow
ERROR tests\test_financial_api.py::test_connect_netsuite_with_invalid_deal - ...
ERROR tests\test_financial_api.py::test_netsuite_oauth_callback_success - sql...
ERROR tests\test_financial_api.py::test_sync_netsuite_financial_data_success
ERROR tests\test_financial_api.py::test_sync_netsuite_financial_data_no_connection
ERROR tests\test_financial_api.py::test_connect_sage_initiates_oauth_flow - s...
ERROR tests\test_financial_api.py::test_connect_sage_with_invalid_deal - sqla...
ERROR tests\test_financial_api.py::test_sage_oauth_callback_success - sqlalch...
ERROR tests\test_financial_api.py::test_sync_sage_financial_data_success - sq...
ERROR tests\test_financial_api.py::test_sync_sage_financial_data_no_connection
ERROR tests\test_financial_api.py::test_get_readiness_score_success - sqlalch...
ERROR tests\test_financial_api.py::test_get_readiness_score_no_narrative - sq...
ERROR tests\test_master_admin_api.py::test_goal_crud_flow - sqlalchemy.exc.In...
ERROR tests\test_master_admin_api.py::test_activity_crud_and_listing - sqlalc...
ERROR tests\test_master_admin_api.py::test_scores_and_dashboard_stats - sqlal...
ERROR tests\test_master_admin_api.py::test_focus_session_flow - sqlalchemy.ex...
ERROR tests\test_master_admin_api.py::test_nudge_management - sqlalchemy.exc....
ERROR tests\test_master_admin_api.py::test_meeting_template_management - sqla...
ERROR tests\test_master_admin_api.py::test_prospect_crud_flow - sqlalchemy.ex...
ERROR tests\test_master_admin_api.py::test_deal_pipeline_flow - sqlalchemy.ex...
ERROR tests\test_master_admin_api.py::test_campaign_and_recipient_management
ERROR tests\test_master_admin_api.py::test_content_script_and_piece_flow - sq...
ERROR tests\test_master_admin_api.py::test_lead_capture_flow - sqlalchemy.exc...
ERROR tests\test_master_admin_api.py::test_collateral_library_flow - sqlalche...
ERROR tests\test_master_admin_models.py::TestAdminGoalModel::test_create_admin_goal
ERROR tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_unique_constraint
ERROR tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_defaults
ERROR tests\test_master_admin_models.py::TestAdminGoalModel::test_admin_goal_repr
ERROR tests\test_master_admin_models.py::TestAdminActivityModel::test_create_admin_activity
ERROR tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_default_amount
ERROR tests\test_master_admin_models.py::TestAdminActivityModel::test_admin_activity_with_prospect
ERROR tests\test_master_admin_models.py::TestAdminScoreModel::test_create_admin_score
ERROR tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_range_constraint
ERROR tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_unique_constraint
ERROR tests\test_master_admin_models.py::TestAdminScoreModel::test_admin_score_defaults
ERROR tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_create_focus_session
ERROR tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_complete_focus_session
ERROR tests\test_master_admin_models.py::TestAdminFocusSessionModel::test_interrupted_focus_session
ERROR tests\test_master_admin_models.py::TestAdminNudgeModel::test_create_nudge
ERROR tests\test_master_admin_models.py::TestAdminNudgeModel::test_mark_nudge_as_read
ERROR tests\test_master_admin_models.py::TestAdminMeetingModel::test_create_meeting_template
ERROR tests\test_master_admin_models.py::TestAdminMeetingModel::test_meeting_default_duration
ERROR tests\test_pipeline_template_api.py::test_create_and_list_pipeline_templates
ERROR tests\test_pipeline_template_api.py::test_update_pipeline_template - sq...
ERROR tests\test_pipeline_template_api.py::test_delete_pipeline_template - sq...
ERROR tests\test_rbac.py::test_get_current_admin_user_with_admin - sqlalchemy...
ERROR tests\test_rbac.py::test_get_current_admin_user_with_non_admin - sqlalc...
ERROR tests\test_rbac.py::test_require_role_exact_match - sqlalchemy.exc.Inva...
ERROR tests\test_rbac.py::test_require_role_no_match - sqlalchemy.exc.Invalid...
ERROR tests\test_rbac.py::test_require_role_admin_override - sqlalchemy.exc.I...
ERROR tests\test_rbac.py::test_require_min_role_exact_match - sqlalchemy.exc....
ERROR tests\test_rbac.py::test_require_min_role_higher_role - sqlalchemy.exc....
ERROR tests\test_rbac.py::test_require_min_role_lower_role - sqlalchemy.exc.I...
ERROR tests\test_rbac.py::test_require_min_role_admin_override - sqlalchemy.e...
ERROR tests\test_subscription_error_paths.py::test_create_checkout_session_value_error
ERROR tests\test_subscription_error_paths.py::test_create_checkout_session_general_exception
ERROR tests\test_subscription_error_paths.py::test_get_my_subscription_not_found
ERROR tests\test_subscription_error_paths.py::test_billing_dashboard_no_subscription
ERROR tests\test_subscription_error_paths.py::test_billing_dashboard_with_subscription
ERROR tests\test_subscription_error_paths.py::test_billing_dashboard_zero_counts
ERROR tests\test_subscription_error_paths.py::test_change_tier_value_error - ...
ERROR tests\test_subscription_error_paths.py::test_change_tier_general_exception
ERROR tests\test_subscription_error_paths.py::test_cancel_subscription_value_error
ERROR tests\test_subscription_error_paths.py::test_cancel_subscription_general_exception
ERROR tests\test_subscription_model.py::test_create_subscription - sqlalchemy...
ERROR tests\test_subscription_model.py::test_subscription_defaults - sqlalche...
ERROR tests\test_subscription_model.py::test_subscription_status_transitions
ERROR tests\test_subscription_model.py::test_subscription_cancellation_scheduling
ERROR tests\test_subscription_model.py::test_subscription_trial_period - sqla...
ERROR tests\test_subscription_model.py::test_subscription_unique_per_organization
ERROR tests\test_subscription_model.py::test_subscription_relationship_to_organization
ERROR tests\test_subscription_model.py::test_create_invoice - sqlalchemy.exc....
ERROR tests\test_subscription_model.py::test_invoice_statuses - sqlalchemy.ex...
ERROR tests\test_subscription_model.py::test_invoice_relationship_to_subscription
ERROR tests\test_subscription_model.py::test_invoice_pdf_url_storage - sqlalc...
ERROR tests\test_subscription_model.py::test_subscription_cascade_delete_invoices
ERROR tests\test_task_crud.py::test_create_task_returns_201 - sqlalchemy.exc....
ERROR tests\test_task_crud.py::test_list_tasks_scopes_to_deal - sqlalchemy.ex...
ERROR tests\test_task_crud.py::test_update_task_allows_status_and_due_date_change
ERROR tests\test_task_crud.py::test_delete_task_returns_204 - sqlalchemy.exc....
ERROR tests\test_task_crud.py::test_starter_tier_cannot_create_tasks - sqlalc...
ERROR tests\test_task_crud.py::test_cannot_access_tasks_from_other_org - sqla...
ERROR tests\test_valuation_api.py::TestValuationApi::test_growth_user_can_create_valuation
ERROR tests\test_valuation_api.py::TestValuationApi::test_solo_user_gets_forbidden
ERROR tests\test_valuation_api.py::TestValuationApi::test_get_valuation_returns_data
ERROR tests\test_valuation_api.py::TestValuationApi::test_update_valuation - ...
ERROR tests\test_valuation_api.py::TestValuationApi::test_delete_valuation - ...
ERROR tests\test_valuation_api.py::TestValuationApi::test_cannot_access_other_org_valuation
ERROR tests\test_valuation_api.py::TestValuationApi::test_add_comparable_via_api
ERROR tests\test_valuation_api.py::TestValuationApi::test_add_precedent_via_api
ERROR tests\test_valuation_api.py::TestValuationApi::test_create_scenario_via_api
ERROR tests\test_valuation_api.py::TestValuationApi::test_generate_export_creates_log
ERROR tests\test_valuation_api.py::TestValuationApi::test_generate_export_returns_log_id_and_persists_entry
ERROR tests\test_valuation_api.py::TestValuationApi::test_generate_export_allows_scenario_id
ERROR tests\test_valuation_api.py::TestValuationApi::test_generate_export_forbidden_for_solo
ERROR tests\test_valuation_api.py::TestValuationApi::test_generate_export_rejects_foreign_scenario
ERROR tests\test_valuation_api.py::TestValuationApi::test_list_exports_returns_recent_logs
ERROR tests\test_valuation_api.py::TestValuationApi::test_get_export_status_reflects_updates
ERROR tests\test_valuation_api.py::TestValuationApi::test_run_monte_carlo_simulation
ERROR tests\test_valuation_api.py::TestValuationApi::test_run_monte_carlo_validation
ERROR tests\test_valuation_api.py::TestValuationApi::test_get_scenario_summary_via_api
ERROR tests\test_valuation_api.py::TestValuationApi::test_get_scenario_summary_forbidden_for_solo_tier
ERROR tests\test_valuation_crud.py::TestValuationCrudApi::test_create_valuation_creates_record
ERROR tests\test_valuation_crud.py::TestValuationCrudApi::test_create_valuation_requires_growth_tier
ERROR tests\test_valuation_crud.py::TestValuationCrudApi::test_update_valuation_modifies_record
ERROR tests\test_valuation_crud.py::TestValuationCrudApi::test_delete_valuation_returns_204
ERROR tests\test_valuation_crud.py::TestValuationCrudApi::test_add_comparable_company
ERROR tests\test_valuation_crud.py::TestValuationCrudApi::test_add_precedent_transaction
ERROR tests\test_valuation_crud.py::TestValuationCrudApi::test_create_scenario_requires_growth_tier
ERROR tests\test_valuation_crud.py::TestValuationAccessControl::test_cannot_access_other_org_deal
ERROR tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_pdf_creates_file
ERROR tests\test_valuation_export_service.py::TestValuationExportService::test_export_to_excel_creates_file
ERROR tests\test_valuation_export_service.py::TestValuationExportService::test_export_updates_export_log
ERROR tests\test_valuation_export_service.py::TestValuationExportService::test_export_includes_valuation_data
ERROR tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_comparable_analysis_excludes_outliers_and_weighs_results
ERROR tests\test_valuation_service.py::TestMultiplesAndScenarioAnalytics::test_precedent_analysis_flags_stale_transactions
ERROR tests\test_valuation_service.py::TestScenarioAnalytics::test_calculate_scenario_summary_returns_expected_stats
ERROR tests\test_valuation_service.py::TestExportLogging::test_log_export_creates_audit_record
ERROR tests\test_valuation_service.py::TestValuationServiceOperations::test_update_valuation_recalculates_metrics
ERROR tests\test_valuation_service.py::TestValuationServiceOperations::test_delete_valuation_removes_related_records
ERROR tests\test_valuation_service.py::TestValuationServiceOperations::test_calculate_precedent_multiples_handles_no_records
ERROR tests\test_valuation_service.py::TestValuationServiceOperations::test_list_helpers_return_entries
ERROR tests\api\test_blog.py::test_list_blog_posts_default - sqlalchemy.exc.I...
ERROR tests\api\test_blog.py::test_list_blog_posts_with_category_filter - sql...
ERROR tests\api\test_blog.py::test_list_blog_posts_with_search - sqlalchemy.e...
ERROR tests\api\test_blog.py::test_list_blog_posts_include_unpublished - sqla...
ERROR tests\api\test_blog.py::test_list_blog_posts_with_pagination - sqlalche...
ERROR tests\api\test_blog.py::test_list_blog_posts_empty_result - sqlalchemy....
ERROR tests\api\test_blog.py::test_get_blog_post_by_slug_success - sqlalchemy...
ERROR tests\api\test_blog.py::test_get_blog_post_by_slug_not_found - sqlalche...
ERROR tests\api\test_blog.py::test_get_unpublished_post_by_slug - sqlalchemy....
ERROR tests\api\test_blog.py::test_list_blog_categories - sqlalchemy.exc.Inva...
ERROR tests\api\test_blog.py::test_list_blog_posts_with_invalid_limit - sqlal...
ERROR tests\api\test_blog.py::test_list_blog_posts_with_invalid_offset - sqla...
ERROR tests\api\test_blog.py::test_blog_post_response_schema - sqlalchemy.exc...
ERROR tests\api\test_blog.py::test_blog_search_case_insensitive - sqlalchemy....
ERROR tests\api\test_blog.py::test_blog_list_ordering - sqlalchemy.exc.Invali...
ERROR tests\api\test_document_sharing.py::test_create_share_link_for_document
ERROR tests\api\test_document_sharing.py::test_create_share_link_with_password
ERROR tests\api\test_document_sharing.py::test_access_shared_document_valid_link
ERROR tests\api\test_document_sharing.py::test_access_shared_document_expired_link
ERROR tests\api\test_document_sharing.py::test_access_shared_document_with_password
ERROR tests\api\test_document_sharing.py::test_list_active_share_links_for_document
ERROR tests\api\test_document_sharing.py::test_revoke_share_link - sqlalchemy...
ERROR tests\api\test_document_sharing.py::test_track_share_link_access_count
ERROR tests\api\test_event_api.py::test_create_event_returns_201 - sqlalchemy...
ERROR tests\api\test_event_api.py::test_create_event_wrong_organization_returns_403
ERROR tests\api\test_event_api.py::test_list_events_returns_200 - sqlalchemy....
ERROR tests\api\test_event_api.py::test_list_events_with_status_filter - sqla...
ERROR tests\api\test_event_api.py::test_get_event_returns_200 - sqlalchemy.ex...
ERROR tests\api\test_event_api.py::test_get_event_not_found_returns_404 - sql...
ERROR tests\api\test_event_api.py::test_update_event_returns_200 - sqlalchemy...
ERROR tests\api\test_event_api.py::test_delete_event_returns_204 - sqlalchemy...
ERROR tests\api\test_event_api.py::test_create_event_session_returns_201 - sq...
ERROR tests\api\test_event_api.py::test_list_event_sessions_returns_200 - sql...
ERROR tests\api\test_event_api.py::test_update_event_session_returns_200 - sq...
ERROR tests\api\test_event_api.py::test_delete_event_session_returns_204 - sq...
ERROR tests\api\test_event_api.py::test_create_event_ticket_returns_201 - sql...
ERROR tests\api\test_event_api.py::test_list_event_tickets_returns_200 - sqla...
ERROR tests\api\test_event_api.py::test_update_event_ticket_returns_200 - sql...
ERROR tests\api\test_event_api.py::test_delete_event_ticket_returns_204 - sql...
ERROR tests\api\test_event_api.py::test_create_event_registration_returns_201
ERROR tests\api\test_event_api.py::test_list_event_registrations_returns_200
ERROR tests\api\test_event_api.py::test_update_event_registration_returns_200
ERROR tests\api\test_event_api.py::test_delete_event_registration_returns_204
ERROR tests\api\test_event_api.py::test_get_event_analytics_returns_200 - sql...
ERROR tests\api\test_event_api.py::test_export_registrations_csv_returns_200
ERROR tests\api\test_event_api.py::test_export_registrations_empty_event_returns_200
ERROR tests\api\test_event_api.py::test_list_events_requires_authentication
ERROR tests\api\test_event_api.py::test_create_event_requires_authentication
ERROR tests\master_admin\test_models.py::TestAdminGoal::test_create_admin_goal
ERROR tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_unique_constraint
ERROR tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_repr
ERROR tests\master_admin\test_models.py::TestAdminGoal::test_admin_goal_default_targets
ERROR tests\master_admin\test_models.py::TestAdminActivity::test_create_admin_activity
ERROR tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_types
ERROR tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_statuses
ERROR tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_default_amount
ERROR tests\master_admin\test_models.py::TestAdminActivity::test_admin_activity_repr
ERROR tests\master_admin\test_models.py::TestAdminScore::test_create_admin_score
ERROR tests\master_admin\test_models.py::TestAdminScore::test_admin_score_unique_constraint
ERROR tests\master_admin\test_models.py::TestAdminScore::test_admin_score_valid_range
ERROR tests\master_admin\test_models.py::TestAdminScore::test_admin_score_default_values
ERROR tests\master_admin\test_models.py::TestAdminScore::test_admin_score_repr
ERROR tests\master_admin\test_models.py::TestAdminFocusSession::test_create_focus_session
ERROR tests\master_admin\test_models.py::TestAdminFocusSession::test_complete_focus_session
ERROR tests\master_admin\test_models.py::TestAdminFocusSession::test_focus_session_default_duration
ERROR tests\master_admin\test_models.py::TestAdminFocusSession::test_focus_session_repr
ERROR tests\master_admin\test_models.py::TestAdminNudge::test_create_nudge - ...
ERROR tests\master_admin\test_models.py::TestAdminNudge::test_nudge_types - s...
ERROR tests\master_admin\test_models.py::TestAdminNudge::test_nudge_priorities
ERROR tests\master_admin\test_models.py::TestAdminNudge::test_nudge_default_priority
ERROR tests\master_admin\test_models.py::TestAdminNudge::test_nudge_read_status
ERROR tests\master_admin\test_models.py::TestAdminNudge::test_nudge_repr - sq...
ERROR tests\master_admin\test_models.py::TestAdminMeeting::test_create_meeting
ERROR tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_types
ERROR tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_default_duration
ERROR tests\master_admin\test_models.py::TestAdminMeeting::test_meeting_repr
ERROR tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_folder_rejects_invalid_created_by
ERROR tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_document_rejects_invalid_uploaded_by
ERROR tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_document_permission_rejects_invalid_user_id
ERROR tests\test_migrations\test_user_foreign_keys.py::TestForeignKeyIntegrity::test_valid_user_references_succeed
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_validates_org_match
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_org_mismatch
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_missing_org_claim_when_user_has_org
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_creates_missing_org_from_clerk
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_validates_role_match
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_role_mismatch
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_rejects_unknown_role_claim
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_logs_claim_mismatches
FAILED tests\test_auth_helpers.py::test_enforce_claim_integrity_allows_missing_role_claim
FAILED tests\test_auth_helpers.py::test_get_current_user_enforces_claim_integrity
FAILED tests\test_auth_helpers.py::test_require_feature_allows_access_with_sufficient_tier
FAILED tests\test_auth_helpers.py::test_require_feature_blocks_access_with_insufficient_tier
FAILED tests\test_billing_endpoints.py::test_create_checkout_session_success
FAILED tests\test_billing_endpoints.py::test_create_checkout_session_existing_subscription
FAILED tests\test_billing_endpoints.py::test_create_checkout_session_with_trial
FAILED tests\test_billing_endpoints.py::test_get_customer_portal_success - sq...
FAILED tests\test_billing_endpoints.py::test_get_customer_portal_handles_value_errors
FAILED tests\test_billing_endpoints.py::test_get_subscription_success - sqlal...
FAILED tests\test_billing_endpoints.py::test_update_subscription_tier_upgrade
FAILED tests\test_billing_endpoints.py::test_update_subscription_tier_downgrade
FAILED tests\test_billing_endpoints.py::test_cancel_subscription_at_period_end
FAILED tests\test_billing_endpoints.py::test_cancel_subscription_immediately
FAILED tests\test_clerk_auth_complete.py::test_webhook_creates_user - sqlalch...
FAILED tests\test_clerk_auth_complete.py::test_webhook_updates_existing_user
FAILED tests\test_clerk_auth_complete.py::test_webhook_update_creates_if_not_exists
FAILED tests\test_clerk_auth_complete.py::test_webhook_soft_deletes_user - sq...
FAILED tests\test_clerk_auth_complete.py::test_webhook_updates_last_login_on_session_created
FAILED tests\test_clerk_auth_complete.py::test_webhook_handles_session_ended
FAILED tests\test_clerk_auth_complete.py::test_webhook_handles_missing_email_addresses
FAILED tests\test_clerk_auth_complete.py::test_webhook_upserts_organization_metadata
FAILED tests\test_clerk_auth_complete.py::test_webhook_creates_organization_when_missing
FAILED tests\test_clerk_auth_complete.py::test_webhook_deactivates_organization_on_delete
FAILED tests\test_clerk_auth_complete.py::test_webhook_handles_invalid_role_gracefully
FAILED tests\test_clerk_auth_complete.py::test_auth_me_returns_current_user
FAILED tests\test_clerk_auth_complete.py::test_auth_me_rejects_token_for_nonexistent_user
FAILED tests\test_clerk_auth_complete.py::test_auth_me_rejects_org_claim_mismatch
FAILED tests\test_clerk_auth_complete.py::test_auth_me_rejects_role_claim_mismatch
FAILED tests\test_clerk_auth_complete.py::test_auth_me_populates_missing_org_from_claim
FAILED tests\test_clerk_auth_complete.py::test_user_creation_with_all_roles
FAILED tests\test_clerk_auth_complete.py::test_webhook_handles_invalid_timestamp_format
FAILED tests\test_clerk_auth_complete.py::test_full_user_lifecycle - sqlalche...
FAILED tests\test_community_models.py::test_create_post - sqlalchemy.exc.Inva...
FAILED tests\test_community_models.py::test_post_with_tags - sqlalchemy.exc.I...
FAILED tests\test_community_models.py::test_post_multi_tenancy - sqlalchemy.e...
FAILED tests\test_community_models.py::test_create_comment - sqlalchemy.exc.I...
FAILED tests\test_community_models.py::test_nested_comments - sqlalchemy.exc....
FAILED tests\test_community_models.py::test_post_comment_relationship - sqlal...
FAILED tests\test_community_models.py::test_create_reaction - sqlalchemy.exc....
FAILED tests\test_community_models.py::test_reaction_on_comment - sqlalchemy....
FAILED tests\test_community_models.py::test_unique_reaction_constraint - sqla...
FAILED tests\test_community_models.py::test_create_follow - sqlalchemy.exc.In...
FAILED tests\test_community_models.py::test_unique_follow_constraint - sqlalc...
FAILED tests\test_community_models.py::test_create_moderation_action - sqlalc...
FAILED tests\test_community_models.py::test_moderation_action_types - sqlalch...
FAILED tests\test_deal_endpoints.py::test_create_deal_success - sqlalchemy.ex...
FAILED tests\test_deal_endpoints.py::test_create_deal_validation_errors - sql...
FAILED tests\test_deal_endpoints.py::test_create_deal_sets_owner_and_org - sq...
FAILED tests\test_deal_endpoints.py::test_create_deal_default_stage - sqlalch...
FAILED tests\test_deal_endpoints.py::test_list_deals_returns_org_deals_only
FAILED tests\test_deal_endpoints.py::test_list_deals_pagination_works - sqlal...
FAILED tests\test_deal_endpoints.py::test_list_deals_filter_by_stage - sqlalc...
FAILED tests\test_deal_endpoints.py::test_list_deals_search_by_name - sqlalch...
FAILED tests\test_deal_endpoints.py::test_list_deals_sort_by_created_at - sql...
FAILED tests\test_deal_endpoints.py::test_list_deals_excludes_archived - sqla...
FAILED tests\test_deal_endpoints.py::test_get_deal_success - sqlalchemy.exc.I...
FAILED tests\test_deal_endpoints.py::test_get_deal_not_found - sqlalchemy.exc...
FAILED tests\test_deal_endpoints.py::test_get_deal_forbidden_other_org - sqla...
FAILED tests\test_deal_endpoints.py::test_update_deal_success - sqlalchemy.ex...
FAILED tests\test_deal_endpoints.py::test_update_deal_stage_change - sqlalche...
FAILED tests\test_deal_endpoints.py::test_update_deal_partial_update - sqlalc...
FAILED tests\test_deal_endpoints.py::test_update_deal_forbidden_other_org - s...
FAILED tests\test_deal_endpoints.py::test_update_deal_validation_errors - sql...
FAILED tests\test_deal_endpoints.py::test_archive_deal_success - sqlalchemy.e...
FAILED tests\test_deal_endpoints.py::test_archive_deal_forbidden_other_org - ...
FAILED tests\test_deal_endpoints.py::test_unarchive_deal_success - sqlalchemy...
FAILED tests\test_deal_endpoints.py::test_unarchive_deal_forbidden_other_org
FAILED tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_fetch_ai_suggestions
FAILED tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_accept_ai_suggestion
FAILED tests\test_document_ai_and_versions.py::TestAISuggestionEndpoints::test_reject_ai_suggestion
FAILED tests\test_document_ai_and_versions.py::TestVersionHistoryEndpoints::test_list_document_versions
FAILED tests\test_document_ai_and_versions.py::TestVersionHistoryEndpoints::test_restore_document_version
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_create_template
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_create_template_forbidden_other_org
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_list_templates
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_list_templates_with_filters
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_get_template
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_get_template_not_found
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_update_template
FAILED tests\test_document_generation_api.py::TestDocumentTemplateEndpoints::test_delete_template
FAILED tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document
FAILED tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document_missing_variables
FAILED tests\test_document_generation_api.py::TestDocumentGenerationEndpoints::test_generate_document_template_not_found
FAILED tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_list_generated_documents
FAILED tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_get_generated_document
FAILED tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_update_document_status
FAILED tests\test_document_generation_api.py::TestGeneratedDocumentEndpoints::test_update_document_content
FAILED tests\test_document_generation_api.py::TestTemplateRenderingService::test_complex_template_rendering
FAILED tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_as_pdf
FAILED tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_as_docx
FAILED tests\test_document_generation_api.py::TestDocumentExportEndpoints::test_export_document_not_found
FAILED tests\test_document_service.py::test_trim_document_versions_keeps_latest_twenty
FAILED tests\test_document_service.py::test_trim_document_versions_noop_when_within_limit
FAILED tests\test_document_service.py::test_bulk_download_documents_logs_access
FAILED tests\test_document_service.py::test_bulk_download_documents_requires_viewer_permission
FAILED tests\test_document_service_error_paths.py::test_delete_folder_with_documents_raises_value_error
FAILED tests\test_document_service_error_paths.py::test_delete_folder_with_subfolders_raises_value_error
FAILED tests\test_document_service_error_paths.py::test_upload_document_unsupported_file_type
FAILED tests\test_document_service_error_paths.py::test_upload_document_file_size_exceeds_limit
FAILED tests\test_document_service_error_paths.py::test_create_folder_insufficient_permissions_for_subfolder
FAILED tests\test_document_service_error_paths.py::test_create_folder_non_owner_cannot_create_top_level
FAILED tests\test_document_service_error_paths.py::test_upload_document_non_owner_cannot_upload_to_root
FAILED tests\test_event_models.py::TestEventTicketModel::test_ticket_requires_event
FAILED tests\test_event_models.py::TestEventRegistrationModel::test_registration_requires_event_and_user
FAILED tests\test_event_models.py::TestEventSessionModel::test_session_requires_event
FAILED tests\test_financial_models_sync.py::test_create_financial_connection
FAILED tests\test_financial_models_sync.py::test_financial_connection_cascade_delete
FAILED tests\test_financial_models_sync.py::test_create_financial_statement_balance_sheet
FAILED tests\test_financial_models_sync.py::test_financial_statement_with_json_fields
FAILED tests\test_financial_models_sync.py::test_create_financial_ratios - sq...
FAILED tests\test_financial_models_sync.py::test_financial_ratio_nullable_fields
FAILED tests\test_financial_models_sync.py::test_create_financial_narrative
FAILED tests\test_financial_models_sync.py::test_financial_narrative_version_control
FAILED tests\test_financial_models_sync.py::test_complete_financial_data_chain
FAILED tests\test_financial_models_sync.py::test_cascade_delete_all_financial_data
FAILED tests\test_financial_narrative_service.py::test_generate_financial_narrative_success
FAILED tests\test_financial_narrative_service.py::test_generate_financial_narrative_returns_existing_by_default
FAILED tests\test_financial_narrative_service.py::test_generate_financial_narrative_raises_error_when_no_data
FAILED tests\test_financial_narrative_service.py::test_generate_financial_narrative_raises_error_when_deal_not_found
FAILED tests\test_models_financial_connection.py::test_create_financial_connection
FAILED tests\test_models_financial_connection.py::test_financial_connection_with_optional_fields
FAILED tests\test_models_financial_connection.py::test_financial_connection_cascade_delete_with_deal
FAILED tests\test_models_financial_connection.py::test_financial_connection_relationship_to_deal
FAILED tests\test_models_financial_connection.py::test_financial_connection_soft_delete
FAILED tests\test_models_financial_connection.py::test_financial_connection_status_values
FAILED tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_creates_with_defaults
FAILED tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_normalizes_subscription_tier
FAILED tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_falls_back_to_starter_on_invalid_tier
FAILED tests\test_organization_service.py::TestOrganizationService::test_upsert_from_clerk_generates_unique_slug
FAILED tests\test_organization_service.py::TestOrganizationService::test_deactivate_organization_marks_inactive
FAILED tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_starter_user_blocked_from_creating_episode
FAILED tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_quota_service_passes_db_session
FAILED tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_can_create_episode
FAILED tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_quota_exceeded_returns_429
FAILED tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_professional_user_blocked_from_video_episode
FAILED tests\test_podcast_api.py::TestPodcastEpisodeCreation::test_premium_user_can_create_video_episode
FAILED tests\test_podcast_api.py::TestPodcastListEndpoint::test_list_episodes_returns_organizations_episodes
FAILED tests\test_podcast_api.py::TestPodcastListEndpoint::test_list_episodes_filters_by_status
FAILED tests\test_podcast_api.py::TestPodcastGetSingleEndpoint::test_get_single_episode_returns_episode
FAILED tests\test_podcast_api.py::TestPodcastGetSingleEndpoint::test_get_single_episode_returns_404_when_not_found
FAILED tests\test_podcast_api.py::TestPodcastUpdateEndpoint::test_update_episode_modifies_fields
FAILED tests\test_podcast_api.py::TestPodcastDeleteEndpoint::test_delete_episode_removes_episode
FAILED tests\test_podcast_api.py::TestPodcastDeleteEndpoint::test_delete_episode_returns_404_when_not_found
FAILED tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_premium_user_can_publish_video_to_youtube
FAILED tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_podcast_youtube_upload_requires_video_asset
FAILED tests\test_podcast_api.py::TestPodcastYouTubeUpload::test_youtube_upload_permission_error_returns_403
FAILED tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_professional_success
FAILED tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_starter_blocked
FAILED tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_validates_file_format
FAILED tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_validates_file_size
FAILED tests\test_podcast_api.py::TestAudioUpload::test_upload_audio_updates_episode_audio_url
FAILED tests\test_podcast_api.py::TestVideoUpload::test_upload_video_premium_success
FAILED tests\test_podcast_api.py::TestVideoUpload::test_upload_video_professional_blocked
FAILED tests\test_podcast_api.py::TestVideoUpload::test_upload_video_validates_file_format
FAILED tests\test_podcast_api.py::TestVideoUpload::test_upload_video_validates_file_size
FAILED tests\test_podcast_api.py::TestVideoUpload::test_upload_video_generates_thumbnail
FAILED tests\test_podcast_api.py::TestVideoUpload::test_upload_video_accepts_mov_format
FAILED tests\test_podcast_api.py::TestVideoUpload::test_upload_video_updates_episode_video_url
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_audio_professional_success
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_starter_blocked
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_requires_audio_file
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_updates_episode_transcript
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_handles_whisper_api_error
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_multi_language_requires_enterprise
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_multi_language_enterprise_success
FAILED tests\test_podcast_api.py::TestTranscription::test_transcribe_response_includes_metadata
FAILED tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_txt_success
FAILED tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_srt_success
FAILED tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_requires_transcript
FAILED tests\test_podcast_api.py::TestTranscriptDownload::test_download_transcript_starter_blocked
FAILED tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_premium_success
FAILED tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_requires_video
FAILED tests\test_podcast_api.py::TestThumbnailGeneration::test_generate_thumbnail_professional_blocked
FAILED tests\test_podcast_service.py::TestPodcastService::test_create_episode
FAILED tests\test_podcast_service.py::TestPodcastService::test_get_episodes_filters_by_status
FAILED tests\test_podcast_service.py::TestPodcastService::test_publish_episode_sets_timestamp
FAILED tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_uses_whisper
FAILED tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_requires_entitlement
FAILED tests\test_podcast_service.py::TestPodcastService::test_get_episode_analytics_aggregates_platform_totals
FAILED tests\test_podcast_service.py::TestPodcastService::test_generate_rss_feed_includes_published_episodes
FAILED tests\test_podcast_service.py::TestPodcastService::test_multi_tenant_isolation
FAILED tests\test_podcast_service.py::TestPodcastService::test_update_episode_mutates_fields
FAILED tests\test_podcast_service.py::TestPodcastService::test_delete_episode_removes_record
FAILED tests\test_podcast_service.py::TestPodcastService::test_transcribe_episode_missing_episode_raises
FAILED tests\test_quota_service.py::TestIncrementEpisodeCount::test_increments_usage_count_in_database
FAILED tests\test_quota_service.py::TestIncrementEpisodeCount::test_sync_session_increments_usage
FAILED tests\test_quota_service.py::TestIncrementEpisodeCount::test_creates_new_usage_record_for_first_episode
FAILED tests\test_quota_service.py::TestGetMonthlyUsage::test_returns_current_month_usage_count
FAILED tests\test_quota_service.py::TestGetMonthlyUsage::test_sync_session_returns_usage
FAILED tests\test_quota_service.py::TestGetMonthlyUsage::test_returns_zero_when_no_usage_records
FAILED tests\test_quota_service.py::TestGetQuotaSummary::test_usage_resets_when_new_month_starts
FAILED tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_creates_zero_record
FAILED tests\test_quota_service.py::TestResetMonthlyUsage::test_reset_monthly_usage_is_idempotent
FAILED tests\test_quota_service.py::TestMonthlyQuotaReset::test_quota_resets_when_new_billing_cycle_starts
FAILED tests\test_quota_service.py::TestMonthlyQuotaReset::test_usage_count_returns_zero_in_new_month
FAILED tests\test_quota_service.py::TestMonthlyQuotaReset::test_remaining_quota_resets_after_month_boundary
FAILED tests\test_subscription_model.py::test_subscription_tier_enum_values
FAILED tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_invalid_tier
FAILED tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_missing_organization
FAILED tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_annual_billing
FAILED tests\test_subscription_service_edge_cases.py::test_create_checkout_session_reuses_existing_customer_id
FAILED tests\test_subscription_service_edge_cases.py::test_create_checkout_session_with_custom_urls
FAILED tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_no_subscription
FAILED tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_no_stripe_subscription_id
FAILED tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_with_invalid_tier
FAILED tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_without_proration
FAILED tests\test_subscription_service_edge_cases.py::test_update_subscription_tier_prorates_by_default
FAILED tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_no_subscription
FAILED tests\test_subscription_service_edge_cases.py::test_cancel_subscription_with_no_stripe_subscription_id
FAILED tests\test_subscription_service_edge_cases.py::test_cancel_subscription_immediately
FAILED tests\test_subscription_service_edge_cases.py::test_cancel_subscription_at_period_end
FAILED tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_active_subscription
FAILED tests\test_subscription_service_edge_cases.py::test_create_billing_portal_requires_customer_id
FAILED tests\test_subscription_service_edge_cases.py::test_create_billing_portal_session_success
FAILED tests\test_subscription_service_edge_cases.py::test_handle_checkout_completed_with_no_existing_subscription
FAILED tests\test_subscription_service_edge_cases.py::test_handle_invoice_paid_with_no_subscription
FAILED tests\test_subscription_service_edge_cases.py::test_handle_subscription_updated_with_no_subscription
FAILED tests\test_subscription_service_edge_cases.py::test_handle_subscription_deleted_with_no_subscription
FAILED tests\test_subscription_service_edge_cases.py::test_get_organization_subscription_returns_none_for_nonexistent_org
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_create_valuation_calculates_metrics
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_update_valuation_recalculates
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_add_comparable_records
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_add_precedent_records
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_create_scenario_persists
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_generate_export_log_entry
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_delete_valuation_cascades
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_calculate_comparable_multiples
FAILED tests\test_valuation_crud.py::TestValuationServiceOps::test_calculate_precedent_multiples
FAILED tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_persists_document_reference
FAILED tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_rejects_foreign_document
FAILED tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_accepts_valid_scenario
FAILED tests\test_valuation_service.py::TestValuationServiceOperations::test_log_export_event_rejects_scenario_from_other_valuation
FAILED tests\test_valuation_service.py::TestGoToMarketKpis::test_ensure_test_reference_entities_noop_when_not_test
FAILED tests\test_valuation_service.py::TestGoToMarketKpis::test_ensure_test_reference_entities_creates_placeholders
FAILED tests\test_xero_oauth_service.py::test_initiate_xero_oauth_generates_authorization_url
FAILED tests\test_xero_oauth_service.py::test_initiate_xero_oauth_with_invalid_deal
FAILED tests\test_xero_oauth_service.py::test_handle_xero_callback_success - ...
FAILED tests\test_xero_oauth_service.py::test_handle_xero_callback_token_exchange_failure
FAILED tests\test_xero_oauth_service.py::test_refresh_xero_token_success - sq...
FAILED tests\test_xero_oauth_service.py::test_refresh_xero_token_when_refresh_fails
FAILED tests\test_xero_oauth_service.py::test_fetch_xero_statements_imports_balance_sheet
FAILED tests\test_xero_oauth_service.py::test_fetch_xero_statements_with_expired_token
FAILED tests\test_xero_oauth_service.py::test_disconnect_xero_removes_connection
FAILED tests\test_xero_oauth_service.py::test_get_xero_connection_status_active
FAILED tests\test_xero_oauth_service.py::test_get_xero_connection_status_not_connected
FAILED tests\api\test_blog.py::test_list_blog_categories_empty_database - sql...
FAILED tests\api\test_blog_api.py::test_list_blog_posts_returns_200 - sqlalch...
FAILED tests\api\test_blog_api.py::test_list_blog_posts_with_data - sqlalchem...
FAILED tests\api\test_blog_api.py::test_list_blog_posts_category_filter - sql...
FAILED tests\api\test_blog_api.py::test_list_blog_posts_search - sqlalchemy.e...
FAILED tests\api\test_blog_api.py::test_list_blog_posts_pagination - sqlalche...
FAILED tests\api\test_blog_api.py::test_list_blog_posts_published_only - sqla...
FAILED tests\api\test_marketing.py::test_submit_contact_form_success - assert...
FAILED tests\api\test_marketing.py::test_subscribe_newsletter_success - asser...
FAILED tests\api\test_marketing.py::test_subscribe_newsletter_is_idempotent
FAILED tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_role_change_creates_audit_entry
FAILED tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_role_change_captures_before_after_values
FAILED tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_user_deleted
FAILED tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_user_restored
FAILED tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_user_status_change_rejects_invalid_action
FAILED tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_claim_mismatch_sanitizes_claims
FAILED tests\services\test_rbac_permissions.py::TestRBACAuditServiceLogging::test_log_claim_mismatch_logs_org_and_user_ids
FAILED tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_require_min_role_admin_always_passes
FAILED tests\services\test_rbac_permissions.py::TestAuthDependencyEnforcement::test_require_min_role_hierarchy_validation
FAILED tests\services\test_rbac_permissions.py::TestPermissionHierarchy::test_admin_override_bypasses_exact_role_requirement
= 274 failed, 314 passed, 74 skipped, 377 warnings, 365 errors in 613.94s (0:10:13) =
